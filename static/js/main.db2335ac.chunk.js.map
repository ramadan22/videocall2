{"version":3,"sources":["components/VideoProvider/useSelectedParticipant/useSelectedParticipant.tsx","utils/index.ts","hooks/useLocalVideoToggle/useLocalVideoToggle.tsx","components/VideoProvider/AttachVisibilityHandler/AttachVisibilityHandler.tsx","constants.ts","hooks/useDevices/useDevices.tsx","components/VideoProvider/useRoom/useRoom.tsx","components/VideoProvider/index.tsx","components/VideoProvider/useLocalTracks/useLocalTracks.ts","components/VideoProvider/useHandleRoomDisconnectionErrors/useHandleRoomDisconnectionErrors.ts","components/VideoProvider/useHandleTrackPublicationFailed/useHandleTrackPublicationFailed.ts","components/VideoProvider/useScreenShareToggle/useScreenShareToggle.tsx","hooks/useVideoContext/useVideoContext.ts","components/Buttons/EndCallButton/EndCallButton.tsx","components/MenuBar/FlipCameraButton/FlipCameraIcon.tsx","hooks/useMediaStreamTrack/useMediaStreamTrack.ts","components/MenuBar/FlipCameraButton/FlipCameraButton.tsx","state/settings/settingsReducer.ts","state/useFirebaseAuth/useFirebaseAuth.ts","state/usePasscodeAuth/usePasscodeAuth.ts","state/index.tsx","state/useActiveSinkId/useActiveSinkId.ts","components/AboutDialog/AboutDialog.tsx","hooks/useIsTrackEnabled/useIsTrackEnabled.tsx","components/AudioLevelIndicator/AudioLevelIndicator.tsx","components/DeviceSelectionDialog/AudioInputList/AudioInputList.tsx","components/DeviceSelectionDialog/AudioOutputList/AudioOutputList.tsx","components/VideoTrack/VideoTrack.tsx","hooks/useVideoTrackDimensions/useVideoTrackDimensions.tsx","components/DeviceSelectionDialog/VideoInputList/VideoInputList.tsx","components/DeviceSelectionDialog/DeviceSelectionDialog.tsx","components/MenuBar/Menu/Menu.tsx","hooks/useRoomState/useRoomState.tsx","icons/MicIcon.tsx","icons/MicOffIcon.tsx","components/Buttons/ToggleAudioButton/ToggleAudioButton.tsx","hooks/useLocalAudioToggle/useLocalAudioToggle.tsx","icons/VideoOffIcon.tsx","icons/VideoOnIcon.tsx","components/Buttons/ToggleVideoButton/ToggleVideoButton.tsx","icons/ScreenShareIcon.tsx","hooks/useScreenShareParticipant/useScreenShareParticipant.tsx","components/Buttons/ToogleScreenShareButton/ToggleScreenShareButton.tsx","components/MenuBar/MenuBar.tsx","components/MobileTopMenuBar/MobileTopMenuBar.tsx","icons/AvatarIcon.tsx","components/LocalAudioLevelIndicator/LocalAudioLevelIndicator.tsx","components/PreJoinScreens/DeviceSelectionScreen/LocalVideoPreview/LocalVideoPreview.tsx","state/settings/renderDimensions.ts","components/ConnectionOptionsDialog/ConnectionOptionsDialog.tsx","icons/SettingsIcon.tsx","components/PreJoinScreens/DeviceSelectionScreen/SettingsMenu/SettingsMenu.tsx","components/PreJoinScreens/DeviceSelectionScreen/DeviceSelectionScreen.tsx","components/IntroContainer/VideoLogo.tsx","components/IntroContainer/TwilioLogo.tsx","components/IntroContainer/UserMenu/UserAvatar/UserAvatar.tsx","components/IntroContainer/UserMenu/UserMenu.tsx","components/IntroContainer/IntroContainer.tsx","components/IntroContainer/swoosh.ts","icons/ErrorIcon.tsx","icons/WarningIcon.tsx","components/Snackbar/Snackbar.tsx","components/PreJoinScreens/MediaErrorSnackbar/MediaErrorSnackbar.tsx","components/PreJoinScreens/PreflightTest/getNetworkCondition/getNetworkCondition.ts","components/PreJoinScreens/PreflightTest/ProgressIndicator/ProgressIndicator.tsx","icons/SuccessIcon.tsx","components/PreJoinScreens/PreflightTest/PreflightTest.tsx","components/PreJoinScreens/PreflightTest/useGetPreflightTokens/useGetPreflightTokens.ts","components/PreJoinScreens/PreflightTest/usePreflightTest/usePreflightTest.ts","components/PreJoinScreens/RoomNameScreen/RoomNameScreen.tsx","components/PreJoinScreens/PreJoinScreens.tsx","components/ReconnectingNotification/ReconnectingNotification.tsx","components/NetworkQualityLevel/NetworkQualityLevel.tsx","hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel.tsx","components/ParticipantInfo/PinIcon/PinIcon.tsx","hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff.tsx","hooks/usePublications/usePublications.tsx","hooks/useTrack/useTrack.tsx","hooks/useParticipantIsReconnecting/useParticipantIsReconnecting.ts","components/ParticipantInfo/ParticipantInfo.tsx","components/AudioTrack/AudioTrack.tsx","components/Publication/Publication.tsx","components/ParticipantTracks/ParticipantTracks.tsx","components/Participant/Participant.tsx","hooks/useDominantSpeaker/useDominantSpeaker.tsx","hooks/useParticipants/useParticipants.tsx","hooks/useMainParticipant/useMainParticipant.tsx","components/ParticipantList/ParticipantList.tsx","components/MainParticipantInfo/MainParticipantInfo.tsx","components/MainParticipant/MainParticipant.tsx","components/Room/Room.tsx","App.tsx","hooks/useHeight/useHeight.ts","components/ErrorDialog/ErrorDialog.tsx","components/ErrorDialog/enhanceMessage.ts","components/LoginPage/google-logo.svg","components/LoginPage/LoginPage.tsx","components/PrivateRoute/PrivateRoute.tsx","theme.ts","utils/useConnectionOptions/useConnectionOptions.ts","components/UnsupportedBrowserWarning/UnsupportedBrowserWarning.tsx","index.tsx"],"names":["selectedParticipantContext","createContext","useSelectedParticipant","useContext","SelectedParticipantProvider","room","children","useState","selectedParticipant","_setSelectedParticipant","useEffect","onDisconnect","handleParticipantDisconnected","participant","prevParticipant","on","off","Provider","value","isMobile","navigator","userAgent","test","removeUndefineds","obj","isPlainObject","target","key","val","useLocalVideoToggle","useVideoContext","localTracks","getLocalVideoTrack","removeLocalVideoTrack","onError","localParticipant","videoTrack","find","track","name","includes","isPublishing","setIspublishing","toggleVideoEnabled","useCallback","localTrackPublication","unpublishTrack","emit","then","publishTrack","priority","catch","finally","AttachVisibilityHandler","isVideoEnabled","shouldRepublishVideoOnForeground","useRef","handleVisibilityChange","document","visibilityState","current","addEventListener","removeEventListener","DEFAULT_VIDEO_CONSTRAINTS","width","height","frameRate","SELECTED_AUDIO_INPUT_KEY","SELECTED_AUDIO_OUTPUT_KEY","SELECTED_VIDEO_INPUT_KEY","useDevices","devices","setDevices","getDevices","mediaDevices","enumerateDevices","newDevices","audioInputDevices","filter","device","kind","videoInputDevices","audioOutputDevices","hasAudioInputDevices","length","hasVideoInputDevices","window","TwilioVideo","Video","VideoContext","VideoProvider","options","onErrorCallback","error","console","log","message","audioTrack","setAudioTrack","setVideoTrack","isAcquiringLocalTracks","setIsAcquiringLocalTracks","getLocalAudioTrack","deviceId","exact","createLocalAudioTrack","newTrack","selectedVideoDeviceId","localStorage","getItem","hasSelectedVideoDevice","some","Date","now","createLocalVideoTrack","removeLocalAudioTrack","stop","undefined","getAudioAndVideoTracks","Promise","resolve","selectedAudioDeviceId","hasSelectedAudioDevice","localTrackConstraints","video","audio","createLocalTracks","tracks","newVideoTrack","newAudioTrack","useLocalTracks","setRoom","isConnecting","setIsConnecting","optionsRef","connect","token","newRoom","disconnect","setMaxListeners","once","setTimeout","twilioRoom","videoTracks","forEach","publication","setPriority","useRoom","onDisconnected","_","useHandleRoomDisconnectionErrors","useHandleTrackPublicationFailed","isSharing","setIsSharing","stopScreenShareRef","shareScreen","getDisplayMedia","stream","getTracks","trackPublication","onended","toggleScreenShare","useScreenShareToggle","isSharingScreen","context","Error","useStyles","makeStyles","theme","createStyles","button","background","brand","color","EndCallButton","props","classes","Button","onClick","className","clsx","data-cy-disconnect","FlipCameraIcon","xmlns","viewBox","fill","fillRule","d","transform","useMediaStreamTrack","mediaStreamTrack","setMediaStreamTrack","handleStarted","FlipCameraButton","supportsFacingMode","setSupportsFacingMode","getSettings","facingMode","toggleFacingMode","newFacingMode","restart","disabled","startIcon","initialSettings","trackSwitchOffMode","dominantSpeakerPriority","bandwidthProfileMode","maxTracks","maxAudioBitrate","renderDimensionLow","renderDimensionStandard","renderDimensionHigh","inputLabels","setting","settingsReducer","state","action","firebaseConfig","apiKey","process","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","databaseURL","REACT_APP_FIREBASE_DATABASE_URL","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","fetchToken","passcode","create_room","fetch","method","headers","body","JSON","stringify","user_identity","room_name","verifyPasscode","res","a","json","jsonResponse","status","isValid","ok","getErrorMessage","usePasscodeAuth","history","useHistory","user","setUser","isAuthReady","setIsAuthReady","roomType","setRoomType","getToken","errorMessage","statusText","room_type","match","location","search","sessionStorage","getPasscode","verification","setItem","replace","pathname","signIn","signOut","removeItem","StateContext","AppStateProvider","setError","isFetching","setIsFetching","activeSinkId","_setActiveSinkId","setActiveSinkId","sinkId","selectedSinkId","useActiveSinkId","useReducer","settings","dispatchSetting","contextValue","REACT_APP_SET_AUTH","identity","roomName","Headers","getIdToken","idToken","set","endpoint","REACT_APP_TOKEN_ENDPOINT","params","URLSearchParams","text","firebase","onAuthStateChanged","newUser","provider","GoogleAuthProvider","addScope","signInWithPopup","useFirebaseAuth","err","reject","useAppState","AboutDialog","open","onClose","Dialog","fullWidth","maxWidth","DialogTitle","Divider","DialogContent","DialogContentText","String","isSupported","version","appVersion","REACT_APP_GIT_TAG","REACT_APP_GIT_COMMIT","DialogActions","variant","autoFocus","useIsTrackEnabled","isEnabled","setIsEnabled","setEnabled","setDisabled","audioContext","clipId","AudioContext","webkitAudioContext","initializeAnalyser","audioSource","createMediaStreamSource","analyser","createAnalyser","smoothingTimeConstant","fftSize","AudioLevelIndicator","SVGRectRef","setAnalyser","isTrackEnabled","newMediaStream","MediaStream","clone","stopAllMediaStreamTracks","reinitializeAnalyser","SVGClipElement","sampleArray","Uint8Array","frequencyBinCount","timer","interval","getByteFrequencyData","values","i","volume","Math","min","max","log10","setAttribute","clipPathId","data-test-audio-indicator","id","ref","x","y","clipPath","rx","ry","strokeWidth","data-test-audio-mute-icon","React","memo","AudioInputList","localAudioTrack","localAudioInputDeviceId","Typography","gutterBottom","Grid","container","alignItems","justify","FormControl","Select","onChange","e","newDeviceId","map","MenuItem","label","AudioOutputList","activeOutputLabel","styled","VideoTrack","isLocal","dimensions","setDimensions","handleDimensionsChanged","useVideoTrackDimensions","isPortrait","el","muted","attach","detach","isFrontFacing","style","objectFit","preview","maxHeight","margin","VideoInputList","localVideoTrack","storedLocalVideoDeviceId","setStoredLocalVideoDeviceId","localVideoInputDeviceId","minHeight","breakpoints","down","float","paper","headline","marginBottom","fontSize","listSection","DeviceSelectionDialog","Menu","useMediaQuery","aboutOpen","setAboutOpen","menuOpen","setMenuOpen","settingsOpen","setSettingsOpen","anchorRef","isOpen","buttonClassName","anchorEl","anchorOrigin","vertical","horizontal","transformOrigin","useRoomState","setState","setRoomState","MicIcon","MicOffIcon","ToggleAudioButton","disable","enable","useLocalAudioToggle","isAudioEnabled","toggleAudioEnabled","hasAudioTrack","data-cy-audio-toggle","VideoOffIcon","VideoOnIcon","ToggleVideoButton","lastClickTimeRef","toggleVideo","ScreenShareIcon","useScreenShareParticipant","screenShareParticipant","setScreenShareParticipant","updateScreenShareParticipant","Array","from","participants","concat","trackName","spacing","ToggleScreenShareButton","disableScreenShareButton","Boolean","isScreenShareSupported","isDisabled","tooltipMessage","Tooltip","title","placement","PopperProps","disablePortal","cursor","data-cy-share-screen","backgroundColor","palette","default","bottom","left","right","footerHeight","position","display","padding","zIndex","mobileFooterHeight","screenShareBanner","border","hideMobile","MenuBar","isReconnecting","Hidden","smDown","flex","item","paddingLeft","mobileTopBarHeight","endCallButton","settingsButton","minWidth","MobileTopMenuBar","AvatarIcon","cx","cy","r","strokeLinejoin","LocalAudioLevelIndicator","overflow","paddingTop","innerContainer","top","identityContainer","avatarContainer","justifyContent","LocalVideoPreview","component","RenderDimensions","resolution","getResolution","formControl","withDefault","RenderDimensionItems","ConnectionOptionsDialog","handleChange","handleNumberChange","xs","hidden","sm","InputLabel","TextField","placeholder","SettingsIcon","strokeLinecap","SettingsMenu","mobileButtonClass","deviceSettingsOpen","setDeviceSettingsOpen","connectionSettingsOpen","setConnectionSettingsOpen","getContentAnchorEl","marginTop","deviceButton","localPreviewContainer","paddingRight","joinButtons","flexDirection","mobileButtonBar","mobileButton","DeviceSelectionScreen","setStep","disableButtons","md","mdUp","direction","Steps","roomNameStep","data-cy-join-now","VideoLogo","TwilioLogo","red","UserAvatar","displayName","photoURL","Avatar","src","split","join","toUpperCase","userContainer","userButton","logoutLink","UserMenu","handleSignOut","Link","borderRadius","boxShadow","swooshContainer","backgroundImage","backgroundSize","backgroundPositionY","logoContainer","textAlign","twilioLogo","content","subContentContainer","IntroContainer","useLocation","subContent","ErrorIcon","stroke","WarningIcon","contentContainer","iconContainer","fontWeight","borderLeft","warning","Snackbar","handleClose","reason","IconButton","size","aria-label","MediaErrorSnackbar","isSnackbarDismissed","setIsSnackbarDismissed","isSnackbarOpen","hasAudio","hasVideo","getSnackbarContent","getSingleNetworkCondition","stat","yellowThreshold","redThreshold","NetworkCondition","Green","Red","Yellow","INNER_CIRCUMFERENCE","PI","OUTER_RADIUS","svg","marginRight","innerCircle","circle","strokeDasharray","strokeDashoffset","animation","TEST_DURATION","ProgressIndicator","SIZE","SuccessIcon","result","ResultItem","icon","Result","networkCondition","PreflightTest","tokens","setTokens","tokenError","setTokenError","nanoid","publisherIdentity","subscriberIdentity","all","newTokens","useGetPreflightTokens","publisherToken","subscriberToken","testReport","setTestReport","testFailure","setTestFailure","isTestRunning","setIsTestRunning","preflightTestRef","removeAllListeners","testPreflight","duration","report","usePreflightTest","latency","stats","rtt","average","jitter","packetLoss","getNetworkCondition","paddingBottom","inputContainer","textFieldContainer","continueButton","RoomNameScreen","setName","setRoomName","handleSubmit","hasUsername","onSubmit","shrink","htmlFor","event","autoCapitalize","type","PreJoinScreens","URLRoomName","useParams","step","mediaError","setMediaError","deviceSelectionStep","dir","SubContent","preventDefault","origin","replaceState","encodeURI","ReconnectingNotification","roomState","Container","borderRight","BARS_ARRAY","NetworkQualityLevel","networkQualityLevel","setNetworkQualityLevel","handleNewtorkQualityLevelChange","newNetworkQualityLevel","useParticipantNetworkQualityLevel","level","PinIcon","SvgIcon","boxSizing","useIsTrackSwitchedOff","isSwitchedOff","setIsSwitchedOff","handleSwitchedOff","handleSwitchedOn","usePublications","publications","setPublications","publicationAdded","prevPublications","publicationRemoved","p","useTrack","setTrack","removeTrack","useParticipantIsReconnecting","setIsReconnecting","handleReconnecting","handleReconnected","participantBorderWidth","sidebarMobileHeight","infoContainer","reconnectingContainer","screenShareIconContainer","infoRowBottom","networkQualityContainer","typeography","hideParticipant","cursorPointer","ParticipantInfo","isSelected","isLocalParticipant","audioPublication","videoPublication","isScreenShareEnabled","isVideoSwitchedOff","isParticipantReconnecting","data-cy-participant","AudioTrack","audioEl","appendChild","remove","setSinkId","Publication","videoOnly","videoPriority","ParticipantTracks","filteredPublications","enableScreenShare","Participant","useDominantSpeaker","dominantSpeaker","setDominantSpeaker","handleDominantSpeakerChanged","newDominantSpeaker","prevDominantSpeaker","useParticipants","setParticipants","prevParticipants","participantConnected","participantDisconnected","useMainParticipant","overflowY","gridArea","overflowX","transparentBackground","scrollContainer","innerScrollContainer","sidebarWidth","sidebarMobilePadding","ParticipantList","setSelectedParticipant","mainParticipant","isRemoteParticipantScreenSharing","sid","marginLeft","MainParticipantInfo","screenSharePublication","data-cy-main-participant","MainParticipant","totalMobileSidebarHeight","gridTemplateColumns","gridTemplateRows","Room","Main","App","innerHeight","visualViewport","scale","setHeight","onResize","useHeight","ErrorDialog","dismissError","code","enhancedMessage","enhanceMessage","_extends","Object","assign","arguments","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref3","filterUnits","dx","dy","stdDeviation","_ref4","SvgGoogleLogo","_ref","svgRef","titleId","xmlnsXlink","ForwardRef","googleButton","textTransform","passcodeContainer","submitButton","LoginPage","setPasscode","authError","setAuthError","isAuthEnabled","login","PrivateRoute","rest","renderChildren","render","to","defaultTheme","createMuiTheme","overrides","MuiCssBaseline","MuiButton","root","transition","transitions","create","short","contained","outlinedPrimary","MuiTypography","body1","MuiInputBase","MuiSelect","MuiDialogActions","MuiTextField","MuiInputLabel","MuiOutlinedInput","notchedOutline","borderColor","typography","fontFamily","primary","main","useConnectionOptions","connectionOptions","bandwidthProfile","mode","renderDimensions","low","standard","high","Number","networkQuality","local","remote","preferredVideoCodecs","codec","simulcast","maxSubscriptionBitrate","heading","UnsupportedBrowserWarning","Paper","href","rel","VideoApp","ReactDOM","CssBaseline","basename","path","getElementById"],"mappings":"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","file":"static/js/main.db2335ac.chunk.js","sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { Participant, Room } from 'twilio-video';\r\n\r\ntype selectedParticipantContextType = [Participant | null, (participant: Participant) => void];\r\n\r\nexport const selectedParticipantContext = createContext<selectedParticipantContextType>(null!);\r\n\r\nexport default function useSelectedParticipant() {\r\n  const [selectedParticipant, setSelectedParticipant] = useContext(selectedParticipantContext);\r\n  return [selectedParticipant, setSelectedParticipant] as const;\r\n}\r\n\r\ntype SelectedParticipantProviderProps = {\r\n  room: Room | null;\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport function SelectedParticipantProvider({ room, children }: SelectedParticipantProviderProps) {\r\n  const [selectedParticipant, _setSelectedParticipant] = useState<Participant | null>(null);\r\n  const setSelectedParticipant = (participant: Participant) =>\r\n    _setSelectedParticipant(prevParticipant => (prevParticipant === participant ? null : participant));\r\n\r\n  useEffect(() => {\r\n    if (room) {\r\n      const onDisconnect = () => _setSelectedParticipant(null);\r\n      const handleParticipantDisconnected = (participant: Participant) =>\r\n        _setSelectedParticipant(prevParticipant => (prevParticipant === participant ? null : prevParticipant));\r\n\r\n      room.on('disconnected', onDisconnect);\r\n      room.on('participantDisconnected', handleParticipantDisconnected);\r\n      return () => {\r\n        room.off('disconnected', onDisconnect);\r\n        room.off('participantDisconnected', handleParticipantDisconnected);\r\n      };\r\n    }\r\n  }, [room]);\r\n\r\n  return (\r\n    <selectedParticipantContext.Provider value={[selectedParticipant, setSelectedParticipant]}>\r\n      {children}\r\n    </selectedParticipantContext.Provider>\r\n  );\r\n}\r\n","import isPlainObject from 'is-plain-object';\r\n\r\nexport const isMobile = (() => {\r\n  if (typeof navigator === 'undefined' || typeof navigator.userAgent !== 'string') {\r\n    return false;\r\n  }\r\n  return /Mobile/.test(navigator.userAgent);\r\n})();\r\n\r\n// Recursively removes any object keys with a value of undefined\r\nexport function removeUndefineds<T>(obj: T): T {\r\n  if (!isPlainObject(obj)) return obj;\r\n\r\n  const target: { [name: string]: any } = {};\r\n\r\n  for (const key in obj) {\r\n    const val = obj[key];\r\n    if (typeof val !== 'undefined') {\r\n      target[key] = removeUndefineds(val);\r\n    }\r\n  }\r\n\r\n  return target as T;\r\n}\r\n","import { LocalVideoTrack } from 'twilio-video';\r\nimport { useCallback, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useLocalVideoToggle() {\r\n  const { room, localTracks, getLocalVideoTrack, removeLocalVideoTrack, onError } = useVideoContext();\r\n  const localParticipant = room?.localParticipant;\r\n  const videoTrack = localTracks.find(track => track.name.includes('camera')) as LocalVideoTrack;\r\n  const [isPublishing, setIspublishing] = useState(false);\r\n\r\n  const toggleVideoEnabled = useCallback(() => {\r\n    if (!isPublishing) {\r\n      if (videoTrack) {\r\n        const localTrackPublication = localParticipant?.unpublishTrack(videoTrack);\r\n        // TODO: remove when SDK implements this event. See: https://issues.corp.twilio.com/browse/JSDK-2592\r\n        localParticipant?.emit('trackUnpublished', localTrackPublication);\r\n        removeLocalVideoTrack();\r\n      } else {\r\n        setIspublishing(true);\r\n        getLocalVideoTrack()\r\n          .then((track: LocalVideoTrack) => localParticipant?.publishTrack(track, { priority: 'low' }))\r\n          .catch(onError)\r\n          .finally(() => setIspublishing(false));\r\n      }\r\n    }\r\n  }, [videoTrack, localParticipant, getLocalVideoTrack, isPublishing, onError, removeLocalVideoTrack]);\r\n\r\n  return [!!videoTrack, toggleVideoEnabled] as const;\r\n}\r\n","import { isMobile } from '../../../utils';\r\nimport { useEffect, useRef } from 'react';\r\nimport useLocalVideoToggle from '../../../hooks/useLocalVideoToggle/useLocalVideoToggle';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\n/* \r\n  This component adds a visibilitychange handler to the document when\r\n  the user is using a mobile device. When the handler detects that\r\n  the browser has been backgrounded, it unpublishes the users local\r\n  video track. The browser cannot send video to the room when it has\r\n  been backgrounded, so unpublishing the track stops video capture\r\n  on the device, and triggers a UI update for all other participants\r\n  to show that this user's video track has been turned off.\r\n*/\r\n\r\nexport default function AttachVisibilityHandler() {\r\n  const { room } = useVideoContext();\r\n  const [isVideoEnabled, toggleVideoEnabled] = useLocalVideoToggle();\r\n  const shouldRepublishVideoOnForeground = useRef(false);\r\n\r\n  useEffect(() => {\r\n    if (room && isMobile) {\r\n      const handleVisibilityChange = () => {\r\n        // We don't need to unpublish the local video track if it has already been unpublished\r\n        if (document.visibilityState === 'hidden' && isVideoEnabled) {\r\n          shouldRepublishVideoOnForeground.current = true;\r\n          toggleVideoEnabled();\r\n\r\n          // Don't publish the local video track if it wasn't published before the app was backgrounded\r\n        } else if (shouldRepublishVideoOnForeground.current) {\r\n          shouldRepublishVideoOnForeground.current = false;\r\n          toggleVideoEnabled();\r\n        }\r\n      };\r\n\r\n      document.addEventListener('visibilitychange', handleVisibilityChange);\r\n      return () => {\r\n        document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n      };\r\n    }\r\n  }, [isVideoEnabled, room, toggleVideoEnabled]);\r\n\r\n  return null;\r\n}\r\n","export const DEFAULT_VIDEO_CONSTRAINTS: MediaStreamConstraints['video'] = {\r\n  width: 1280,\r\n  height: 720,\r\n  frameRate: 24,\r\n};\r\n\r\n// These are used to store the selected media devices in localStorage\r\nexport const SELECTED_AUDIO_INPUT_KEY = 'TwilioVideoApp-selectedAudioInput';\r\nexport const SELECTED_AUDIO_OUTPUT_KEY = 'TwilioVideoApp-selectedAudioOutput';\r\nexport const SELECTED_VIDEO_INPUT_KEY = 'TwilioVideoApp-selectedVideoInput';\r\n","import { useState, useEffect } from 'react';\r\n\r\nexport default function useDevices() {\r\n  const [devices, setDevices] = useState<MediaDeviceInfo[]>([]);\r\n\r\n  useEffect(() => {\r\n    const getDevices = () => navigator.mediaDevices.enumerateDevices().then(newDevices => setDevices(newDevices));\r\n    navigator.mediaDevices.addEventListener('devicechange', getDevices);\r\n    getDevices();\r\n\r\n    return () => {\r\n      navigator.mediaDevices.removeEventListener('devicechange', getDevices);\r\n    };\r\n  }, []);\r\n\r\n  return {\r\n    audioInputDevices: devices.filter(device => device.kind === 'audioinput'),\r\n    videoInputDevices: devices.filter(device => device.kind === 'videoinput'),\r\n    audioOutputDevices: devices.filter(device => device.kind === 'audiooutput'),\r\n    hasAudioInputDevices: devices.filter(device => device.kind === 'audioinput').length > 0,\r\n    hasVideoInputDevices: devices.filter(device => device.kind === 'videoinput').length > 0,\r\n  };\r\n}\r\n","import { Callback } from '../../../types';\r\nimport { isMobile } from '../../../utils';\r\nimport Video, { ConnectOptions, LocalTrack, Room } from 'twilio-video';\r\nimport { useCallback, useEffect, useRef, useState } from 'react';\r\n\r\n// @ts-ignore\r\nwindow.TwilioVideo = Video;\r\n\r\nexport default function useRoom(localTracks: LocalTrack[], onError: Callback, options?: ConnectOptions) {\r\n  const [room, setRoom] = useState<Room | null>(null);\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n  const optionsRef = useRef(options);\r\n\r\n  useEffect(() => {\r\n    // This allows the connect function to always access the most recent version of the options object. This allows us to\r\n    // reliably use the connect function at any time.\r\n    optionsRef.current = options;\r\n  }, [options]);\r\n\r\n  const connect = useCallback(\r\n    token => {\r\n      setIsConnecting(true);\r\n      return Video.connect(token, { ...optionsRef.current, tracks: localTracks }).then(\r\n        newRoom => {\r\n          setRoom(newRoom);\r\n          const disconnect = () => newRoom.disconnect();\r\n\r\n          // This app can add up to 13 'participantDisconnected' listeners to the room object, which can trigger\r\n          // a warning from the EventEmitter object. Here we increase the max listeners to suppress the warning.\r\n          newRoom.setMaxListeners(15);\r\n\r\n          newRoom.once('disconnected', () => {\r\n            // Reset the room only after all other `disconnected` listeners have been called.\r\n            setTimeout(() => setRoom(null));\r\n            window.removeEventListener('beforeunload', disconnect);\r\n\r\n            if (isMobile) {\r\n              window.removeEventListener('pagehide', disconnect);\r\n            }\r\n          });\r\n\r\n          // @ts-ignore\r\n          window.twilioRoom = newRoom;\r\n\r\n          newRoom.localParticipant.videoTracks.forEach(publication =>\r\n            // All video tracks are published with 'low' priority because the video track\r\n            // that is displayed in the 'MainParticipant' component will have it's priority\r\n            // set to 'high' via track.setPriority()\r\n            publication.setPriority('low')\r\n          );\r\n\r\n          setIsConnecting(false);\r\n\r\n          // Add a listener to disconnect from the room when a user closes their browser\r\n          window.addEventListener('beforeunload', disconnect);\r\n\r\n          if (isMobile) {\r\n            // Add a listener to disconnect from the room when a mobile user closes their browser\r\n            window.addEventListener('pagehide', disconnect);\r\n          }\r\n        },\r\n        error => {\r\n          onError(error);\r\n          setIsConnecting(false);\r\n        }\r\n      );\r\n    },\r\n    [localTracks, onError]\r\n  );\r\n\r\n  return { room, isConnecting, connect };\r\n}\r\n","import React, { createContext, ReactNode } from 'react';\r\nimport {\r\n  CreateLocalTrackOptions,\r\n  ConnectOptions,\r\n  LocalAudioTrack,\r\n  LocalVideoTrack,\r\n  Room,\r\n  TwilioError,\r\n} from 'twilio-video';\r\nimport { ErrorCallback } from '../../types';\r\nimport { SelectedParticipantProvider } from './useSelectedParticipant/useSelectedParticipant';\r\n\r\nimport AttachVisibilityHandler from './AttachVisibilityHandler/AttachVisibilityHandler';\r\nimport useHandleRoomDisconnectionErrors from './useHandleRoomDisconnectionErrors/useHandleRoomDisconnectionErrors';\r\nimport useHandleTrackPublicationFailed from './useHandleTrackPublicationFailed/useHandleTrackPublicationFailed';\r\nimport useLocalTracks from './useLocalTracks/useLocalTracks';\r\nimport useRoom from './useRoom/useRoom';\r\nimport useScreenShareToggle from './useScreenShareToggle/useScreenShareToggle';\r\n\r\n/*\r\n *  The hooks used by the VideoProvider component are different than the hooks found in the 'hooks/' directory. The hooks\r\n *  in the 'hooks/' directory can be used anywhere in a video application, and they can be used any number of times.\r\n *  the hooks in the 'VideoProvider/' directory are intended to be used by the VideoProvider component only. Using these hooks\r\n *  elsewhere in the application may cause problems as these hooks should not be used more than once in an application.\r\n */\r\n\r\nexport interface IVideoContext {\r\n  room: Room | null;\r\n  localTracks: (LocalAudioTrack | LocalVideoTrack)[];\r\n  isConnecting: boolean;\r\n  connect: (token: string) => Promise<void>;\r\n  onError: ErrorCallback;\r\n  getLocalVideoTrack: (newOptions?: CreateLocalTrackOptions) => Promise<LocalVideoTrack>;\r\n  getLocalAudioTrack: (deviceId?: string) => Promise<LocalAudioTrack>;\r\n  isAcquiringLocalTracks: boolean;\r\n  removeLocalAudioTrack: () => void;\r\n  removeLocalVideoTrack: () => void;\r\n  isSharingScreen: boolean;\r\n  toggleScreenShare: () => void;\r\n  getAudioAndVideoTracks: () => Promise<void>;\r\n}\r\n\r\nexport const VideoContext = createContext<IVideoContext>(null!);\r\n\r\ninterface VideoProviderProps {\r\n  options?: ConnectOptions;\r\n  onError: ErrorCallback;\r\n  children: ReactNode;\r\n}\r\n\r\nexport function VideoProvider({ options, children, onError = () => {} }: VideoProviderProps) {\r\n  const onErrorCallback = (error: TwilioError) => {\r\n    console.log(`ERROR: ${error.message}`, error);\r\n    onError(error);\r\n  };\r\n\r\n  const {\r\n    localTracks,\r\n    getLocalVideoTrack,\r\n    getLocalAudioTrack,\r\n    isAcquiringLocalTracks,\r\n    removeLocalAudioTrack,\r\n    removeLocalVideoTrack,\r\n    getAudioAndVideoTracks,\r\n  } = useLocalTracks();\r\n  const { room, isConnecting, connect } = useRoom(localTracks, onErrorCallback, options);\r\n\r\n  // Register onError callback functions.\r\n  useHandleRoomDisconnectionErrors(room, onError);\r\n  useHandleTrackPublicationFailed(room, onError);\r\n  const [isSharingScreen, toggleScreenShare] = useScreenShareToggle(room, onError);\r\n\r\n  return (\r\n    <VideoContext.Provider\r\n      value={{\r\n        room,\r\n        localTracks,\r\n        isConnecting,\r\n        onError: onErrorCallback,\r\n        getLocalVideoTrack,\r\n        getLocalAudioTrack,\r\n        connect,\r\n        isAcquiringLocalTracks,\r\n        removeLocalAudioTrack,\r\n        removeLocalVideoTrack,\r\n        isSharingScreen,\r\n        toggleScreenShare,\r\n        getAudioAndVideoTracks,\r\n      }}\r\n    >\r\n      <SelectedParticipantProvider room={room}>{children}</SelectedParticipantProvider>\r\n      {/* \r\n        The AttachVisibilityHandler component is using the useLocalVideoToggle hook\r\n        which must be used within the VideoContext Provider.\r\n      */}\r\n      <AttachVisibilityHandler />\r\n    </VideoContext.Provider>\r\n  );\r\n}\r\n","import { DEFAULT_VIDEO_CONSTRAINTS, SELECTED_AUDIO_INPUT_KEY, SELECTED_VIDEO_INPUT_KEY } from '../../../constants';\r\nimport { useCallback, useState } from 'react';\r\nimport Video, { LocalVideoTrack, LocalAudioTrack, CreateLocalTrackOptions } from 'twilio-video';\r\nimport useDevices from '../../../hooks/useDevices/useDevices';\r\n\r\nexport default function useLocalTracks() {\r\n  const [audioTrack, setAudioTrack] = useState<LocalAudioTrack>();\r\n  const [videoTrack, setVideoTrack] = useState<LocalVideoTrack>();\r\n  const [isAcquiringLocalTracks, setIsAcquiringLocalTracks] = useState(false);\r\n  const { audioInputDevices, videoInputDevices, hasAudioInputDevices, hasVideoInputDevices } = useDevices();\r\n\r\n  const getLocalAudioTrack = useCallback((deviceId?: string) => {\r\n    const options: CreateLocalTrackOptions = {};\r\n\r\n    if (deviceId) {\r\n      options.deviceId = { exact: deviceId };\r\n    }\r\n\r\n    return Video.createLocalAudioTrack(options).then(newTrack => {\r\n      setAudioTrack(newTrack);\r\n      return newTrack;\r\n    });\r\n  }, []);\r\n\r\n  const getLocalVideoTrack = useCallback(() => {\r\n    const selectedVideoDeviceId = window.localStorage.getItem(SELECTED_VIDEO_INPUT_KEY);\r\n\r\n    const hasSelectedVideoDevice = videoInputDevices.some(\r\n      device => selectedVideoDeviceId && device.deviceId === selectedVideoDeviceId\r\n    );\r\n\r\n    const options: CreateLocalTrackOptions = {\r\n      ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\r\n      name: `camera-${Date.now()}`,\r\n      ...(hasSelectedVideoDevice && { deviceId: { exact: selectedVideoDeviceId! } }),\r\n    };\r\n\r\n    return Video.createLocalVideoTrack(options).then(newTrack => {\r\n      setVideoTrack(newTrack);\r\n      return newTrack;\r\n    });\r\n  }, [videoInputDevices]);\r\n\r\n  const removeLocalAudioTrack = useCallback(() => {\r\n    if (audioTrack) {\r\n      audioTrack.stop();\r\n      setAudioTrack(undefined);\r\n    }\r\n  }, [audioTrack]);\r\n\r\n  const removeLocalVideoTrack = useCallback(() => {\r\n    if (videoTrack) {\r\n      videoTrack.stop();\r\n      setVideoTrack(undefined);\r\n    }\r\n  }, [videoTrack]);\r\n\r\n  const getAudioAndVideoTracks = useCallback(() => {\r\n    if (!hasAudioInputDevices && !hasVideoInputDevices) return Promise.resolve();\r\n    if (isAcquiringLocalTracks || audioTrack || videoTrack) return Promise.resolve();\r\n\r\n    setIsAcquiringLocalTracks(true);\r\n\r\n    const selectedAudioDeviceId = window.localStorage.getItem(SELECTED_AUDIO_INPUT_KEY);\r\n    const selectedVideoDeviceId = window.localStorage.getItem(SELECTED_VIDEO_INPUT_KEY);\r\n\r\n    const hasSelectedAudioDevice = audioInputDevices.some(\r\n      device => selectedAudioDeviceId && device.deviceId === selectedAudioDeviceId\r\n    );\r\n    const hasSelectedVideoDevice = videoInputDevices.some(\r\n      device => selectedVideoDeviceId && device.deviceId === selectedVideoDeviceId\r\n    );\r\n\r\n    const localTrackConstraints = {\r\n      video: hasVideoInputDevices && {\r\n        ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\r\n        name: `camera-${Date.now()}`,\r\n        ...(hasSelectedVideoDevice && { deviceId: { exact: selectedVideoDeviceId! } }),\r\n      },\r\n      audio: hasSelectedAudioDevice ? { deviceId: { exact: selectedAudioDeviceId! } } : hasAudioInputDevices,\r\n    };\r\n\r\n    return Video.createLocalTracks(localTrackConstraints)\r\n      .then(tracks => {\r\n        const newVideoTrack = tracks.find(track => track.kind === 'video');\r\n        const newAudioTrack = tracks.find(track => track.kind === 'audio');\r\n        if (newVideoTrack) {\r\n          setVideoTrack(newVideoTrack as LocalVideoTrack);\r\n        }\r\n        if (newAudioTrack) {\r\n          setAudioTrack(newAudioTrack as LocalAudioTrack);\r\n        }\r\n      })\r\n      .finally(() => setIsAcquiringLocalTracks(false));\r\n  }, [\r\n    hasAudioInputDevices,\r\n    hasVideoInputDevices,\r\n    audioTrack,\r\n    videoTrack,\r\n    audioInputDevices,\r\n    videoInputDevices,\r\n    isAcquiringLocalTracks,\r\n  ]);\r\n\r\n  const localTracks = [audioTrack, videoTrack].filter(track => track !== undefined) as (\r\n    | LocalAudioTrack\r\n    | LocalVideoTrack\r\n  )[];\r\n\r\n  return {\r\n    localTracks,\r\n    getLocalVideoTrack,\r\n    getLocalAudioTrack,\r\n    isAcquiringLocalTracks,\r\n    removeLocalAudioTrack,\r\n    removeLocalVideoTrack,\r\n    getAudioAndVideoTracks,\r\n  };\r\n}\r\n","import { Room, TwilioError } from 'twilio-video';\r\nimport { useEffect } from 'react';\r\n\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleRoomDisconnectionErrors(room: Room | null, onError: Callback) {\r\n  useEffect(() => {\r\n    if (room) {\r\n      const onDisconnected = (_: Room, error: TwilioError) => {\r\n        if (error) {\r\n          onError(error);\r\n        }\r\n      };\r\n\r\n      room.on('disconnected', onDisconnected);\r\n      return () => {\r\n        room.off('disconnected', onDisconnected);\r\n      };\r\n    }\r\n  }, [room, onError]);\r\n}\r\n","import { Room } from 'twilio-video';\r\nimport { useEffect } from 'react';\r\n\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleTrackPublicationFailed(room: Room | null, onError: Callback) {\r\n  useEffect(() => {\r\n    if (room) {\r\n      room.localParticipant.on('trackPublicationFailed', onError);\r\n      return () => {\r\n        room.localParticipant.off('trackPublicationFailed', onError);\r\n      };\r\n    }\r\n  }, [room, onError]);\r\n}\r\n","import { useState, useCallback, useRef } from 'react';\r\nimport { LogLevels, Track, Room } from 'twilio-video';\r\nimport { ErrorCallback } from '../../../types';\r\n\r\ninterface MediaStreamTrackPublishOptions {\r\n  name?: string;\r\n  priority: Track.Priority;\r\n  logLevel: LogLevels;\r\n}\r\n\r\nexport default function useScreenShareToggle(room: Room | null, onError: ErrorCallback) {\r\n  const [isSharing, setIsSharing] = useState(false);\r\n  const stopScreenShareRef = useRef<() => void>(null!);\r\n\r\n  const shareScreen = useCallback(() => {\r\n    navigator.mediaDevices\r\n      .getDisplayMedia({\r\n        audio: false,\r\n        video: {\r\n          frameRate: 10,\r\n          height: 1080,\r\n          width: 1920,\r\n        },\r\n      })\r\n      .then(stream => {\r\n        const track = stream.getTracks()[0];\r\n\r\n        // All video tracks are published with 'low' priority. This works because the video\r\n        // track that is displayed in the 'MainParticipant' component will have it's priority\r\n        // set to 'high' via track.setPriority()\r\n        room!.localParticipant\r\n          .publishTrack(track, {\r\n            name: 'screen', // Tracks can be named to easily find them later\r\n            priority: 'low', // Priority is set to high by the subscriber when the video track is rendered\r\n          } as MediaStreamTrackPublishOptions)\r\n          .then(trackPublication => {\r\n            stopScreenShareRef.current = () => {\r\n              room!.localParticipant.unpublishTrack(track);\r\n              // TODO: remove this if the SDK is updated to emit this event\r\n              room!.localParticipant.emit('trackUnpublished', trackPublication);\r\n              track.stop();\r\n              setIsSharing(false);\r\n            };\r\n\r\n            track.onended = stopScreenShareRef.current;\r\n            setIsSharing(true);\r\n          })\r\n          .catch(onError);\r\n      })\r\n      .catch(error => {\r\n        // Don't display an error if the user closes the screen share dialog\r\n        if (error.name !== 'AbortError' && error.name !== 'NotAllowedError') {\r\n          onError(error);\r\n        }\r\n      });\r\n  }, [room, onError]);\r\n\r\n  const toggleScreenShare = useCallback(() => {\r\n    if (room) {\r\n      !isSharing ? shareScreen() : stopScreenShareRef.current();\r\n    }\r\n  }, [isSharing, shareScreen, stopScreenShareRef, room]);\r\n\r\n  return [isSharing, toggleScreenShare] as const;\r\n}\r\n","import { useContext } from 'react';\r\nimport { VideoContext } from '../../components/VideoProvider';\r\n\r\nexport default function useVideoContext() {\r\n  const context = useContext(VideoContext);\r\n  if (!context) {\r\n    throw new Error('useVideoContext must be used within a VideoProvider');\r\n  }\r\n  return context;\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport { Button } from '@material-ui/core';\r\n\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    button: {\r\n      background: theme.brand,\r\n      color: 'white',\r\n      '&:hover': {\r\n        background: '#600101',\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function EndCallButton(props: { className?: string }) {\r\n  const classes = useStyles();\r\n  const { room, isSharingScreen, toggleScreenShare, removeLocalAudioTrack, removeLocalVideoTrack } = useVideoContext();\r\n\r\n  const handleClick = () => {\r\n    if (isSharingScreen) {\r\n      toggleScreenShare();\r\n    }\r\n    removeLocalAudioTrack();\r\n    removeLocalVideoTrack();\r\n    room!.disconnect();\r\n  };\r\n\r\n  return (\r\n    <Button onClick={handleClick} className={clsx(classes.button, props.className)} data-cy-disconnect>\r\n      Disconnect\r\n    </Button>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function FlipCameraIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"25\" height=\"24\" viewBox=\"0 0 25 24\">\r\n      <g fill=\"none\" fillRule=\"evenodd\">\r\n        <g fill=\"#707578\">\r\n          <path\r\n            d=\"M12 3.5c4.694 0 8.5 3.806 8.5 8.5s-3.806 8.5-8.5 8.5-8.5-3.806-8.5-8.5S7.306 3.5 12 3.5zm0 1c-4.142 0-7.5 3.358-7.5 7.5 0 4.142 3.358 7.5 7.5 7.5 4.142 0 7.5-3.358 7.5-7.5 0-4.142-3.358-7.5-7.5-7.5zm1.367 3.429C14.959 8.492 16.1 10.215 16.1 12c0 1.16-.481 2.294-1.256 3.1h.356c.245 0 .45.177.492.41l.008.09c0 .245-.177.45-.41.492l-.09.008h-2.008l-.048-.003-.034-.005c-.088-.017-.167-.055-.233-.11l-.06-.06c-.037-.044-.067-.096-.087-.151l-.001-.004-.012-.04c-.004-.012-.007-.024-.009-.037v-.005c-.005-.024-.006-.042-.007-.06L12.7 13.6c0-.276.224-.5.5-.5.245 0 .45.177.492.41l.008.09v1.176c.833-.6 1.4-1.676 1.4-2.776 0-1.373-.886-2.71-2.067-3.129-.26-.092-.396-.377-.304-.638.092-.26.378-.396.638-.304zm-2.559-.03c.03.001.058.004.086.01l.062.016.018.006c.04.015.075.034.108.056.086.059.152.143.188.242l.001.004.008.025c.006.017.01.034.013.052l.008.09v2c0 .276-.224.5-.5.5-.245 0-.45-.177-.492-.41l-.008-.09V9.224c-.833.6-1.4 1.676-1.4 2.776 0 1.373.886 2.71 2.067 3.129.26.092.396.377.304.638-.092.26-.378.396-.638.304C9.041 15.508 7.9 13.785 7.9 12c0-1.16.481-2.294 1.255-3.1H8.8c-.245 0-.45-.177-.492-.41L8.3 8.4c0-.245.177-.45.41-.492L8.8 7.9h2.008z\"\r\n            transform=\"translate(-233 -689) translate(-1 673) translate(37 16) translate(197.298)\"\r\n          />\r\n        </g>\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { AudioTrack, VideoTrack } from 'twilio-video';\r\n\r\n/*\r\n * This hook allows components to reliably use the 'mediaStreamTrack' property of\r\n * an AudioTrack or a VideoTrack. Whenever 'localTrack.restart(...)' is called, it\r\n * will replace the mediaStreamTrack property of the localTrack, but the localTrack\r\n * object will stay the same. Therefore this hook is needed in order for components\r\n * to rerender in response to the mediaStreamTrack changing.\r\n */\r\nexport default function useMediaStreamTrack(track?: AudioTrack | VideoTrack) {\r\n  const [mediaStreamTrack, setMediaStreamTrack] = useState(track?.mediaStreamTrack);\r\n\r\n  useEffect(() => {\r\n    setMediaStreamTrack(track?.mediaStreamTrack);\r\n\r\n    if (track) {\r\n      const handleStarted = () => setMediaStreamTrack(track.mediaStreamTrack);\r\n      track.on('started', handleStarted);\r\n      return () => {\r\n        track.off('started', handleStarted);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return mediaStreamTrack;\r\n}\r\n","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { Button } from '@material-ui/core';\r\nimport { DEFAULT_VIDEO_CONSTRAINTS } from '../../../constants';\r\nimport FlipCameraIcon from './FlipCameraIcon';\r\nimport { LocalVideoTrack } from 'twilio-video';\r\nimport useDevices from '../../../hooks/useDevices/useDevices';\r\nimport useMediaStreamTrack from '../../../hooks/useMediaStreamTrack/useMediaStreamTrack';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function FlipCameraButton() {\r\n  const { localTracks } = useVideoContext();\r\n  const [supportsFacingMode, setSupportsFacingMode] = useState<Boolean | null>(null);\r\n  const videoTrack = localTracks.find(track => track.name.includes('camera')) as LocalVideoTrack;\r\n  const mediaStreamTrack = useMediaStreamTrack(videoTrack);\r\n  const { videoInputDevices } = useDevices();\r\n\r\n  useEffect(() => {\r\n    // The 'supportsFacingMode' variable determines if this component is rendered\r\n    // If 'facingMode' exists, we will set supportsFacingMode to true.\r\n    // However, if facingMode is ever undefined again (when the user unpublishes video), we\r\n    // won't set 'supportsFacingMode' to false. This prevents the icon from briefly\r\n    // disappearing when the user switches their front/rear camera.\r\n    const currentFacingMode = mediaStreamTrack?.getSettings().facingMode;\r\n    if (currentFacingMode && supportsFacingMode === null) {\r\n      setSupportsFacingMode(true);\r\n    }\r\n  }, [mediaStreamTrack, supportsFacingMode]);\r\n\r\n  const toggleFacingMode = useCallback(() => {\r\n    const newFacingMode = mediaStreamTrack?.getSettings().facingMode === 'user' ? 'environment' : 'user';\r\n    videoTrack.restart({\r\n      ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\r\n      facingMode: newFacingMode,\r\n    });\r\n  }, [mediaStreamTrack, videoTrack]);\r\n\r\n  return supportsFacingMode && videoInputDevices.length > 1 ? (\r\n    <Button onClick={toggleFacingMode} disabled={!videoTrack} startIcon={<FlipCameraIcon />}>\r\n      Flip Camera\r\n    </Button>\r\n  ) : null;\r\n}\r\n","import { isMobile } from '../../utils';\r\nimport { RenderDimensionValue } from './renderDimensions';\r\nimport { Track, VideoBandwidthProfileOptions } from 'twilio-video';\r\n\r\nexport interface Settings {\r\n  trackSwitchOffMode: VideoBandwidthProfileOptions['trackSwitchOffMode'];\r\n  dominantSpeakerPriority?: Track.Priority;\r\n  bandwidthProfileMode: VideoBandwidthProfileOptions['mode'];\r\n  maxTracks: string;\r\n  maxAudioBitrate: string;\r\n  renderDimensionLow?: RenderDimensionValue;\r\n  renderDimensionStandard?: RenderDimensionValue;\r\n  renderDimensionHigh?: RenderDimensionValue;\r\n}\r\n\r\ntype SettingsKeys = keyof Settings;\r\n\r\nexport interface SettingsAction {\r\n  name: SettingsKeys;\r\n  value: string;\r\n}\r\n\r\nexport const initialSettings: Settings = {\r\n  trackSwitchOffMode: undefined,\r\n  dominantSpeakerPriority: 'standard',\r\n  bandwidthProfileMode: 'collaboration',\r\n  maxTracks: isMobile ? '5' : '10',\r\n  maxAudioBitrate: '16000',\r\n  renderDimensionLow: 'low',\r\n  renderDimensionStandard: '960p',\r\n  renderDimensionHigh: 'wide1080p',\r\n};\r\n\r\n// This inputLabels object is used by ConnectionOptions.tsx. It is used to populate the id, name, and label props\r\n// of the various input elements. Using a typed object like this (instead of strings) eliminates the possibility\r\n// of there being a typo.\r\nexport const inputLabels = (() => {\r\n  const target: any = {};\r\n  for (const setting in initialSettings) {\r\n    target[setting] = setting as SettingsKeys;\r\n  }\r\n  return target as { [key in SettingsKeys]: string };\r\n})();\r\n\r\nexport function settingsReducer(state: Settings, action: SettingsAction) {\r\n  return {\r\n    ...state,\r\n    [action.name]: action.value === 'default' ? undefined : action.value,\r\n  };\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport * as firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n};\r\n\r\nexport default function useFirebaseAuth() {\r\n  const [user, setUser] = useState<firebase.User | null>(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n\r\n  const getToken = useCallback(\r\n    async (identity: string, roomName: string) => {\r\n      const headers = new window.Headers();\r\n\r\n      const idToken = await user!.getIdToken();\r\n      headers.set('Authorization', idToken);\r\n\r\n      const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\r\n      const params = new window.URLSearchParams({ identity, roomName });\r\n\r\n      return fetch(`${endpoint}?${params}`, { headers }).then(res => res.text());\r\n    },\r\n    [user]\r\n  );\r\n\r\n  useEffect(() => {\r\n    firebase.initializeApp(firebaseConfig);\r\n    firebase.auth().onAuthStateChanged(newUser => {\r\n      setUser(newUser);\r\n      setIsAuthReady(true);\r\n    });\r\n  }, []);\r\n\r\n  const signIn = useCallback(() => {\r\n    const provider = new firebase.auth.GoogleAuthProvider();\r\n    provider.addScope('https://www.googleapis.com/auth/plus.login');\r\n\r\n    return firebase\r\n      .auth()\r\n      .signInWithPopup(provider)\r\n      .then(newUser => {\r\n        setUser(newUser.user);\r\n      });\r\n  }, []);\r\n\r\n  const signOut = useCallback(() => {\r\n    return firebase\r\n      .auth()\r\n      .signOut()\r\n      .then(() => {\r\n        setUser(null);\r\n      });\r\n  }, []);\r\n\r\n  return { user, signIn, signOut, isAuthReady, getToken };\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { RoomType } from '../../types';\r\n\r\nexport function getPasscode() {\r\n  const match = window.location.search.match(/passcode=(.*)&?/);\r\n  const passcode = match ? match[1] : window.sessionStorage.getItem('passcode');\r\n  return passcode;\r\n}\r\n\r\nexport function fetchToken(name: string, room: string, passcode: string, create_room = true) {\r\n  return fetch(`/token`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ user_identity: name, room_name: room, passcode, create_room }),\r\n  });\r\n}\r\n\r\nexport function verifyPasscode(passcode: string) {\r\n  return fetchToken('temp-name', 'temp-room', passcode, false /* create_room */).then(async res => {\r\n    const jsonResponse = await res.json();\r\n    if (res.status === 401) {\r\n      return { isValid: false, error: jsonResponse.error?.message };\r\n    }\r\n\r\n    if (res.ok && jsonResponse.token) {\r\n      return { isValid: true };\r\n    }\r\n  });\r\n}\r\n\r\nexport function getErrorMessage(message: string) {\r\n  switch (message) {\r\n    case 'passcode incorrect':\r\n      return 'Passcode is incorrect';\r\n    case 'passcode expired':\r\n      return 'Passcode has expired';\r\n    default:\r\n      return message;\r\n  }\r\n}\r\n\r\nexport default function usePasscodeAuth() {\r\n  const history = useHistory();\r\n\r\n  const [user, setUser] = useState<{ displayName: undefined; photoURL: undefined; passcode: string } | null>(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n  const [roomType, setRoomType] = useState<RoomType>();\r\n\r\n  const getToken = useCallback(\r\n    (name: string, room: string) => {\r\n      return fetchToken(name, room, user!.passcode)\r\n        .then(async res => {\r\n          if (res.ok) {\r\n            return res;\r\n          }\r\n          const json = await res.json();\r\n          const errorMessage = getErrorMessage(json.error?.message || res.statusText);\r\n          throw Error(errorMessage);\r\n        })\r\n        .then(res => res.json())\r\n        .then(res => {\r\n          setRoomType(res.room_type);\r\n          return res.token as string;\r\n        });\r\n    },\r\n    [user]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const passcode = getPasscode();\r\n\r\n    if (passcode) {\r\n      verifyPasscode(passcode)\r\n        .then(verification => {\r\n          if (verification?.isValid) {\r\n            setUser({ passcode } as any);\r\n            window.sessionStorage.setItem('passcode', passcode);\r\n            history.replace(window.location.pathname);\r\n          }\r\n        })\r\n        .then(() => setIsAuthReady(true));\r\n    } else {\r\n      setIsAuthReady(true);\r\n    }\r\n  }, [history]);\r\n\r\n  const signIn = useCallback((passcode: string) => {\r\n    return verifyPasscode(passcode).then(verification => {\r\n      if (verification?.isValid) {\r\n        setUser({ passcode } as any);\r\n        window.sessionStorage.setItem('passcode', passcode);\r\n      } else {\r\n        throw new Error(getErrorMessage(verification?.error));\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const signOut = useCallback(() => {\r\n    setUser(null);\r\n    window.sessionStorage.removeItem('passcode');\r\n    return Promise.resolve();\r\n  }, []);\r\n\r\n  return { user, isAuthReady, getToken, signIn, signOut, roomType };\r\n}\r\n","import React, { createContext, useContext, useReducer, useState } from 'react';\r\nimport { RoomType } from '../types';\r\nimport { TwilioError } from 'twilio-video';\r\nimport { settingsReducer, initialSettings, Settings, SettingsAction } from './settings/settingsReducer';\r\nimport useActiveSinkId from './useActiveSinkId/useActiveSinkId';\r\nimport useFirebaseAuth from './useFirebaseAuth/useFirebaseAuth';\r\nimport usePasscodeAuth from './usePasscodeAuth/usePasscodeAuth';\r\nimport { User } from 'firebase';\r\n\r\nexport interface StateContextType {\r\n  error: TwilioError | null;\r\n  setError(error: TwilioError | null): void;\r\n  getToken(name: string, room: string, passcode?: string): Promise<string>;\r\n  user?: User | null | { displayName: undefined; photoURL: undefined; passcode?: string };\r\n  signIn?(passcode?: string): Promise<void>;\r\n  signOut?(): Promise<void>;\r\n  isAuthReady?: boolean;\r\n  isFetching: boolean;\r\n  activeSinkId: string;\r\n  setActiveSinkId(sinkId: string): void;\r\n  settings: Settings;\r\n  dispatchSetting: React.Dispatch<SettingsAction>;\r\n  roomType?: RoomType;\r\n}\r\n\r\nexport const StateContext = createContext<StateContextType>(null!);\r\n\r\n/*\r\n  The 'react-hooks/rules-of-hooks' linting rules prevent React Hooks fron being called\r\n  inside of if() statements. This is because hooks must always be called in the same order\r\n  every time a component is rendered. The 'react-hooks/rules-of-hooks' rule is disabled below\r\n  because the \"if (process.env.REACT_APP_SET_AUTH === 'firebase')\" statements are evaluated\r\n  at build time (not runtime). If the statement evaluates to false, then the code is not\r\n  included in the bundle that is produced (due to tree-shaking). Thus, in this instance, it\r\n  is ok to call hooks inside if() statements.\r\n*/\r\nexport default function AppStateProvider(props: React.PropsWithChildren<{}>) {\r\n  const [error, setError] = useState<TwilioError | null>(null);\r\n  const [isFetching, setIsFetching] = useState(false);\r\n  const [activeSinkId, setActiveSinkId] = useActiveSinkId();\r\n  const [settings, dispatchSetting] = useReducer(settingsReducer, initialSettings);\r\n\r\n  let contextValue = {\r\n    error,\r\n    setError,\r\n    isFetching,\r\n    activeSinkId,\r\n    setActiveSinkId,\r\n    settings,\r\n    dispatchSetting,\r\n  } as StateContextType;\r\n\r\n  if (process.env.REACT_APP_SET_AUTH === 'firebase') {\r\n    contextValue = {\r\n      ...contextValue,\r\n      ...useFirebaseAuth(), // eslint-disable-line react-hooks/rules-of-hooks\r\n    };\r\n  } else if (process.env.REACT_APP_SET_AUTH === 'passcode') {\r\n    contextValue = {\r\n      ...contextValue,\r\n      ...usePasscodeAuth(), // eslint-disable-line react-hooks/rules-of-hooks\r\n    };\r\n  } else {\r\n    contextValue = {\r\n      ...contextValue,\r\n      getToken: async (identity, roomName) => {\r\n        const headers = new window.Headers();\r\n        const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\r\n        const params = new window.URLSearchParams({ identity, roomName });\r\n\r\n        return fetch(`${endpoint}?${params}`, { headers }).then(res => res.text());\r\n      },\r\n    };\r\n  }\r\n\r\n  const getToken: StateContextType['getToken'] = (name, room) => {\r\n    setIsFetching(true);\r\n    return contextValue\r\n      .getToken(name, room)\r\n      .then(res => {\r\n        setIsFetching(false);\r\n        return res;\r\n      })\r\n      .catch(err => {\r\n        setError(err);\r\n        setIsFetching(false);\r\n        return Promise.reject(err);\r\n      });\r\n  };\r\n\r\n  return <StateContext.Provider value={{ ...contextValue, getToken }}>{props.children}</StateContext.Provider>;\r\n}\r\n\r\nexport function useAppState() {\r\n  const context = useContext(StateContext);\r\n  if (!context) {\r\n    throw new Error('useAppState must be used within the AppStateProvider');\r\n  }\r\n  return context;\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { SELECTED_AUDIO_OUTPUT_KEY } from '../../constants';\r\nimport useDevices from '../../hooks/useDevices/useDevices';\r\n\r\nexport default function useActiveSinkId() {\r\n  const { audioOutputDevices } = useDevices();\r\n  const [activeSinkId, _setActiveSinkId] = useState('default');\r\n\r\n  const setActiveSinkId = useCallback(\r\n    (sinkId: string) => {\r\n      window.localStorage.setItem(SELECTED_AUDIO_OUTPUT_KEY, sinkId);\r\n      _setActiveSinkId(sinkId);\r\n    },\r\n    [_setActiveSinkId]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const selectedSinkId = window.localStorage.getItem(SELECTED_AUDIO_OUTPUT_KEY);\r\n    const hasSelectedAudioOutputDevice = audioOutputDevices.some(\r\n      device => selectedSinkId && device.deviceId === selectedSinkId\r\n    );\r\n    if (hasSelectedAudioOutputDevice) {\r\n      _setActiveSinkId(selectedSinkId!);\r\n    }\r\n  }, [audioOutputDevices]);\r\n\r\n  return [activeSinkId, setActiveSinkId] as const;\r\n}\r\n","import React, { PropsWithChildren } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Divider from '@material-ui/core/Divider';\r\n\r\nimport { version as appVersion } from '../../../package.json';\r\nimport Video from 'twilio-video';\r\nimport { useAppState } from '../../state';\r\n\r\ninterface AboutDialogProps {\r\n  open: boolean;\r\n  onClose(): void;\r\n}\r\n\r\nfunction AboutDialog({ open, onClose }: PropsWithChildren<AboutDialogProps>) {\r\n  const { roomType } = useAppState();\r\n  return (\r\n    <Dialog open={open} onClose={onClose} fullWidth={true} maxWidth=\"xs\">\r\n      <DialogTitle>About</DialogTitle>\r\n      <Divider />\r\n      <DialogContent>\r\n        <DialogContentText>Browser supported: {String(Video.isSupported)}</DialogContentText>\r\n        <DialogContentText>SDK Version: {Video.version}</DialogContentText>\r\n        <DialogContentText>App Version: {appVersion}</DialogContentText>\r\n        <DialogContentText>Deployed Tag: {process.env.REACT_APP_GIT_TAG || 'N/A'}</DialogContentText>\r\n        <DialogContentText>Deployed Commit Hash: {process.env.REACT_APP_GIT_COMMIT || 'N/A'}</DialogContentText>\r\n        {roomType && <DialogContentText>Room Type: {roomType}</DialogContentText>}\r\n      </DialogContent>\r\n      <Divider />\r\n      <DialogActions>\r\n        <Button onClick={onClose} color=\"primary\" variant=\"contained\" autoFocus>\r\n          OK\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default AboutDialog;\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalAudioTrack, LocalVideoTrack, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\ntype TrackType = LocalAudioTrack | LocalVideoTrack | RemoteAudioTrack | RemoteVideoTrack | undefined;\r\n\r\nexport default function useIsTrackEnabled(track: TrackType) {\r\n  const [isEnabled, setIsEnabled] = useState(track ? track.isEnabled : false);\r\n\r\n  useEffect(() => {\r\n    setIsEnabled(track ? track.isEnabled : false);\r\n\r\n    if (track) {\r\n      const setEnabled = () => setIsEnabled(true);\r\n      const setDisabled = () => setIsEnabled(false);\r\n      track.on('enabled', setEnabled);\r\n      track.on('disabled', setDisabled);\r\n      return () => {\r\n        track.off('enabled', setEnabled);\r\n        track.off('disabled', setDisabled);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return isEnabled;\r\n}\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { AudioTrack, LocalAudioTrack, RemoteAudioTrack } from 'twilio-video';\r\nimport { interval } from 'd3-timer';\r\nimport useIsTrackEnabled from '../../hooks/useIsTrackEnabled/useIsTrackEnabled';\r\nimport useMediaStreamTrack from '../../hooks/useMediaStreamTrack/useMediaStreamTrack';\r\n\r\nlet clipId = 0;\r\nconst getUniqueClipId = () => clipId++;\r\n\r\n// @ts-ignore\r\nconst AudioContext = window.AudioContext || window.webkitAudioContext;\r\nlet audioContext: AudioContext;\r\n\r\nexport function initializeAnalyser(stream: MediaStream) {\r\n  audioContext = audioContext || new AudioContext();\r\n  const audioSource = audioContext.createMediaStreamSource(stream);\r\n\r\n  const analyser = audioContext.createAnalyser();\r\n  analyser.smoothingTimeConstant = 0.2;\r\n  analyser.fftSize = 256;\r\n\r\n  audioSource.connect(analyser);\r\n  return analyser;\r\n}\r\n\r\nfunction AudioLevelIndicator({ audioTrack, color = 'white' }: { audioTrack?: AudioTrack; color?: string }) {\r\n  const SVGRectRef = useRef<SVGRectElement>(null);\r\n  const [analyser, setAnalyser] = useState<AnalyserNode>();\r\n  const isTrackEnabled = useIsTrackEnabled(audioTrack as LocalAudioTrack | RemoteAudioTrack);\r\n  const mediaStreamTrack = useMediaStreamTrack(audioTrack);\r\n\r\n  useEffect(() => {\r\n    if (audioTrack && mediaStreamTrack && isTrackEnabled) {\r\n      // Here we create a new MediaStream from a clone of the mediaStreamTrack.\r\n      // A clone is created to allow multiple instances of this component for a single\r\n      // AudioTrack on iOS Safari.\r\n      let newMediaStream = new MediaStream([mediaStreamTrack.clone()]);\r\n\r\n      // Here we listen for the 'stopped' event on the audioTrack. When the audioTrack is stopped,\r\n      // we stop the cloned track that is stored in 'newMediaStream'. It is important that we stop\r\n      // all tracks when they are not in use. Browsers like Firefox don't let you create a new stream\r\n      // from a new audio device while the active audio device still has active tracks.\r\n      const stopAllMediaStreamTracks = () => newMediaStream.getTracks().forEach(track => track.stop());\r\n      audioTrack.on('stopped', stopAllMediaStreamTracks);\r\n\r\n      const reinitializeAnalyser = () => {\r\n        stopAllMediaStreamTracks();\r\n        newMediaStream = new MediaStream([mediaStreamTrack.clone()]);\r\n        setAnalyser(initializeAnalyser(newMediaStream));\r\n      };\r\n\r\n      setAnalyser(initializeAnalyser(newMediaStream));\r\n\r\n      // Here we reinitialize the AnalyserNode on focus to avoid an issue in Safari\r\n      // where the analysers stop functioning when the user switches to a new tab\r\n      // and switches back to the app.\r\n      window.addEventListener('focus', reinitializeAnalyser);\r\n\r\n      return () => {\r\n        stopAllMediaStreamTracks();\r\n        window.removeEventListener('focus', reinitializeAnalyser);\r\n        audioTrack.off('stopped', stopAllMediaStreamTracks);\r\n      };\r\n    }\r\n  }, [isTrackEnabled, mediaStreamTrack, audioTrack]);\r\n\r\n  useEffect(() => {\r\n    const SVGClipElement = SVGRectRef.current;\r\n\r\n    if (isTrackEnabled && SVGClipElement && analyser) {\r\n      const sampleArray = new Uint8Array(analyser.frequencyBinCount);\r\n\r\n      const timer = interval(() => {\r\n        analyser.getByteFrequencyData(sampleArray);\r\n        let values = 0;\r\n\r\n        const length = sampleArray.length;\r\n        for (let i = 0; i < length; i++) {\r\n          values += sampleArray[i];\r\n        }\r\n\r\n        const volume = Math.min(14, Math.max(0, Math.log10(values / length / 3) * 7));\r\n\r\n        SVGClipElement?.setAttribute('y', String(14 - volume));\r\n      }, 100);\r\n\r\n      return () => {\r\n        SVGClipElement.setAttribute('y', '14');\r\n        timer.stop();\r\n      };\r\n    }\r\n  }, [isTrackEnabled, analyser]);\r\n\r\n  // Each instance of this component will need a unique HTML ID\r\n  const clipPathId = `audio-level-clip-${getUniqueClipId()}`;\r\n\r\n  return isTrackEnabled ? (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" data-test-audio-indicator>\r\n      <defs>\r\n        <clipPath id={clipPathId}>\r\n          <rect ref={SVGRectRef} x=\"0\" y=\"14\" width=\"24\" height=\"24\" />\r\n        </clipPath>\r\n      </defs>\r\n      <g fill=\"none\" fillRule=\"evenodd\" transform=\"translate(.5)\">\r\n        <rect\r\n          clipPath={`url(#${clipPathId})`}\r\n          width=\"5.2\"\r\n          height=\"10\"\r\n          x=\"9.5\"\r\n          y=\"3.5\"\r\n          rx=\"6\"\r\n          ry=\"3\"\r\n          fill=\"#23BF6E\"\r\n        ></rect>\r\n        <path\r\n          fill={color}\r\n          strokeWidth=\"0\"\r\n          d=\"M17.389 10.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V17.09C8.395 16.836 6 14.281 6 11.167c0-.276.224-.5.5-.5s.5.224.5.5c0 2.73 2.214 4.944 4.944 4.944 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM11.944 4c1.566 0 2.834 1.268 2.834 2.833v4.334c0 1.564-1.268 2.833-2.834 2.833-1.564 0-2.833-1.27-2.833-2.833V6.833C9.111 5.268 10.38 4 11.944 4zm0 1c-1.012 0-1.833.82-1.833 1.833v4.334c0 1.012.822 1.833 1.833 1.833 1.013 0 1.834-.82 1.834-1.833V6.833c0-1.013-.82-1.833-1.834-1.833z\"\r\n        />\r\n      </g>\r\n    </svg>\r\n  ) : (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"24\"\r\n      height=\"24\"\r\n      viewBox=\"0 0 24 24\"\r\n      transform=\"translate(-0.5, 0)\"\r\n      data-test-audio-mute-icon\r\n    >\r\n      <g fill=\"none\" fillRule=\"evenodd\">\r\n        <path\r\n          fill={color}\r\n          strokeWidth=\"0\"\r\n          d=\"M11.889 6.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V13.09c-1.116-.093-2.145-.494-3-1.119l.717-.717c.793.54 1.751.857 2.783.857 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM1 6.667c.276 0 .5.224.5.5 0 .975.282 1.884.77 2.65l-.722.721C.888 9.58.5 8.418.5 7.167c0-.276.224-.5.5-.5zm8.277-1.031v1.53C9.278 8.732 8.01 10 6.445 10c-.446 0-.868-.103-1.243-.287l.776-.773c.149.039.306.06.467.06.963 0 1.751-.74 1.828-1.683l.006-.15v-.531l1-1zM6.444 0C8.01 0 9.278 1.268 9.278 2.833l-.002-.025-.999.999v-.974c0-.962-.74-1.75-1.682-1.827L6.445 1c-.962 0-1.751.74-1.828 1.683l-.006.15v4.334c0 .097.008.192.022.285l-.804.805c-.112-.269-.184-.558-.209-.86l-.009-.23V2.833C3.611 1.268 4.88 0 6.444 0z\"\r\n          transform=\"translate(6.5 4)\"\r\n        />\r\n        <path\r\n          fill=\"red\"\r\n          strokeWidth=\"0\"\r\n          d=\"M12.146.646c.196-.195.512-.195.708 0 .173.174.192.443.057.638l-.057.07-12 12c-.196.195-.512.195-.708 0-.173-.174-.192-.443-.057-.638l.057-.07 12-12z\"\r\n          transform=\"translate(6.5 4)\"\r\n        />\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n\r\nexport default React.memo(AudioLevelIndicator);\r\n","import React from 'react';\r\nimport AudioLevelIndicator from '../../AudioLevelIndicator/AudioLevelIndicator';\r\nimport { LocalAudioTrack } from 'twilio-video';\r\nimport { FormControl, MenuItem, Typography, Select, Grid } from '@material-ui/core';\r\nimport { SELECTED_AUDIO_INPUT_KEY } from '../../../constants';\r\nimport useDevices from '../../../hooks/useDevices/useDevices';\r\nimport useMediaStreamTrack from '../../../hooks/useMediaStreamTrack/useMediaStreamTrack';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function AudioInputList() {\r\n  const { audioInputDevices } = useDevices();\r\n  const { localTracks } = useVideoContext();\r\n\r\n  const localAudioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\r\n  const mediaStreamTrack = useMediaStreamTrack(localAudioTrack);\r\n  const localAudioInputDeviceId = mediaStreamTrack?.getSettings().deviceId;\r\n\r\n  function replaceTrack(newDeviceId: string) {\r\n    window.localStorage.setItem(SELECTED_AUDIO_INPUT_KEY, newDeviceId);\r\n    localAudioTrack?.restart({ deviceId: { exact: newDeviceId } });\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Typography variant=\"subtitle2\" gutterBottom>\r\n        Audio Input\r\n      </Typography>\r\n      <Grid container alignItems=\"center\" justify=\"space-between\">\r\n        <div className=\"inputSelect\">\r\n          {audioInputDevices.length > 1 ? (\r\n            <FormControl fullWidth>\r\n              <Select\r\n                onChange={e => replaceTrack(e.target.value as string)}\r\n                value={localAudioInputDeviceId || ''}\r\n                variant=\"outlined\"\r\n              >\r\n                {audioInputDevices.map(device => (\r\n                  <MenuItem value={device.deviceId} key={device.deviceId}>\r\n                    {device.label}\r\n                  </MenuItem>\r\n                ))}\r\n              </Select>\r\n            </FormControl>\r\n          ) : (\r\n            <Typography>{localAudioTrack?.mediaStreamTrack.label || 'No Local Audio'}</Typography>\r\n          )}\r\n        </div>\r\n        <AudioLevelIndicator audioTrack={localAudioTrack} color=\"black\" />\r\n      </Grid>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { FormControl, MenuItem, Typography, Select } from '@material-ui/core';\r\nimport { useAppState } from '../../../state';\r\nimport useDevices from '../../../hooks/useDevices/useDevices';\r\n\r\nexport default function AudioOutputList() {\r\n  const { audioOutputDevices } = useDevices();\r\n  const { activeSinkId, setActiveSinkId } = useAppState();\r\n  const activeOutputLabel = audioOutputDevices.find(device => device.deviceId === activeSinkId)?.label;\r\n\r\n  return (\r\n    <div className=\"inputSelect\">\r\n      {audioOutputDevices.length > 1 ? (\r\n        <FormControl fullWidth>\r\n          <Typography variant=\"subtitle2\" gutterBottom>\r\n            Audio Output\r\n          </Typography>\r\n          <Select onChange={e => setActiveSinkId(e.target.value as string)} value={activeSinkId} variant=\"outlined\">\r\n            {audioOutputDevices.map(device => (\r\n              <MenuItem value={device.deviceId} key={device.deviceId}>\r\n                {device.label}\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </FormControl>\r\n      ) : (\r\n        <>\r\n          <Typography variant=\"subtitle2\">Audio Output</Typography>\r\n          <Typography>{activeOutputLabel || 'System Default Audio Output'}</Typography>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useRef, useEffect } from 'react';\r\nimport { IVideoTrack } from '../../types';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport { Track } from 'twilio-video';\r\nimport useMediaStreamTrack from '../../hooks/useMediaStreamTrack/useMediaStreamTrack';\r\nimport useVideoTrackDimensions from '../../hooks/useVideoTrackDimensions/useVideoTrackDimensions';\r\n\r\nconst Video = styled('video')({\r\n  width: '100%',\r\n  height: '100%',\r\n});\r\n\r\ninterface VideoTrackProps {\r\n  track: IVideoTrack;\r\n  isLocal?: boolean;\r\n  priority?: Track.Priority | null;\r\n}\r\n\r\nexport default function VideoTrack({ track, isLocal, priority }: VideoTrackProps) {\r\n  const ref = useRef<HTMLVideoElement>(null!);\r\n  const mediaStreamTrack = useMediaStreamTrack(track);\r\n  const dimensions = useVideoTrackDimensions(track);\r\n  const isPortrait = (dimensions?.height ?? 0) > (dimensions?.width ?? 0);\r\n\r\n  useEffect(() => {\r\n    const el = ref.current;\r\n    el.muted = true;\r\n    if (track.setPriority && priority) {\r\n      track.setPriority(priority);\r\n    }\r\n    track.attach(el);\r\n    return () => {\r\n      track.detach(el);\r\n      if (track.setPriority && priority) {\r\n        // Passing `null` to setPriority will set the track's priority to that which it was published with.\r\n        track.setPriority(null);\r\n      }\r\n    };\r\n  }, [track, priority]);\r\n\r\n  // The local video track is mirrored if it is not facing the environment.\r\n  const isFrontFacing = mediaStreamTrack?.getSettings().facingMode !== 'environment';\r\n  const style = {\r\n    transform: isLocal && isFrontFacing ? 'rotateY(180deg)' : '',\r\n    objectFit: isPortrait || track.name.includes('screen') ? ('contain' as const) : ('cover' as const),\r\n  };\r\n\r\n  return <Video ref={ref} style={style} />;\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalVideoTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\ntype TrackType = LocalVideoTrack | RemoteVideoTrack;\r\n\r\nexport default function useVideoTrackDimensions(track?: TrackType) {\r\n  const [dimensions, setDimensions] = useState(track?.dimensions);\r\n\r\n  useEffect(() => {\r\n    setDimensions(track?.dimensions);\r\n\r\n    if (track) {\r\n      const handleDimensionsChanged = (newTrack: TrackType) =>\r\n        setDimensions({\r\n          width: newTrack.dimensions.width,\r\n          height: newTrack.dimensions.height,\r\n        });\r\n      track.on('dimensionsChanged', handleDimensionsChanged);\r\n      return () => {\r\n        track.off('dimensionsChanged', handleDimensionsChanged);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return dimensions;\r\n}\r\n","import React, { useState } from 'react';\r\nimport { DEFAULT_VIDEO_CONSTRAINTS, SELECTED_VIDEO_INPUT_KEY } from '../../../constants';\r\nimport { FormControl, MenuItem, Typography, Select } from '@material-ui/core';\r\nimport { LocalVideoTrack } from 'twilio-video';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport VideoTrack from '../../VideoTrack/VideoTrack';\r\nimport useDevices from '../../../hooks/useDevices/useDevices';\r\nimport useMediaStreamTrack from '../../../hooks/useMediaStreamTrack/useMediaStreamTrack';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nconst useStyles = makeStyles({\r\n  preview: {\r\n    width: '300px',\r\n    maxHeight: '200px',\r\n    margin: '0.5em auto',\r\n    '& video': {\r\n      maxHeight: '200px',\r\n    },\r\n  },\r\n});\r\n\r\nexport default function VideoInputList() {\r\n  const classes = useStyles();\r\n  const { videoInputDevices } = useDevices();\r\n  const { localTracks } = useVideoContext();\r\n\r\n  const localVideoTrack = localTracks.find(track => track.kind === 'video') as LocalVideoTrack | undefined;\r\n  const mediaStreamTrack = useMediaStreamTrack(localVideoTrack);\r\n  const [storedLocalVideoDeviceId, setStoredLocalVideoDeviceId] = useState(\r\n    window.localStorage.getItem(SELECTED_VIDEO_INPUT_KEY)\r\n  );\r\n  const localVideoInputDeviceId = mediaStreamTrack?.getSettings().deviceId || storedLocalVideoDeviceId;\r\n\r\n  function replaceTrack(newDeviceId: string) {\r\n    // Here we store the device ID in the component state. This is so we can re-render this component display\r\n    // to display the name of the selected device when it is changed while the users camera is off.\r\n    setStoredLocalVideoDeviceId(newDeviceId);\r\n    window.localStorage.setItem(SELECTED_VIDEO_INPUT_KEY, newDeviceId);\r\n    localVideoTrack?.restart({\r\n      ...(DEFAULT_VIDEO_CONSTRAINTS as {}),\r\n      deviceId: { exact: newDeviceId },\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {localVideoTrack && (\r\n        <div className={classes.preview}>\r\n          <VideoTrack isLocal track={localVideoTrack} />\r\n        </div>\r\n      )}\r\n      {videoInputDevices.length > 1 ? (\r\n        <FormControl fullWidth>\r\n          <Typography variant=\"subtitle2\" gutterBottom>\r\n            Video Input\r\n          </Typography>\r\n          <Select\r\n            onChange={e => replaceTrack(e.target.value as string)}\r\n            value={localVideoInputDeviceId || ''}\r\n            variant=\"outlined\"\r\n          >\r\n            {videoInputDevices.map(device => (\r\n              <MenuItem value={device.deviceId} key={device.deviceId}>\r\n                {device.label}\r\n              </MenuItem>\r\n            ))}\r\n          </Select>\r\n        </FormControl>\r\n      ) : (\r\n        <>\r\n          <Typography variant=\"subtitle2\" gutterBottom>\r\n            Video Input\r\n          </Typography>\r\n          <Typography>{localVideoTrack?.mediaStreamTrack.label || 'No Local Video'}</Typography>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nimport AudioInputList from './AudioInputList/AudioInputList';\r\nimport AudioOutputList from './AudioOutputList/AudioOutputList';\r\nimport {\r\n  DialogContent,\r\n  Typography,\r\n  Divider,\r\n  Dialog,\r\n  DialogActions,\r\n  Button,\r\n  Theme,\r\n  DialogTitle,\r\n} from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport VideoInputList from './VideoInputList/VideoInputList';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  container: {\r\n    width: '600px',\r\n    minHeight: '400px',\r\n    [theme.breakpoints.down('xs')]: {\r\n      width: 'calc(100vw - 32px)',\r\n    },\r\n    '& .inputSelect': {\r\n      width: 'calc(100% - 35px)',\r\n    },\r\n  },\r\n  button: {\r\n    float: 'right',\r\n  },\r\n  paper: {\r\n    [theme.breakpoints.down('xs')]: {\r\n      margin: '16px',\r\n    },\r\n  },\r\n  headline: {\r\n    marginBottom: '1.3em',\r\n    fontSize: '1.1rem',\r\n  },\r\n  listSection: {\r\n    margin: '2em 0 0.8em',\r\n    '&:first-child': {\r\n      margin: '1em 0 2em 0',\r\n    },\r\n  },\r\n}));\r\n\r\nexport default function DeviceSelectionDialog({ open, onClose }: { open: boolean; onClose: () => void }) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Dialog open={open} onClose={onClose} classes={{ paper: classes.paper }}>\r\n      <DialogTitle>Audio and Video Settings</DialogTitle>\r\n      <Divider />\r\n      <DialogContent className={classes.container}>\r\n        <div className={classes.listSection}>\r\n          <Typography variant=\"h6\" className={classes.headline}>\r\n            Video\r\n          </Typography>\r\n          <VideoInputList />\r\n        </div>\r\n        <Divider />\r\n        <div className={classes.listSection}>\r\n          <Typography variant=\"h6\" className={classes.headline}>\r\n            Audio\r\n          </Typography>\r\n          <AudioInputList />\r\n        </div>\r\n        <div className={classes.listSection}>\r\n          <AudioOutputList />\r\n        </div>\r\n      </DialogContent>\r\n      <Divider />\r\n      <DialogActions>\r\n        <Button color=\"primary\" variant=\"contained\" className={classes.button} onClick={onClose}>\r\n          Done\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n","import React, { useState, useRef } from 'react';\r\nimport AboutDialog from '../../AboutDialog/AboutDialog';\r\nimport Button from '@material-ui/core/Button';\r\nimport DeviceSelectionDialog from '../../DeviceSelectionDialog/DeviceSelectionDialog';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport MenuContainer from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { Theme, useMediaQuery } from '@material-ui/core';\r\n\r\nexport default function Menu(props: { buttonClassName?: string }) {\r\n  const isMobile = useMediaQuery((theme: Theme) => theme.breakpoints.down('sm'));\r\n  const [aboutOpen, setAboutOpen] = useState(false);\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n  const [settingsOpen, setSettingsOpen] = useState(false);\r\n\r\n  const anchorRef = useRef<HTMLButtonElement>(null);\r\n\r\n  return (\r\n    <>\r\n      <Button onClick={() => setMenuOpen(isOpen => !isOpen)} ref={anchorRef} className={props.buttonClassName}>\r\n        {isMobile ? (\r\n          <MoreIcon />\r\n        ) : (\r\n          <>\r\n            Settings\r\n            <ExpandMoreIcon />\r\n          </>\r\n        )}\r\n      </Button>\r\n      <MenuContainer\r\n        open={menuOpen}\r\n        onClose={() => setMenuOpen(isOpen => !isOpen)}\r\n        anchorEl={anchorRef.current}\r\n        anchorOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'left',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: isMobile ? -55 : 'bottom',\r\n          horizontal: 'center',\r\n        }}\r\n      >\r\n        <MenuItem onClick={() => setAboutOpen(true)}>\r\n          <Typography variant=\"body1\">About</Typography>\r\n        </MenuItem>\r\n        <MenuItem onClick={() => setSettingsOpen(true)}>\r\n          <Typography variant=\"body1\">Audio and Video Settings</Typography>\r\n        </MenuItem>\r\n      </MenuContainer>\r\n      <AboutDialog\r\n        open={aboutOpen}\r\n        onClose={() => {\r\n          setAboutOpen(false);\r\n          setMenuOpen(false);\r\n        }}\r\n      />\r\n      <DeviceSelectionDialog\r\n        open={settingsOpen}\r\n        onClose={() => {\r\n          setSettingsOpen(false);\r\n          setMenuOpen(false);\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\ntype RoomStateType = 'disconnected' | 'connected' | 'reconnecting';\r\n\r\nexport default function useRoomState() {\r\n  const { room } = useVideoContext();\r\n  const [state, setState] = useState<RoomStateType>('disconnected');\r\n\r\n  useEffect(() => {\r\n    if (room) {\r\n      const setRoomState = () => setState(room.state as RoomStateType);\r\n      setRoomState();\r\n      room\r\n        .on('disconnected', setRoomState)\r\n        .on('reconnected', setRoomState)\r\n        .on('reconnecting', setRoomState);\r\n      return () => {\r\n        room\r\n          .off('disconnected', setRoomState)\r\n          .off('reconnected', setRoomState)\r\n          .off('reconnecting', setRoomState);\r\n      };\r\n    }\r\n  }, [room]);\r\n\r\n  return state;\r\n}\r\n","import React from 'react';\r\n\r\nexport default function MicIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"17\" viewBox=\"0 0 12 17\">\r\n      <path\r\n        fill=\"#707578\"\r\n        fillRule=\"evenodd\"\r\n        d=\"M11.389 6.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V13.09C2.395 12.836 0 10.281 0 7.167c0-.276.224-.5.5-.5s.5.224.5.5c0 2.73 2.214 4.944 4.944 4.944 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM5.944 0C7.51 0 8.778 1.268 8.778 2.833v4.334C8.778 8.73 7.51 10 5.944 10 4.38 10 3.111 8.73 3.111 7.167V2.833C3.111 1.268 4.38 0 5.944 0zm0 1c-1.012 0-1.833.82-1.833 1.833v4.334C4.111 8.179 4.933 9 5.944 9c1.013 0 1.834-.82 1.834-1.833V2.833C7.778 1.82 6.958 1 5.944 1z\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function MicOffIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"25\" height=\"24\" viewBox=\"0 0 25 24\">\r\n      <g fill=\"none\" fillRule=\"evenodd\">\r\n        <path\r\n          fill=\"#707578\"\r\n          d=\"M11.889 6.667c.276 0 .5.224.5.5 0 3.114-2.396 5.67-5.445 5.923v2.632c0 .276-.223.5-.5.5-.245 0-.45-.177-.491-.41l-.009-.09V13.09c-1.116-.093-2.145-.494-3-1.119l.717-.717c.793.54 1.751.857 2.783.857 2.731 0 4.945-2.214 4.945-4.944 0-.276.224-.5.5-.5zM1 6.667c.276 0 .5.224.5.5 0 .975.282 1.884.77 2.65l-.722.721C.888 9.58.5 8.418.5 7.167c0-.276.224-.5.5-.5zm8.277-1.031v1.53C9.278 8.732 8.01 10 6.445 10c-.446 0-.868-.103-1.243-.287l.776-.773c.149.039.306.06.467.06.963 0 1.751-.74 1.828-1.683l.006-.15v-.531l1-1zM6.444 0C8.01 0 9.278 1.268 9.278 2.833l-.002-.025-.999.999v-.974c0-.962-.74-1.75-1.682-1.827L6.445 1c-.962 0-1.751.74-1.828 1.683l-.006.15v4.334c0 .097.008.192.022.285l-.804.805c-.112-.269-.184-.558-.209-.86l-.009-.23V2.833C3.611 1.268 4.88 0 6.444 0z\"\r\n          transform=\"translate(6.5 4)\"\r\n        />\r\n        <path\r\n          fill=\"red\"\r\n          d=\"M12.146.646c.196-.195.512-.195.708 0 .173.174.192.443.057.638l-.057.07-12 12c-.196.195-.512.195-.708 0-.173-.174-.192-.443-.057-.638l.057-.07 12-12z\"\r\n          transform=\"translate(6.5 4)\"\r\n        />\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport MicIcon from '../../../icons/MicIcon';\r\nimport MicOffIcon from '../../../icons/MicOffIcon';\r\n\r\nimport useLocalAudioToggle from '../../../hooks/useLocalAudioToggle/useLocalAudioToggle';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function ToggleAudioButton(props: { disabled?: boolean; className?: string }) {\r\n  const [isAudioEnabled, toggleAudioEnabled] = useLocalAudioToggle();\r\n  const { localTracks } = useVideoContext();\r\n  const hasAudioTrack = localTracks.some(track => track.kind === 'audio');\r\n\r\n  return (\r\n    <Button\r\n      className={props.className}\r\n      onClick={toggleAudioEnabled}\r\n      disabled={!hasAudioTrack || props.disabled}\r\n      startIcon={isAudioEnabled ? <MicIcon /> : <MicOffIcon />}\r\n      data-cy-audio-toggle\r\n    >\r\n      {!hasAudioTrack ? 'No Audio' : isAudioEnabled ? 'Mute' : 'Unmute'}\r\n    </Button>\r\n  );\r\n}\r\n","import { LocalAudioTrack } from 'twilio-video';\r\nimport { useCallback } from 'react';\r\nimport useIsTrackEnabled from '../useIsTrackEnabled/useIsTrackEnabled';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useLocalAudioToggle() {\r\n  const { localTracks } = useVideoContext();\r\n  const audioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\r\n  const isEnabled = useIsTrackEnabled(audioTrack);\r\n\r\n  const toggleAudioEnabled = useCallback(() => {\r\n    if (audioTrack) {\r\n      audioTrack.isEnabled ? audioTrack.disable() : audioTrack.enable();\r\n    }\r\n  }, [audioTrack]);\r\n\r\n  return [isEnabled, toggleAudioEnabled] as const;\r\n}\r\n","import React from 'react';\r\n\r\nexport default function VideoOffIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n      <g fill=\"none\" fillRule=\"evenodd\">\r\n        <path\r\n          fill=\"#707578\"\r\n          d=\"M10.503.85c.32 0 .611.125.827.329l-.696.697c-.025-.018-.053-.032-.084-.038l-.047-.006H1.207c-.102 0-.19.071-.216.165l-.008.059v7.866c0 .101.07.189.165.215l.059.008h1.156l-.983.983h-.173c-.624 0-1.139-.476-1.2-1.083L0 9.922V2.056C0 1.433.476.917 1.084.856l.123-.007h9.296zm5.49 1.124l.007.082v7.866c0 .337-.328.566-.635.47l-.076-.03-3.58-1.79v1.35c0 .623-.476 1.138-1.083 1.2l-.123.006H4.16l.984-.983h5.359c.101 0 .189-.07.215-.164l.008-.06V4.564l.983-.982.353-.353 3.227-1.612c.301-.15.652.04.704.358zm-.977.876L11.71 4.504v2.967l3.307 1.654V2.85z\"\r\n          transform=\"translate(4 6)\"\r\n        />\r\n        <path\r\n          fill=\"red\"\r\n          fillRule=\"nonzero\"\r\n          d=\"M13.06.144c.192-.192.503-.192.695 0 .171.17.19.436.057.627l-.057.068-12.29 12.29c-.192.193-.503.193-.695 0-.171-.17-.19-.435-.057-.626l.057-.069L13.06.144z\"\r\n          transform=\"translate(4 6)\"\r\n        />\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function VideoOnIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"25\" height=\"24\" viewBox=\"0 0 25 24\">\r\n      <path\r\n        fill=\"#707578\"\r\n        fillRule=\"evenodd\"\r\n        d=\"M15.003 7c.665 0 1.206.542 1.206 1.207v1.349l3.58-1.789c.301-.15.652.04.704.358l.007.082v7.866c0 .365-.385.603-.711.44l-3.58-1.79v1.35c0 .623-.476 1.138-1.083 1.2l-.123.006H5.707c-.665 0-1.207-.542-1.207-1.206V8.207C4.5 7.542 5.042 7 5.707 7zm0 .983H5.707c-.122 0-.224.102-.224.224v7.866c0 .121.102.223.224.223h9.296c.122 0 .223-.102.223-.223V8.207c0-.122-.101-.224-.223-.224zm4.513 1.019l-3.307 1.654v2.968l3.307 1.653V9.002z\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n","import React, { useCallback, useRef } from 'react';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport VideoOffIcon from '../../../icons/VideoOffIcon';\r\nimport VideoOnIcon from '../../../icons/VideoOnIcon';\r\n\r\nimport useDevices from '../../../hooks/useDevices/useDevices';\r\nimport useLocalVideoToggle from '../../../hooks/useLocalVideoToggle/useLocalVideoToggle';\r\n\r\nexport default function ToggleVideoButton(props: { disabled?: boolean; className?: string }) {\r\n  const [isVideoEnabled, toggleVideoEnabled] = useLocalVideoToggle();\r\n  const lastClickTimeRef = useRef(0);\r\n  const { hasVideoInputDevices } = useDevices();\r\n\r\n  const toggleVideo = useCallback(() => {\r\n    if (Date.now() - lastClickTimeRef.current > 500) {\r\n      lastClickTimeRef.current = Date.now();\r\n      toggleVideoEnabled();\r\n    }\r\n  }, [toggleVideoEnabled]);\r\n\r\n  return (\r\n    <Button\r\n      className={props.className}\r\n      onClick={toggleVideo}\r\n      disabled={!hasVideoInputDevices || props.disabled}\r\n      startIcon={isVideoEnabled ? <VideoOnIcon /> : <VideoOffIcon />}\r\n    >\r\n      {!hasVideoInputDevices ? 'No Video' : isVideoEnabled ? 'Stop Video' : 'Start Video'}\r\n    </Button>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function ScreenShareIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n      <path\r\n        fill=\"#707578\"\r\n        fillRule=\"evenodd\"\r\n        d=\"M17.657 6.343c3.124 3.124 3.124 8.19 0 11.314-3.124 3.124-8.19 3.124-11.314 0-3.124-3.124-3.124-8.19 0-11.314 3.124-3.124 8.19-3.124 11.314 0zm-10.444.87c-2.643 2.644-2.643 6.93 0 9.574 2.644 2.643 6.93 2.643 9.574 0 2.57-2.57 2.641-6.693.214-9.35l-.214-.224L16.563 7c-2.657-2.427-6.78-2.356-9.35.214zm4.865.484l.02.003.026.005.041.01c.025.007.045.014.063.021l.043.019c.018.009.036.019.053.03.01.005.02.012.03.02.027.019.053.04.077.063l2.773 2.774c.24.24.24.63 0 .87-.213.214-.545.237-.785.071l-.085-.07-1.719-1.72v5.9c0 .34-.275.615-.615.615-.302 0-.553-.218-.605-.505l-.01-.11-.001-5.9-1.718 1.72c-.24.24-.63.24-.87 0-.214-.215-.238-.546-.072-.786l.072-.085 2.769-2.77.015-.014c.02-.018.04-.035.062-.05l.005-.004.008-.006c.027-.018.055-.034.085-.048l.034-.015.059-.02.032-.008c.021-.005.044-.008.068-.011l.038-.003H12.025l.027.002.026.002z\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nimport { Participant, TrackPublication } from 'twilio-video';\r\n\r\n/*\r\n  Returns the participant that is sharing their screen (if any). This hook assumes that only one participant\r\n  can share their screen at a time.\r\n*/\r\nexport default function useScreenShareParticipant() {\r\n  const { room } = useVideoContext();\r\n  const [screenShareParticipant, setScreenShareParticipant] = useState<Participant>();\r\n\r\n  useEffect(() => {\r\n    if (room) {\r\n      const updateScreenShareParticipant = () => {\r\n        setScreenShareParticipant(\r\n          Array.from<Participant>(room.participants.values())\r\n            // the screenshare participant could be the localParticipant\r\n            .concat(room.localParticipant)\r\n            .find((participant: Participant) =>\r\n              Array.from<TrackPublication>(participant.tracks.values()).find(track =>\r\n                track.trackName.includes('screen')\r\n              )\r\n            )\r\n        );\r\n      };\r\n      updateScreenShareParticipant();\r\n\r\n      room.on('trackPublished', updateScreenShareParticipant);\r\n      room.on('trackUnpublished', updateScreenShareParticipant);\r\n      room.on('participantDisconnected', updateScreenShareParticipant);\r\n\r\n      // the room object does not emit 'trackPublished' events for the localParticipant,\r\n      // so we need to listen for them here.\r\n      room.localParticipant.on('trackPublished', updateScreenShareParticipant);\r\n      room.localParticipant.on('trackUnpublished', updateScreenShareParticipant);\r\n      return () => {\r\n        room.off('trackPublished', updateScreenShareParticipant);\r\n        room.off('trackUnpublished', updateScreenShareParticipant);\r\n        room.off('participantDisconnected', updateScreenShareParticipant);\r\n\r\n        room.localParticipant.off('trackPublished', updateScreenShareParticipant);\r\n        room.localParticipant.off('trackUnpublished', updateScreenShareParticipant);\r\n      };\r\n    }\r\n  }, [room]);\r\n\r\n  return screenShareParticipant;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport ScreenShareIcon from '../../../icons/ScreenShareIcon';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport useScreenShareParticipant from '../../../hooks/useScreenShareParticipant/useScreenShareParticipant';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport const SCREEN_SHARE_TEXT = 'Share Screen';\r\nexport const STOP_SCREEN_SHARE_TEXT = 'Stop Sharing Screen';\r\nexport const SHARE_IN_PROGRESS_TEXT = 'Cannot share screen when another user is sharing';\r\nexport const SHARE_NOT_SUPPORTED_TEXT = 'Screen sharing is not supported with this browser';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    button: {\r\n      margin: theme.spacing(1),\r\n      '&[disabled]': {\r\n        color: '#bbb',\r\n        '& svg *': {\r\n          fill: '#bbb',\r\n        },\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ToggleScreenShareButton(props: { disabled?: boolean }) {\r\n  const classes = useStyles();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const { toggleScreenShare } = useVideoContext();\r\n  const disableScreenShareButton = Boolean(screenShareParticipant);\r\n  const isScreenShareSupported = navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia;\r\n  const isDisabled = props.disabled || disableScreenShareButton || !isScreenShareSupported;\r\n\r\n  let tooltipMessage = '';\r\n\r\n  if (disableScreenShareButton) {\r\n    tooltipMessage = SHARE_IN_PROGRESS_TEXT;\r\n  }\r\n\r\n  if (!isScreenShareSupported) {\r\n    tooltipMessage = SHARE_NOT_SUPPORTED_TEXT;\r\n  }\r\n\r\n  return (\r\n    <Tooltip\r\n      title={tooltipMessage}\r\n      placement=\"top\"\r\n      PopperProps={{ disablePortal: true }}\r\n      style={{ cursor: isDisabled ? 'not-allowed' : 'pointer' }}\r\n    >\r\n      <span>\r\n        {/* The span element is needed because a disabled button will not emit hover events and we want to display\r\n          a tooltip when screen sharing is disabled */}\r\n        <Button\r\n          className={classes.button}\r\n          onClick={toggleScreenShare}\r\n          disabled={isDisabled}\r\n          startIcon={<ScreenShareIcon />}\r\n          data-cy-share-screen\r\n        >\r\n          {SCREEN_SHARE_TEXT}\r\n        </Button>\r\n      </span>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport EndCallButton from '../Buttons/EndCallButton/EndCallButton';\r\nimport FlipCameraButton from './FlipCameraButton/FlipCameraButton';\r\nimport Menu from './Menu/Menu';\r\n\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport { Typography, Grid, Hidden } from '@material-ui/core';\r\nimport ToggleAudioButton from '../Buttons/ToggleAudioButton/ToggleAudioButton';\r\nimport ToggleVideoButton from '../Buttons/ToggleVideoButton/ToggleVideoButton';\r\nimport ToggleScreenShareButton from '../Buttons/ToogleScreenShareButton/ToggleScreenShareButton';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      backgroundColor: theme.palette.background.default,\r\n      bottom: 0,\r\n      left: 0,\r\n      right: 0,\r\n      height: `${theme.footerHeight}px`,\r\n      position: 'fixed',\r\n      display: 'flex',\r\n      padding: '0 1.43em',\r\n      zIndex: 10,\r\n      [theme.breakpoints.down('sm')]: {\r\n        height: `${theme.mobileFooterHeight}px`,\r\n        padding: 0,\r\n      },\r\n    },\r\n    screenShareBanner: {\r\n      position: 'fixed',\r\n      zIndex: 10,\r\n      bottom: `${theme.footerHeight}px`,\r\n      left: 0,\r\n      right: 0,\r\n      height: '104px',\r\n      background: 'rgba(0, 0, 0, 0.5)',\r\n      '& h6': {\r\n        color: 'white',\r\n      },\r\n      '& button': {\r\n        background: 'white',\r\n        color: theme.brand,\r\n        border: `2px solid ${theme.brand}`,\r\n        margin: '0 2em',\r\n        '&:hover': {\r\n          color: '#600101',\r\n          border: `2px solid #600101`,\r\n          background: '#FFE9E7',\r\n        },\r\n      },\r\n    },\r\n    hideMobile: {\r\n      display: 'initial',\r\n      [theme.breakpoints.down('sm')]: {\r\n        display: 'none',\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function MenuBar() {\r\n  const classes = useStyles();\r\n  const { isSharingScreen, toggleScreenShare } = useVideoContext();\r\n  const roomState = useRoomState();\r\n  const isReconnecting = roomState === 'reconnecting';\r\n  const { room } = useVideoContext();\r\n\r\n  return (\r\n    <>\r\n      {isSharingScreen && (\r\n        <Grid container justify=\"center\" alignItems=\"center\" className={classes.screenShareBanner}>\r\n          <Typography variant=\"h6\">You are sharing your screen</Typography>\r\n          <Button onClick={() => toggleScreenShare()}>Stop Sharing</Button>\r\n        </Grid>\r\n      )}\r\n      <footer className={classes.container}>\r\n        <Grid container justify=\"space-around\" alignItems=\"center\">\r\n          <Hidden smDown>\r\n            <Grid style={{ flex: 1 }}>\r\n              <Typography variant=\"body1\">{room!.name}</Typography>\r\n            </Grid>\r\n          </Hidden>\r\n          <Grid item>\r\n            <Grid container justify=\"center\">\r\n              <ToggleAudioButton disabled={isReconnecting} />\r\n              <ToggleVideoButton disabled={isReconnecting} />\r\n              <Hidden smDown>{!isSharingScreen && <ToggleScreenShareButton disabled={isReconnecting} />}</Hidden>\r\n              <FlipCameraButton />\r\n            </Grid>\r\n          </Grid>\r\n          <Hidden smDown>\r\n            <Grid style={{ flex: 1 }}>\r\n              <Grid container justify=\"flex-end\">\r\n                <Menu />\r\n                <EndCallButton />\r\n              </Grid>\r\n            </Grid>\r\n          </Hidden>\r\n        </Grid>\r\n      </footer>\r\n    </>\r\n  );\r\n}\r\n","import { Grid, makeStyles, Theme, Typography } from '@material-ui/core';\r\nimport React from 'react';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport EndCallButton from '../Buttons/EndCallButton/EndCallButton';\r\nimport Menu from '../MenuBar/Menu/Menu';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  container: {\r\n    background: 'white',\r\n    paddingLeft: '1em',\r\n    display: 'none',\r\n    height: `${theme.mobileTopBarHeight}px`,\r\n    [theme.breakpoints.down('sm')]: {\r\n      display: 'flex',\r\n    },\r\n  },\r\n  endCallButton: {\r\n    height: '28px',\r\n    fontSize: '0.85rem',\r\n    padding: '0 0.6em',\r\n  },\r\n  settingsButton: {\r\n    [theme.breakpoints.down('sm')]: {\r\n      height: '28px',\r\n      minWidth: '28px',\r\n      border: '1px solid rgb(136, 140, 142)',\r\n      padding: 0,\r\n      margin: '0 1em',\r\n    },\r\n  },\r\n}));\r\n\r\nexport default function MobileTopMenuBar() {\r\n  const classes = useStyles();\r\n  const { room } = useVideoContext();\r\n\r\n  return (\r\n    <Grid container alignItems=\"center\" justify=\"space-between\" className={classes.container}>\r\n      <Typography variant=\"subtitle1\">{room!.name}</Typography>\r\n      <div>\r\n        <EndCallButton className={classes.endCallButton} />\r\n        <Menu buttonClassName={classes.settingsButton} />\r\n      </div>\r\n    </Grid>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function AvatarIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"73\" height=\"73\" viewBox=\"0 0 73 73\">\r\n      <g fill=\"none\" fillRule=\"evenodd\">\r\n        <circle cx=\"36.5\" cy=\"36.5\" r=\"36.5\" fill=\"#FFF\" />\r\n        <path\r\n          fill=\"#282A2B\"\r\n          strokeLinejoin=\"round\"\r\n          d=\"M30.973 23.925c-3.162 3.794-3.162 9.886 0 13.68l.262.301c.266.293.548.564.842.812l.192.154v2.95l-6.71 2.397-.213.082c-2.03.834-3.346 2.793-3.346 4.97v2.766c0 .532.431.963.963.963h27.874c.531 0 .962-.431.962-.963V49.27l-.005-.228-.015-.233c-.187-2.092-1.562-3.883-3.539-4.59l-6.71-2.397v-2.95l.192-.154c.393-.33.762-.702 1.104-1.112 3.162-3.795 3.162-9.887 0-13.681-3.25-3.9-8.603-3.9-11.853 0zm10.374 1.232c2.567 3.08 2.567 8.135 0 11.216-.404.484-.85.894-1.328 1.226-.26.18-.414.476-.414.791v4.111c0 .407.255.77.639.907l7.348 2.625c1.314.47 2.213 1.687 2.278 3.077l.004.183v1.781h-25.95l.002-1.804c0-1.394.843-2.65 2.131-3.18l.172-.065 7.327-2.617c.383-.137.639-.5.639-.907v-4.11c0-.316-.155-.612-.415-.792-.478-.332-.924-.742-1.328-1.226-2.567-3.08-2.567-8.135 0-11.216 2.427-2.912 6.248-2.974 8.735-.186l.16.186z\"\r\n        />\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { LocalAudioTrack } from 'twilio-video';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport AudioLevelIndicator from '../AudioLevelIndicator/AudioLevelIndicator';\r\n\r\nexport default function LocalAudioLevelIndicator() {\r\n  const { localTracks } = useVideoContext();\r\n  const audioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\r\n\r\n  return <AudioLevelIndicator audioTrack={audioTrack} />;\r\n}\r\n","import React from 'react';\r\nimport AvatarIcon from '../../../../icons/AvatarIcon';\r\nimport { makeStyles, Theme, Typography } from '@material-ui/core';\r\nimport LocalAudioLevelIndicator from '../../../LocalAudioLevelIndicator/LocalAudioLevelIndicator';\r\nimport { LocalVideoTrack } from 'twilio-video';\r\nimport VideoTrack from '../../../VideoTrack/VideoTrack';\r\nimport useVideoContext from '../../../../hooks/useVideoContext/useVideoContext';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  container: {\r\n    position: 'relative',\r\n    height: 0,\r\n    overflow: 'hidden',\r\n    paddingTop: `${(9 / 16) * 100}%`,\r\n    background: 'black',\r\n  },\r\n  innerContainer: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n  identityContainer: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    zIndex: 1,\r\n  },\r\n  identity: {\r\n    background: 'rgba(0, 0, 0, 0.5)',\r\n    color: 'white',\r\n    padding: '0.18em 0.3em',\r\n    margin: 0,\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n  avatarContainer: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    background: 'black',\r\n    position: 'absolute',\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    zIndex: 1,\r\n    [theme.breakpoints.down('sm')]: {\r\n      '& svg': {\r\n        transform: 'scale(0.7)',\r\n      },\r\n    },\r\n  },\r\n}));\r\n\r\nexport default function LocalVideoPreview({ identity }: { identity: string }) {\r\n  const classes = useStyles();\r\n  const { localTracks } = useVideoContext();\r\n\r\n  const videoTrack = localTracks.find(track => track.name.includes('camera')) as LocalVideoTrack;\r\n\r\n  return (\r\n    <div className={classes.container}>\r\n      <div className={classes.innerContainer}>\r\n        {videoTrack ? (\r\n          <VideoTrack track={videoTrack} isLocal />\r\n        ) : (\r\n          <div className={classes.avatarContainer}>\r\n            <AvatarIcon />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className={classes.identityContainer}>\r\n        <span className={classes.identity}>\r\n          <LocalAudioLevelIndicator />\r\n          <Typography variant=\"body1\" color=\"inherit\" component=\"span\">\r\n            {identity}\r\n          </Typography>\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { VideoTrack } from 'twilio-video';\r\n\r\nexport type RenderDimensionValue =\r\n  | 'low'\r\n  | 'cif'\r\n  | 'vga'\r\n  | 'wvga'\r\n  | '540p'\r\n  | '720p'\r\n  | '960p'\r\n  | 'standard1080p'\r\n  | 'wide1080p'\r\n  | 'default';\r\n\r\nexport interface RenderDimension {\r\n  label: string;\r\n  value: RenderDimensionValue;\r\n  resolution?: VideoTrack.Dimensions;\r\n}\r\n\r\nexport const RenderDimensions: RenderDimension[] = [\r\n  {\r\n    label: 'Low (160 x 90)',\r\n    value: 'low',\r\n    resolution: { width: 160, height: 90 },\r\n  },\r\n  {\r\n    label: 'CIF (352 x 288)',\r\n    value: 'cif',\r\n    resolution: { width: 352, height: 288 },\r\n  },\r\n  {\r\n    label: 'VGA (640 x 480)',\r\n    value: 'vga',\r\n    resolution: { width: 640, height: 480 },\r\n  },\r\n  {\r\n    label: 'WVGA (800 x 480)',\r\n    value: 'wvga',\r\n    resolution: { width: 800, height: 480 },\r\n  },\r\n  {\r\n    label: 'HD 540P (960 x 540)',\r\n    value: '540p',\r\n    resolution: { width: 960, height: 540 },\r\n  },\r\n  {\r\n    label: 'HD 720P (1280 x 720)',\r\n    value: '720p',\r\n    resolution: { width: 1280, height: 720 },\r\n  },\r\n  {\r\n    label: 'HD 960P (1280 x 960)',\r\n    value: '960p',\r\n    resolution: { width: 1280, height: 960 },\r\n  },\r\n  {\r\n    label: 'HD Standard 1080P (1440 x 1080)',\r\n    value: 'standard1080p',\r\n    resolution: { width: 1440, height: 1080 },\r\n  },\r\n  {\r\n    label: 'HD Widescreen 1080P (1920 x 1080)',\r\n    value: 'wide1080p',\r\n    resolution: { width: 1920, height: 1080 },\r\n  },\r\n  {\r\n    label: 'Server Default',\r\n    value: 'default',\r\n    resolution: undefined,\r\n  },\r\n];\r\n\r\nexport function getResolution(value?: RenderDimensionValue) {\r\n  if (typeof value === 'undefined') {\r\n    return undefined;\r\n  }\r\n\r\n  return RenderDimensions.find(item => item.value === value)?.resolution;\r\n}\r\n","import React, { useCallback } from 'react';\r\nimport {\r\n  Button,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogTitle,\r\n  Divider,\r\n  FormControl,\r\n  Grid,\r\n  InputLabel,\r\n  MenuItem,\r\n  Select,\r\n  TextField,\r\n  Theme,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { inputLabels, Settings } from '../../state/settings/settingsReducer';\r\nimport { RenderDimensions } from '../../state/settings/renderDimensions';\r\nimport { useAppState } from '../../state';\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  container: {\r\n    width: '600px',\r\n    minHeight: '400px',\r\n    [theme.breakpoints.down('xs')]: {\r\n      width: 'calc(100vw - 32px)',\r\n    },\r\n    '& .inputSelect': {\r\n      width: 'calc(100% - 35px)',\r\n    },\r\n  },\r\n  button: {\r\n    float: 'right',\r\n  },\r\n  paper: {\r\n    [theme.breakpoints.down('xs')]: {\r\n      margin: '16px',\r\n    },\r\n  },\r\n  formControl: {\r\n    display: 'block',\r\n    margin: '1.5em 0',\r\n    '&:first-child': {\r\n      margin: '0 0 1.5em 0',\r\n    },\r\n  },\r\n  label: {\r\n    width: '133%', // Labels have scale(0.75) applied to them, so this effectively makes the width 100%\r\n  },\r\n}));\r\n\r\nconst withDefault = (val?: string) => (typeof val === 'undefined' ? 'default' : val);\r\n\r\nconst RenderDimensionItems = RenderDimensions.map(({ label, value }) => (\r\n  <MenuItem value={value} key={value}>\r\n    {label}\r\n  </MenuItem>\r\n));\r\n\r\nexport default function ConnectionOptionsDialog({ open, onClose }: { open: boolean; onClose: () => void }) {\r\n  const classes = useStyles();\r\n  const { settings, dispatchSetting } = useAppState();\r\n  const roomState = useRoomState();\r\n  const isDisabled = roomState !== 'disconnected';\r\n\r\n  const handleChange = useCallback(\r\n    (e: React.ChangeEvent<{ value: unknown; name?: string }>) => {\r\n      dispatchSetting({ name: e.target.name as keyof Settings, value: e.target.value as string });\r\n    },\r\n    [dispatchSetting]\r\n  );\r\n\r\n  const handleNumberChange = useCallback(\r\n    (e: React.ChangeEvent<{ value: unknown; name?: string }>) => {\r\n      if (!/[^\\d]/.test(e.target.value as string)) handleChange(e);\r\n    },\r\n    [handleChange]\r\n  );\r\n\r\n  return (\r\n    <Dialog open={open} onClose={onClose} classes={{ paper: classes.paper }}>\r\n      <DialogTitle>Connection Settings</DialogTitle>\r\n      <Divider />\r\n      <DialogContent className={classes.container}>\r\n        <Grid container spacing={2}>\r\n          <Grid item xs={12}>\r\n            <Typography hidden={!isDisabled} variant=\"body2\">\r\n              These settings cannot be changed when connected to a room.\r\n            </Typography>\r\n          </Grid>\r\n\r\n          <Grid item sm={6} xs={12}>\r\n            <FormControl className={classes.formControl}>\r\n              <InputLabel id={inputLabels.dominantSpeakerPriority}>Dominant Speaker Priority:</InputLabel>\r\n              <Select\r\n                fullWidth\r\n                disabled={isDisabled}\r\n                name={inputLabels.dominantSpeakerPriority}\r\n                label={inputLabels.dominantSpeakerPriority}\r\n                value={withDefault(settings.dominantSpeakerPriority)}\r\n                onChange={handleChange}\r\n              >\r\n                <MenuItem value=\"low\">Low</MenuItem>\r\n                <MenuItem value=\"standard\">Standard</MenuItem>\r\n                <MenuItem value=\"high\">High</MenuItem>\r\n                <MenuItem value=\"default\">Server Default</MenuItem>\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <FormControl className={classes.formControl}>\r\n              <InputLabel id={inputLabels.trackSwitchOffMode}>Track Switch Off Mode:</InputLabel>\r\n              <Select\r\n                fullWidth\r\n                disabled={isDisabled}\r\n                name={inputLabels.trackSwitchOffMode}\r\n                label={inputLabels.trackSwitchOffMode}\r\n                value={withDefault(settings.trackSwitchOffMode)}\r\n                onChange={handleChange}\r\n              >\r\n                <MenuItem value=\"predicted\">Predicted</MenuItem>\r\n                <MenuItem value=\"detected\">Detected</MenuItem>\r\n                <MenuItem value=\"disabled\">Disabled</MenuItem>\r\n                <MenuItem value=\"default\">Server Default</MenuItem>\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <FormControl className={classes.formControl}>\r\n              <InputLabel id={inputLabels.bandwidthProfileMode}>Mode:</InputLabel>\r\n              <Select\r\n                fullWidth\r\n                disabled={isDisabled}\r\n                name={inputLabels.bandwidthProfileMode}\r\n                label={inputLabels.bandwidthProfileMode}\r\n                value={withDefault(settings.bandwidthProfileMode)}\r\n                onChange={handleChange}\r\n              >\r\n                <MenuItem value=\"grid\">Grid</MenuItem>\r\n                <MenuItem value=\"collaboration\">Collaboration</MenuItem>\r\n                <MenuItem value=\"presentation\">Presentation</MenuItem>\r\n                <MenuItem value=\"default\">Server Default</MenuItem>\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <FormControl className={classes.formControl}>\r\n              <TextField\r\n                disabled={isDisabled}\r\n                fullWidth\r\n                id={inputLabels.maxTracks}\r\n                label=\"Max Tracks\"\r\n                placeholder=\"Leave blank for no limit\"\r\n                name={inputLabels.maxTracks}\r\n                value={withDefault(settings.maxTracks)}\r\n                onChange={handleNumberChange}\r\n              />\r\n            </FormControl>\r\n\r\n            <FormControl className={classes.formControl}>\r\n              <TextField\r\n                disabled={isDisabled}\r\n                fullWidth\r\n                id={inputLabels.maxAudioBitrate}\r\n                label=\"Max Audio Bitrate\"\r\n                placeholder=\"Leave blank for no limit\"\r\n                name={inputLabels.maxAudioBitrate}\r\n                value={withDefault(settings.maxAudioBitrate)}\r\n                onChange={handleNumberChange}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item sm={6} xs={12}>\r\n            <FormControl fullWidth className={classes.formControl}>\r\n              <InputLabel id={inputLabels.renderDimensionLow} className={classes.label}>\r\n                Render Dimension (Low Priority):\r\n              </InputLabel>\r\n              <Select\r\n                fullWidth\r\n                disabled={isDisabled}\r\n                name={inputLabels.renderDimensionLow}\r\n                label={inputLabels.renderDimensionLow}\r\n                value={withDefault(settings.renderDimensionLow)}\r\n                onChange={handleChange}\r\n              >\r\n                {RenderDimensionItems}\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <FormControl fullWidth className={classes.formControl}>\r\n              <InputLabel id={inputLabels.renderDimensionStandard} className={classes.label}>\r\n                Render Dimension (Standard Priority):\r\n              </InputLabel>\r\n              <Select\r\n                fullWidth\r\n                disabled={isDisabled}\r\n                name={inputLabels.renderDimensionStandard}\r\n                label={inputLabels.renderDimensionStandard}\r\n                value={withDefault(settings.renderDimensionStandard)}\r\n                onChange={handleChange}\r\n              >\r\n                {RenderDimensionItems}\r\n              </Select>\r\n            </FormControl>\r\n\r\n            <FormControl fullWidth className={classes.formControl}>\r\n              <InputLabel id={inputLabels.renderDimensionHigh} className={classes.label}>\r\n                Render Dimension (High Priority):\r\n              </InputLabel>\r\n              <Select\r\n                fullWidth\r\n                disabled={isDisabled}\r\n                name={inputLabels.renderDimensionHigh}\r\n                label={inputLabels.renderDimensionHigh}\r\n                value={withDefault(settings.renderDimensionHigh)}\r\n                onChange={handleChange}\r\n              >\r\n                {RenderDimensionItems}\r\n              </Select>\r\n            </FormControl>\r\n          </Grid>\r\n        </Grid>\r\n      </DialogContent>\r\n      <Divider />\r\n      <DialogActions>\r\n        <Button className={classes.button} color=\"primary\" variant=\"contained\" onClick={onClose}>\r\n          Done\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function SettingsIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n      <g fill=\"none\" fillRule=\"evenodd\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n        <g fill=\"#707578\">\r\n          <path\r\n            d=\"M10 .833c.276 0 .5.224.5.5l-.001 1.775.16.042c.423.113.775.226 1.072.35l.121.054 1.273-1.272c.173-.173.442-.192.637-.057l.07.057 1.886 1.886c.195.196.195.512 0 .708l-1.273 1.27.055.123c.125.297.238.65.351 1.073l.041.158h1.775c.245 0 .45.177.492.41l.008.09v2c0 .276-.224.5-.5.5H14.89l-.03.118c-.115.431-.231.798-.358 1.103l-.058.131 1.273 1.273c.173.174.192.443.057.638l-.057.07-1.886 1.885c-.195.195-.511.195-.707 0l-1.273-1.272-.12.053c-.296.125-.648.238-1.071.352l-.162.041.001 1.775c0 .245-.177.45-.41.492l-.09.008H8c-.276 0-.5-.224-.5-.5l-.001-1.775-.161-.042c-.425-.114-.776-.227-1.072-.351l-.12-.054-1.271 1.272c-.174.174-.443.193-.638.058l-.07-.057-1.885-1.886c-.195-.195-.196-.512 0-.707l1.272-1.273-.053-.12c-.125-.296-.238-.648-.352-1.071l-.042-.161H1.333c-.245 0-.45-.177-.492-.41L.833 10V8c0-.276.224-.5.5-.5h1.774l.042-.16c.114-.424.227-.776.352-1.072l.052-.121-1.271-1.271c-.174-.174-.193-.443-.058-.638l.058-.07 1.886-1.886c.195-.195.512-.195.707 0l1.272 1.272.121-.053c.297-.125.65-.238 1.073-.351l.158-.042.001-1.775c0-.245.177-.45.41-.492L8 .833zm-.501 1h-1L8.5 3.499c0 .202-.121.38-.302.459l-.08.027c-.857.206-1.458.397-1.805.608-.197.12-.45.09-.614-.073L4.521 3.342 3.342 4.521 4.52 5.699c.14.14.182.347.116.527l-.043.087c-.211.347-.402.947-.61 1.805-.054.224-.255.382-.486.382H1.833v1h1.664c.202 0 .381.121.46.301l.026.081c.208.858.399 1.458.61 1.805.12.197.09.45-.073.614l-1.178 1.177 1.178 1.179 1.178-1.178c.14-.14.347-.182.528-.115l.087.042c.277.17.714.325 1.32.487l.485.124c.224.054.382.255.382.486l-.001 1.663h1l.001-1.663c0-.202.121-.381.301-.46l.081-.026c.858-.208 1.458-.399 1.804-.61.197-.12.45-.09.614.073l1.178 1.177 1.179-1.179-1.177-1.177c-.14-.14-.182-.347-.116-.527l.043-.087c.189-.31.37-.852.554-1.577l.056-.23c.055-.223.256-.38.486-.38h1.663v-1h-1.664c-.202 0-.381-.121-.46-.302l-.026-.08c-.206-.854-.398-1.458-.61-1.806-.12-.197-.09-.45.074-.614l1.176-1.177-1.178-1.178L12.3 4.52c-.14.14-.346.182-.526.116l-.088-.043c-.277-.169-.717-.325-1.32-.486l-.483-.122C9.658 3.93 9.5 3.73 9.5 3.499l-.001-1.666zm1.976 4.692c1.367 1.367 1.367 3.583 0 4.95s-3.583 1.367-4.95 0-1.367-3.583 0-4.95 3.583-1.367 4.95 0zm-4.243.707c-.976.977-.976 2.56 0 3.536.977.976 2.56.976 3.536 0 .934-.934.974-2.423.122-3.405l-.122-.13-.13-.123c-.983-.852-2.472-.812-3.406.122z\"\r\n            transform=\"translate(-636 -585) translate(276 301) translate(360 284) translate(3 3)\"\r\n          />\r\n        </g>\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React, { useState, useRef } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport MenuContainer from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles, Theme, useMediaQuery } from '@material-ui/core';\r\n\r\nimport AboutDialog from '../../../AboutDialog/AboutDialog';\r\nimport ConnectionOptionsDialog from '../../../ConnectionOptionsDialog/ConnectionOptionsDialog';\r\nimport DeviceSelectionDialog from '../../../DeviceSelectionDialog/DeviceSelectionDialog';\r\nimport SettingsIcon from '../../../../icons/SettingsIcon';\r\nimport { useAppState } from '../../../../state';\r\n\r\nconst useStyles = makeStyles({\r\n  settingsButton: {\r\n    margin: '1.8em 0 0',\r\n  },\r\n});\r\n\r\nexport default function SettingsMenu({ mobileButtonClass }: { mobileButtonClass?: string }) {\r\n  const classes = useStyles();\r\n  const { roomType } = useAppState();\r\n  const isMobile = useMediaQuery((theme: Theme) => theme.breakpoints.down('sm'));\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n  const [aboutOpen, setAboutOpen] = useState(false);\r\n  const [deviceSettingsOpen, setDeviceSettingsOpen] = useState(false);\r\n  const [connectionSettingsOpen, setConnectionSettingsOpen] = useState(false);\r\n\r\n  const anchorRef = useRef<HTMLButtonElement>(null);\r\n\r\n  return (\r\n    <>\r\n      {isMobile ? (\r\n        <Button\r\n          ref={anchorRef}\r\n          onClick={() => setMenuOpen(true)}\r\n          startIcon={<MoreIcon />}\r\n          className={mobileButtonClass}\r\n        >\r\n          More\r\n        </Button>\r\n      ) : (\r\n        <Button\r\n          ref={anchorRef}\r\n          onClick={() => setMenuOpen(true)}\r\n          startIcon={<SettingsIcon />}\r\n          className={classes.settingsButton}\r\n        >\r\n          Settings\r\n        </Button>\r\n      )}\r\n      <MenuContainer\r\n        open={menuOpen}\r\n        onClose={() => setMenuOpen(isOpen => !isOpen)}\r\n        anchorEl={anchorRef.current}\r\n        getContentAnchorEl={null}\r\n        anchorOrigin={{\r\n          vertical: 'top',\r\n          horizontal: isMobile ? 'left' : 'right',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: isMobile ? -55 : -45,\r\n          horizontal: 'center',\r\n        }}\r\n      >\r\n        <MenuItem onClick={() => setAboutOpen(true)}>\r\n          <Typography variant=\"body1\">About</Typography>\r\n        </MenuItem>\r\n        <MenuItem onClick={() => setDeviceSettingsOpen(true)}>\r\n          <Typography variant=\"body1\">Audio and Video Settings</Typography>\r\n        </MenuItem>\r\n        {roomType !== 'peer-to-peer' && roomType !== 'go' && (\r\n          <MenuItem onClick={() => setConnectionSettingsOpen(true)}>\r\n            <Typography variant=\"body1\">Connection Settings</Typography>\r\n          </MenuItem>\r\n        )}\r\n      </MenuContainer>\r\n      <AboutDialog\r\n        open={aboutOpen}\r\n        onClose={() => {\r\n          setAboutOpen(false);\r\n          setMenuOpen(false);\r\n        }}\r\n      />\r\n      <DeviceSelectionDialog\r\n        open={deviceSettingsOpen}\r\n        onClose={() => {\r\n          setDeviceSettingsOpen(false);\r\n          setMenuOpen(false);\r\n        }}\r\n      />\r\n      <ConnectionOptionsDialog\r\n        open={connectionSettingsOpen}\r\n        onClose={() => {\r\n          setConnectionSettingsOpen(false);\r\n          setMenuOpen(false);\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { makeStyles, Typography, Grid, Button, Theme, Hidden } from '@material-ui/core';\r\nimport LocalVideoPreview from './LocalVideoPreview/LocalVideoPreview';\r\nimport SettingsMenu from './SettingsMenu/SettingsMenu';\r\nimport { Steps } from '../PreJoinScreens';\r\nimport ToggleAudioButton from '../../Buttons/ToggleAudioButton/ToggleAudioButton';\r\nimport ToggleVideoButton from '../../Buttons/ToggleVideoButton/ToggleVideoButton';\r\nimport { useAppState } from '../../../state';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  gutterBottom: {\r\n    marginBottom: '1em',\r\n  },\r\n  marginTop: {\r\n    marginTop: '1em',\r\n  },\r\n  deviceButton: {\r\n    width: '100%',\r\n    border: '2px solid #aaa',\r\n    margin: '1em 0',\r\n  },\r\n  localPreviewContainer: {\r\n    paddingRight: '2em',\r\n    [theme.breakpoints.down('sm')]: {\r\n      padding: '0 2.5em',\r\n    },\r\n  },\r\n  joinButtons: {\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    [theme.breakpoints.down('sm')]: {\r\n      flexDirection: 'column-reverse',\r\n      width: '100%',\r\n      '& button': {\r\n        margin: '0.5em 0',\r\n      },\r\n    },\r\n  },\r\n  mobileButtonBar: {\r\n    [theme.breakpoints.down('sm')]: {\r\n      display: 'flex',\r\n      justifyContent: 'space-between',\r\n      margin: '1.5em 0 1em',\r\n    },\r\n  },\r\n  mobileButton: {\r\n    padding: '0.8em 0',\r\n    margin: 0,\r\n  },\r\n}));\r\n\r\ninterface DeviceSelectionScreenProps {\r\n  name: string;\r\n  roomName: string;\r\n  setStep: (step: Steps) => void;\r\n}\r\n\r\nexport default function DeviceSelectionScreen({ name, roomName, setStep }: DeviceSelectionScreenProps) {\r\n  const classes = useStyles();\r\n  const { getToken, isFetching } = useAppState();\r\n  const { connect, isAcquiringLocalTracks, isConnecting } = useVideoContext();\r\n  const disableButtons = isFetching || isAcquiringLocalTracks || isConnecting;\r\n\r\n  const handleJoin = () => {\r\n    getToken(name, roomName).then(token => connect(token));\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Typography variant=\"h5\" className={classes.gutterBottom}>\r\n        Join {roomName}\r\n      </Typography>\r\n\r\n      <Grid container justify=\"center\">\r\n        <Grid item md={7} sm={12} xs={12}>\r\n          <div className={classes.localPreviewContainer}>\r\n            <LocalVideoPreview identity={name} />\r\n          </div>\r\n          <div className={classes.mobileButtonBar}>\r\n            <Hidden mdUp>\r\n              <ToggleAudioButton className={classes.mobileButton} disabled={disableButtons} />\r\n              <ToggleVideoButton className={classes.mobileButton} disabled={disableButtons} />\r\n            </Hidden>\r\n            <SettingsMenu mobileButtonClass={classes.mobileButton} />\r\n          </div>\r\n        </Grid>\r\n        <Grid item md={5} sm={12} xs={12}>\r\n          <Grid container direction=\"column\" justify=\"space-between\" style={{ height: '100%' }}>\r\n            <div>\r\n              <Hidden smDown>\r\n                <ToggleAudioButton className={classes.deviceButton} disabled={disableButtons} />\r\n                <ToggleVideoButton className={classes.deviceButton} disabled={disableButtons} />\r\n              </Hidden>\r\n            </div>\r\n            <div className={classes.joinButtons}>\r\n              <Button variant=\"outlined\" color=\"primary\" onClick={() => setStep(Steps.roomNameStep)}>\r\n                Cancel\r\n              </Button>\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                data-cy-join-now\r\n                onClick={handleJoin}\r\n                disabled={disableButtons}\r\n              >\r\n                Join Now\r\n              </Button>\r\n            </div>\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function VideoLogo() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"96\" height=\"96\" viewBox=\"0 0 96 96\">\r\n      <g fill=\"none\" fillRule=\"evenodd\">\r\n        <path\r\n          fill=\"#FFF\"\r\n          d=\"M43.86 0h8.28c11.661 0 18.564 1.74 24.675 5.01 6.112 3.267 10.908 8.063 14.175 14.175C94.26 25.295 96 32.197 96 43.86v8.28c0 11.661-1.74 18.564-5.01 24.675-3.267 6.112-8.063 10.908-14.175 14.175C70.704 94.26 63.801 96 52.14 96h-8.28c-11.661 0-18.564-1.74-24.675-5.01-6.112-3.267-10.908-8.063-14.175-14.175C1.74 70.705 0 63.803 0 52.14v-8.28c0-11.661 1.74-18.564 5.01-24.675C8.277 13.073 13.073 8.277 19.185 5.01 25.295 1.74 32.197 0 43.86 0z\"\r\n        />\r\n        <path\r\n          fill=\"#F22F46\"\r\n          d=\"M53.25 63h-25.5C25.679 63 24 61.321 24 59.25v-22.5c0-2.071 1.679-3.75 3.75-3.75h25.5c2.071 0 3.75 1.679 3.75 3.75v5.82l9.57-4.785c1.164-.583 2.546-.521 3.653.164 1.107.685 1.78 1.894 1.777 3.196V54.87c.008 1.3-.66 2.512-1.766 3.198-1.105.686-2.487.747-3.65.162L57 53.49v5.76C57 61.321 55.32 63 53.25 63zm-25.5-27c-.414 0-.75.336-.75.75v22.5c0 .414.336.75.75.75h25.5c.414 0 .75-.336.75-.75v-8.175c-.001-.518.266-1 .705-1.275.44-.275.99-.303 1.455-.075L67.92 55.5c.224.123.496.123.72 0 .22-.141.356-.383.36-.645v-13.71c-.004-.262-.14-.504-.36-.645-.224-.123-.496-.123-.72 0l-11.745 5.865c-.47.236-1.028.21-1.473-.069-.445-.28-.711-.77-.702-1.296v-8.25c0-.414-.336-.75-.75-.75h-25.5z\"\r\n        />\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React, { SVGProps } from 'react';\r\n\r\nexport default function TwilioLogo(props: SVGProps<SVGSVGElement>) {\r\n  return (\r\n    <svg fill=\"#F22F46\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" {...props}>\r\n      <path d=\"M15 0C6.7 0 0 6.7 0 15s6.7 15 15 15 15-6.7 15-15S23.3 0 15 0zm0 26C8.9 26 4 21.1 4 15S8.9 4 15 4s11 4.9 11 11-4.9 11-11 11zm6.8-14.7c0 1.7-1.4 3.1-3.1 3.1s-3.1-1.4-3.1-3.1 1.4-3.1 3.1-3.1 3.1 1.4 3.1 3.1zm0 7.4c0 1.7-1.4 3.1-3.1 3.1s-3.1-1.4-3.1-3.1c0-1.7 1.4-3.1 3.1-3.1s3.1 1.4 3.1 3.1zm-7.4 0c0 1.7-1.4 3.1-3.1 3.1s-3.1-1.4-3.1-3.1c0-1.7 1.4-3.1 3.1-3.1s3.1 1.4 3.1 3.1zm0-7.4c0 1.7-1.4 3.1-3.1 3.1S8.2 13 8.2 11.3s1.4-3.1 3.1-3.1 3.1 1.4 3.1 3.1z\" />\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport makeStyles from '@material-ui/styles/makeStyles';\r\nimport Person from '@material-ui/icons/Person';\r\nimport { StateContextType } from '../../../../state';\r\n\r\nconst useStyles = makeStyles({\r\n  red: {\r\n    color: 'white',\r\n    backgroundColor: '#F22F46',\r\n  },\r\n});\r\n\r\nexport function getInitials(name: string) {\r\n  return name\r\n    .split(' ')\r\n    .map(text => text[0])\r\n    .join('')\r\n    .toUpperCase();\r\n}\r\n\r\nexport default function UserAvatar({ user }: { user: StateContextType['user'] }) {\r\n  const classes = useStyles();\r\n  const { displayName, photoURL } = user!;\r\n\r\n  return photoURL ? (\r\n    <Avatar src={photoURL} />\r\n  ) : (\r\n    <Avatar className={classes.red}>{displayName ? getInitials(displayName) : <Person />}</Avatar>\r\n  );\r\n}\r\n","import React, { useState, useRef, useCallback } from 'react';\r\nimport { makeStyles, Typography, Button, MenuItem, Link } from '@material-ui/core';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport { useAppState } from '../../../state';\r\nimport UserAvatar from './UserAvatar/UserAvatar';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nconst useStyles = makeStyles({\r\n  userContainer: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    right: 0,\r\n    margin: '1em',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n  userButton: {\r\n    color: 'white',\r\n  },\r\n  logoutLink: {\r\n    color: 'white',\r\n    cursor: 'pointer',\r\n    padding: '10px 20px',\r\n  },\r\n});\r\n\r\nconst UserMenu: React.FC = () => {\r\n  const classes = useStyles();\r\n  const { user, signOut } = useAppState();\r\n  const { localTracks } = useVideoContext();\r\n\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n  const anchorRef = useRef<HTMLButtonElement>(null);\r\n\r\n  const handleSignOut = useCallback(() => {\r\n    localTracks.forEach(track => track.stop());\r\n    signOut?.();\r\n  }, [localTracks, signOut]);\r\n\r\n  if (process.env.REACT_APP_SET_AUTH === 'passcode') {\r\n    return (\r\n      <div className={classes.userContainer}>\r\n        <Link onClick={handleSignOut} className={classes.logoutLink}>\r\n          Logout\r\n        </Link>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (process.env.REACT_APP_SET_AUTH === 'firebase') {\r\n    return (\r\n      <div className={classes.userContainer}>\r\n        <UserAvatar user={user} />\r\n        <Button onClick={() => setMenuOpen(isOpen => !isOpen)} ref={anchorRef} className={classes.userButton}>\r\n          {user!.displayName}\r\n          <ExpandMoreIcon />\r\n        </Button>\r\n        <Menu\r\n          open={menuOpen}\r\n          onClose={() => setMenuOpen(isOpen => !isOpen)}\r\n          anchorEl={anchorRef.current}\r\n          getContentAnchorEl={null}\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'center',\r\n          }}\r\n          transformOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'center',\r\n          }}\r\n        >\r\n          <MenuItem onClick={handleSignOut}>\r\n            <Typography variant=\"body1\">Logout</Typography>\r\n          </MenuItem>\r\n        </Menu>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default UserMenu;\r\n","import React from 'react';\r\nimport { makeStyles, Theme, Typography } from '@material-ui/core';\r\nimport Swoosh from './swoosh';\r\nimport VideoLogo from './VideoLogo';\r\nimport TwilioLogo from './TwilioLogo';\r\nimport { useAppState } from '../../state';\r\nimport UserMenu from './UserMenu/UserMenu';\r\nimport { useLocation } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  background: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    background: 'rgb(40, 42, 43)',\r\n    height: '100%',\r\n  },\r\n  container: {\r\n    position: 'relative',\r\n    flex: '1',\r\n  },\r\n  innerContainer: {\r\n    display: 'flex',\r\n    width: '888px',\r\n    height: '379px',\r\n    borderRadius: '8px',\r\n    boxShadow: '0px 2px 4px 0px rgba(40, 42, 43, 0.3)',\r\n    overflow: 'hidden',\r\n    position: 'relative',\r\n    margin: 'auto',\r\n    [theme.breakpoints.down('sm')]: {\r\n      display: 'block',\r\n      height: 'auto',\r\n      width: 'calc(100% - 40px)',\r\n      margin: 'auto',\r\n      maxWidth: '400px',\r\n    },\r\n  },\r\n  swooshContainer: {\r\n    position: 'relative',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundImage: Swoosh,\r\n    backgroundSize: 'cover',\r\n    width: '296px',\r\n    [theme.breakpoints.down('sm')]: {\r\n      width: '100%',\r\n      height: '100px',\r\n      backgroundPositionY: '140px',\r\n    },\r\n  },\r\n  logoContainer: {\r\n    position: 'absolute',\r\n    width: '210px',\r\n    textAlign: 'center',\r\n    [theme.breakpoints.down('sm')]: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      width: '90%',\r\n      textAlign: 'initial',\r\n      '& svg': {\r\n        height: '64px',\r\n      },\r\n    },\r\n  },\r\n  twilioLogo: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    margin: '20px',\r\n  },\r\n  content: {\r\n    background: 'white',\r\n    width: '100%',\r\n    padding: '4em',\r\n    flex: 1,\r\n    [theme.breakpoints.down('sm')]: {\r\n      padding: '2em',\r\n    },\r\n  },\r\n  title: {\r\n    color: 'white',\r\n    margin: '1em 0 0',\r\n    [theme.breakpoints.down('sm')]: {\r\n      margin: 0,\r\n      fontSize: '1.1rem',\r\n    },\r\n  },\r\n  subContentContainer: {\r\n    position: 'absolute',\r\n    marginTop: '1em',\r\n    width: '100%',\r\n  },\r\n}));\r\n\r\ninterface IntroContainerProps {\r\n  children: React.ReactNode;\r\n  subContent?: React.ReactNode;\r\n}\r\n\r\nconst IntroContainer = (props: IntroContainerProps) => {\r\n  const classes = useStyles();\r\n  const { user } = useAppState();\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <div className={classes.background}>\r\n      <TwilioLogo className={classes.twilioLogo} />\r\n      {user && location.pathname !== '/login' && <UserMenu />}\r\n      <div className={classes.container}>\r\n        <div className={classes.innerContainer}>\r\n          <div className={classes.swooshContainer}>\r\n            <div className={classes.logoContainer}>\r\n              <VideoLogo />\r\n              <Typography variant=\"h6\" className={classes.title}>\r\n                Twilio Programmable Video\r\n              </Typography>\r\n            </div>\r\n          </div>\r\n          <div className={classes.content}>{props.children}</div>\r\n        </div>\r\n        {props.subContent && <div className={classes.subContentContainer}>{props.subContent}</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default IntroContainer;\r\n","const Swoosh = `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='296' height='378' viewBox='0 0 296 378'%3E%3Cdefs%3E%3ClinearGradient id='utbttnlrpc' x1='78.976%25' x2='63.882%25' y1='60.873%25' y2='45.554%25'%3E%3Cstop offset='0%25' stop-opacity='0'/%3E%3Cstop offset='100%25'/%3E%3C/linearGradient%3E%3ClinearGradient id='aim8r3oczd' x1='78.976%25' x2='63.882%25' y1='56.106%25' y2='47.503%25'%3E%3Cstop offset='0%25' stop-opacity='0'/%3E%3Cstop offset='100%25'/%3E%3C/linearGradient%3E%3Cpath id='5tk4i6f80a' d='M0 0H296V378H0z'/%3E%3C/defs%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cmask id='m1ihwluuxb' fill='%23fff'%3E%3Cuse xlink:href='%235tk4i6f80a'/%3E%3C/mask%3E%3Cuse fill='%23DE5858' xlink:href='%235tk4i6f80a'/%3E%3Cg mask='url(%23m1ihwluuxb)'%3E%3Cg%3E%3Cpath fill='url(%23utbttnlrpc)' d='M0 286.83c87.695-83.937 175.802-132.682 264.323-146.233 132.78-20.328 183.24 4.255 225.143-23.414 73.409-48.471 93.039-15.154 148.326-20.892 44.84-4.654 98.48-77.401 135.81-91.717C795.596-3.86 821.469.801 851.22 18.56L891 476.5H0V286.83z' opacity='.06' transform='translate(-457 -22.5)'/%3E%3Cpath fill='url(%23aim8r3oczd)' d='M137 604.5c63.759-109.686 155.8-165.124 276.126-166.315 180.488-1.786 157.888-146.686 387.11-146.33 229.223.356 170.665-151.786 341.36-166.888 113.797-10.068 180.265 10.685 199.404 62.26V604.5H137z' opacity='.08' transform='translate(-457 -22.5)'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A\");`;\r\nexport default Swoosh;\r\n","import React from 'react';\r\n\r\nexport default function ErrorIcon() {\r\n  return (\r\n    <svg width=\"14px\" height=\"14px\" viewBox=\"0 0 14 14\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\r\n      <g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\r\n        <g transform=\"translate(-299.000000, -723.000000)\" fill=\"#D61F1F\">\r\n          <g transform=\"translate(276.000000, 704.000000)\">\r\n            <g transform=\"translate(23.000000, 19.000000)\">\r\n              <path\r\n                d=\"M8.03935839,0.763849674 L13.2361503,5.96064161 C13.8101721,6.5346634 13.8101721,7.4653366 13.2361503,8.03935839 L8.03935839,13.2361503 C7.4653366,13.8101721 6.5346634,13.8101721 5.96064161,13.2361503 L0.763849674,8.03935839 C0.189827887,7.4653366 0.189827887,6.5346634 0.763849674,5.96064161 L5.96064161,0.763849674 C6.5346634,0.189827887 7.4653366,0.189827887 8.03935839,0.763849674 Z M7,8.66666667 C6.53976271,8.66666667 6.16666667,9.03976271 6.16666667,9.5 C6.16666667,9.96023729 6.53976271,10.3333333 7,10.3333333 C7.46023729,10.3333333 7.83333333,9.96023729 7.83333333,9.5 C7.83333333,9.03976271 7.46023729,8.66666667 7,8.66666667 Z M7.00842529,4.5 L6.99145559,4.5 C6.48802096,4.5 6.09771771,4.99363437 6.17690967,5.53663218 L6.53327351,7.40140326 C6.56721292,7.64822044 6.76519283,7.83333333 6.99711216,7.83333333 L7.00276873,7.83333333 C7.23468805,7.83333333 7.43266796,7.64822044 7.46660737,7.40140326 L7.82297121,5.53663218 C7.90216317,4.99363437 7.51751649,4.50617043 7.00842529,4.5 Z\"\r\n                id=\"Error\"\r\n              ></path>\r\n            </g>\r\n          </g>\r\n        </g>\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function WarningIcon() {\r\n  return (\r\n    <svg width=\"16px\" height=\"14px\" viewBox=\"0 0 16 14\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\r\n      <g stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\r\n        <g transform=\"translate(-273.000000, -162.000000)\" fill=\"#E46216\">\r\n          <g transform=\"translate(251.000000, 143.000000)\">\r\n            <g transform=\"translate(22.000000, 19.000000)\">\r\n              <path d=\"M6.68405227,0.743750848 C7.26590697,-0.247916949 8.73410873,-0.247916949 9.31596344,0.743750848 L9.31596344,0.743750848 L15.7980583,11.7915293 C16.3754418,12.775573 15.6458879,14 14.4821027,14 L14.4821027,14 L1.5178827,14 C0.354135396,14 -0.375441293,12.775573 0.201934693,11.7915293 L0.201934693,11.7915293 Z M8,10 C7.44771525,10 7,10.4477153 7,11 C7,11.5522847 7.44771525,12 8,12 C8.55228475,12 9,11.5522847 9,11 C9,10.4477153 8.55228475,10 8,10 Z M8.01011035,5 L7.98974671,5 L7.87816923,5.00681158 C7.32928042,5.07427655 6.92320065,5.63308608 7.01229161,6.24395862 L7.01229161,6.24395862 L7.43992821,8.48168391 L7.46058982,8.57746523 C7.53403676,8.82448556 7.74990819,9 8.00332247,9 L8.00332247,9 L8.09436762,8.9919759 C8.33199007,8.94972242 8.5237268,8.74495557 8.55992884,8.48168391 L8.55992884,8.48168391 L8.98756545,6.24395862 L8.99896034,6.12268979 C9.02431547,5.52149772 8.58283795,5.00694173 8.01011035,5 L8.01011035,5 Z\"></path>\r\n            </g>\r\n          </g>\r\n        </g>\r\n      </g>\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport ErrorIcon from '../../icons/ErrorIcon';\r\nimport { IconButton, makeStyles, Theme, Typography } from '@material-ui/core';\r\nimport MUISnackbar from '@material-ui/core/Snackbar';\r\nimport WarningIcon from '../../icons/WarningIcon';\r\n\r\ninterface SnackbarProps {\r\n  headline: string;\r\n  message: string;\r\n  variant?: 'error' | 'warning';\r\n  open: boolean;\r\n  handleClose?: () => void;\r\n}\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  container: {\r\n    display: 'flex',\r\n    alignItems: 'baseline',\r\n    justifyContent: 'space-between',\r\n    width: '400px',\r\n    minHeight: '50px',\r\n    background: 'white',\r\n    padding: '1em',\r\n    borderRadius: '3px',\r\n    boxShadow: '0 12px 24px 4px rgba(40,42,43,0.2)',\r\n    [theme.breakpoints.down('sm')]: {\r\n      width: '100%',\r\n    },\r\n  },\r\n  contentContainer: {\r\n    display: 'flex',\r\n  },\r\n  iconContainer: {\r\n    display: 'flex',\r\n    padding: '0 1.3em 0 0.3em',\r\n    transform: 'translateY(4px)',\r\n  },\r\n  headline: {\r\n    fontWeight: 'bold',\r\n  },\r\n  error: {\r\n    borderLeft: '4px solid #D61F1F',\r\n  },\r\n  warning: {\r\n    borderLeft: '4px solid #E46216',\r\n  },\r\n}));\r\n\r\nexport default function Snackbar({ headline, message, variant, open, handleClose }: SnackbarProps) {\r\n  const classes = useStyles();\r\n\r\n  const handleOnClose = (_: React.SyntheticEvent | React.MouseEvent, reason?: string) => {\r\n    if (reason === 'clickaway') {\r\n      return;\r\n    }\r\n\r\n    handleClose?.();\r\n  };\r\n\r\n  return (\r\n    <MUISnackbar\r\n      anchorOrigin={{\r\n        vertical: 'top',\r\n        horizontal: 'right',\r\n      }}\r\n      open={open}\r\n      onClose={handleOnClose}\r\n    >\r\n      <div\r\n        className={clsx(classes.container, {\r\n          [classes.error]: variant === 'error',\r\n          [classes.warning]: variant === 'warning',\r\n        })}\r\n      >\r\n        <div className={classes.contentContainer}>\r\n          <div className={classes.iconContainer}>\r\n            {variant === 'warning' && <WarningIcon />}\r\n            {variant === 'error' && <ErrorIcon />}\r\n          </div>\r\n          <div>\r\n            <Typography variant=\"body1\" className={classes.headline} component=\"span\">\r\n              {headline}\r\n            </Typography>\r\n            <Typography variant=\"body1\" component=\"span\">\r\n              {' '}\r\n              {message}\r\n            </Typography>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          {handleClose && (\r\n            <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={handleClose}>\r\n              <CloseIcon fontSize=\"small\" />\r\n            </IconButton>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </MUISnackbar>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport Snackbar from '../../Snackbar/Snackbar';\r\nimport useDevices from '../../../hooks/useDevices/useDevices';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport function getSnackbarContent(hasAudio: boolean, hasVideo: boolean, error?: Error) {\r\n  let headline = '';\r\n  let message = '';\r\n\r\n  switch (true) {\r\n    // This error is emitted when the user or the user's system has denied permission to use the media devices\r\n    case error?.name === 'NotAllowedError':\r\n      headline = 'Unable to Access Media:';\r\n\r\n      if (error!.message === 'Permission denied by system') {\r\n        // Chrome only\r\n        message =\r\n          'The operating system has blocked the browser from accessing the microphone or camera. Please check your operating system settings.';\r\n      } else {\r\n        message =\r\n          'The user has denied permission to use audio and video. Please grant permission to the browser to access the microphone and camera.';\r\n      }\r\n\r\n      break;\r\n\r\n    // This error is emitted when input devices are not connected or disabled in the OS settings\r\n    case error?.name === 'NotFoundError':\r\n      headline = 'Cannot Find Microphone or Camera:';\r\n      message =\r\n        'The browser cannot access the microphone or camera. Please make sure all input devices are connected and enabled.';\r\n      break;\r\n\r\n    // Other getUserMedia errors are less likely to happen in this app. Here we will display\r\n    // the system's error message directly to the user.\r\n    case Boolean(error):\r\n      headline = 'Error Acquiring Media:';\r\n      message = `${error!.name} ${error!.message}`;\r\n      break;\r\n\r\n    case !hasAudio && !hasVideo:\r\n      headline = 'No Camera or Microphone Detected:';\r\n      message = 'Other participants in the room will be unable to see and hear you.';\r\n      break;\r\n\r\n    case !hasVideo:\r\n      headline = 'No Camera Detected:';\r\n      message = 'Other participants in the room will be unable to see you.';\r\n      break;\r\n\r\n    case !hasAudio:\r\n      headline = 'No Microphone Detected:';\r\n      message = 'Other participants in the room will be unable to hear you.';\r\n  }\r\n\r\n  return {\r\n    headline,\r\n    message,\r\n  };\r\n}\r\n\r\nexport default function MediaErrorSnackbar({ error }: { error?: Error }) {\r\n  const { hasAudioInputDevices, hasVideoInputDevices } = useDevices();\r\n\r\n  const { isAcquiringLocalTracks } = useVideoContext();\r\n\r\n  const [isSnackbarDismissed, setIsSnackbarDismissed] = useState(false);\r\n\r\n  const isSnackbarOpen =\r\n    !isSnackbarDismissed &&\r\n    !isAcquiringLocalTracks &&\r\n    (Boolean(error) || !hasAudioInputDevices || !hasVideoInputDevices);\r\n\r\n  const { headline, message } = getSnackbarContent(hasAudioInputDevices, hasVideoInputDevices, error);\r\n\r\n  return (\r\n    <Snackbar\r\n      open={isSnackbarOpen}\r\n      handleClose={() => setIsSnackbarDismissed(true)}\r\n      headline={headline}\r\n      message={message}\r\n      variant=\"warning\"\r\n    />\r\n  );\r\n}\r\n","import { NetworkCondition } from '../PreflightTest';\r\nimport { PreflightTestReport } from '../../../../types';\r\n\r\nexport function getSingleNetworkCondition(stat: number | undefined, yellowThreshold: number, redThreshold: number) {\r\n  if (typeof stat === 'undefined') {\r\n    // We ignore values that are missing\r\n    return NetworkCondition.Green;\r\n  }\r\n\r\n  if (stat >= redThreshold) return NetworkCondition.Red;\r\n  if (stat >= yellowThreshold) return NetworkCondition.Yellow;\r\n  return NetworkCondition.Green;\r\n}\r\n\r\nexport default function getNetworkCondition(testReport?: PreflightTestReport) {\r\n  if (!testReport) return undefined;\r\n\r\n  const latency = testReport.stats.rtt?.average;\r\n  const jitter = testReport.stats.jitter.average;\r\n  const packetLoss = testReport.stats.packetLoss.average;\r\n\r\n  return Math.min(\r\n    getSingleNetworkCondition(latency, 200, 400),\r\n    getSingleNetworkCondition(jitter, 30, 100),\r\n    getSingleNetworkCondition(packetLoss, 3, 7)\r\n  ) as NetworkCondition;\r\n}\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core';\r\nimport { TEST_DURATION } from '../PreflightTest';\r\n\r\nconst SIZE = 24;\r\nconst THICKNESS = 3;\r\nconst OUTER_RADIUS = SIZE / 2;\r\nconst INNER_RADIUS = OUTER_RADIUS - THICKNESS;\r\nconst INNER_CIRCUMFERENCE = 2 * Math.PI * INNER_RADIUS;\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  svg: {\r\n    transform: 'rotate(-90deg)',\r\n    marginRight: '0.6em',\r\n    fill: 'none',\r\n  },\r\n  innerCircle: {\r\n    stroke: 'rgb(200, 204, 207)',\r\n  },\r\n  circle: {\r\n    stroke: '#027AC5',\r\n    strokeDasharray: INNER_CIRCUMFERENCE,\r\n    strokeDashoffset: '0px',\r\n    animation: `${TEST_DURATION / 1000 + 1}s $progress linear`,\r\n  },\r\n  '@keyframes progress': {\r\n    '0%': {\r\n      strokeDashoffset: `${INNER_CIRCUMFERENCE}px`,\r\n    },\r\n    '100%': {\r\n      strokeDashoffset: '0px',\r\n    },\r\n  },\r\n}));\r\n\r\nexport default function ProgressIndicator() {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <svg\r\n      viewBox={`0 0 ${SIZE} ${SIZE}`}\r\n      width={SIZE}\r\n      height={SIZE}\r\n      strokeWidth={`${THICKNESS}px`}\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      className={classes.svg}\r\n    >\r\n      <circle cx={OUTER_RADIUS} cy={OUTER_RADIUS} r={INNER_RADIUS} className={classes.innerCircle} />\r\n      <circle cx={OUTER_RADIUS} cy={OUTER_RADIUS} r={INNER_RADIUS} className={classes.circle} />\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport function SuccessIcon() {\r\n  return (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\" viewBox=\"0 0 28 28\">\r\n      <path\r\n        fill=\"#00994A\"\r\n        d=\"M14 4.667c5.155 0 9.333 4.178 9.333 9.333S19.155 23.333 14 23.333 4.667 19.155 4.667 14 8.845 4.667 14 4.667zm3.496 5.833c-.31 0-.608.123-.827.343l-3.834 3.843-1.504-1.514c-.22-.22-.517-.342-.827-.342-.31 0-.608.123-.828.342-.22.22-.343.517-.343.827 0 .31.124.608.343.827l2.331 2.33c.108.109.237.195.38.254.141.06.294.09.448.09.153 0 .306-.03.448-.09.142-.059.27-.145.379-.255l4.662-4.659c.22-.219.343-.516.343-.826 0-.31-.124-.608-.343-.827-.22-.22-.517-.343-.828-.343z\"\r\n        transform=\"translate(-588 -698) translate(588 698)\"\r\n      />\r\n    </svg>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport usePreflightTest from './usePreflightTest/usePreflightTest';\r\nimport { makeStyles, Typography, Grid } from '@material-ui/core';\r\nimport useGetPreflightTokens from './useGetPreflightTokens/useGetPreflightTokens';\r\nimport getNetworkCondition from './getNetworkCondition/getNetworkCondition';\r\nimport ProgressIndicator from './ProgressIndicator/ProgressIndicator';\r\nimport { SuccessIcon } from '../../../icons/SuccessIcon';\r\nimport WarningIcon from '../../../icons/WarningIcon';\r\nimport ErrorIcon from '../../../icons/ErrorIcon';\r\n\r\nexport const TEST_DURATION = 10000;\r\n\r\nexport enum NetworkCondition {\r\n  Red,\r\n  Yellow,\r\n  Green,\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n  iconContainer: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    marginRight: '0.4em',\r\n  },\r\n  result: {\r\n    color: 'white',\r\n  },\r\n});\r\n\r\nfunction ResultItem({ children, icon }: { children: React.ReactNode; icon: React.ReactNode }) {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <>\r\n      <div className={classes.iconContainer}>{icon}</div>\r\n      <Typography variant=\"subtitle2\" className={classes.result}>\r\n        {children}\r\n      </Typography>\r\n    </>\r\n  );\r\n}\r\n\r\nexport function Result({ networkCondition, error }: { networkCondition?: NetworkCondition; error?: Error }) {\r\n  if (error) {\r\n    return <ResultItem icon={<ErrorIcon />}>There was a problem connecting to the network</ResultItem>;\r\n  }\r\n\r\n  if (networkCondition === NetworkCondition.Red) {\r\n    return (\r\n      <ResultItem icon={<ErrorIcon />}>\r\n        Poor network conditions. You may experience poor call quality and reliability.\r\n      </ResultItem>\r\n    );\r\n  }\r\n\r\n  if (networkCondition === NetworkCondition.Yellow) {\r\n    return (\r\n      <ResultItem icon={<WarningIcon />}>\r\n        Poor network conditions. You may experience degraded video performance.\r\n      </ResultItem>\r\n    );\r\n  }\r\n\r\n  if (networkCondition === NetworkCondition.Green) {\r\n    return <ResultItem icon={<SuccessIcon />}>Your network connection is stable</ResultItem>;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nexport default function PreflightTest() {\r\n  const classes = useStyles();\r\n\r\n  const { tokens, tokenError } = useGetPreflightTokens();\r\n  const { testFailure, testReport } = usePreflightTest(tokens?.[0], tokens?.[1]);\r\n\r\n  const networkCondition = getNetworkCondition(testReport);\r\n\r\n  return (\r\n    <Grid container justify=\"center\" alignItems=\"center\" style={{ height: '55px', paddingBottom: '1.5em' }}>\r\n      {!testFailure && !testReport ? (\r\n        <>\r\n          <ProgressIndicator />\r\n          <Typography variant=\"subtitle2\" className={classes.result}>\r\n            Checking your network connection\r\n          </Typography>\r\n        </>\r\n      ) : (\r\n        <Result networkCondition={networkCondition} error={tokenError || testFailure} />\r\n      )}\r\n    </Grid>\r\n  );\r\n}\r\n","import { nanoid } from 'nanoid';\r\nimport { useAppState } from '../../../../state';\r\nimport { useState, useEffect } from 'react';\r\n\r\nexport default function useGetPreflightTokens() {\r\n  const { getToken } = useAppState();\r\n  const [tokens, setTokens] = useState<[string, string]>();\r\n  const [tokenError, setTokenError] = useState<Error>();\r\n  const [isFetching, setIsFetching] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isFetching && !tokens) {\r\n      const roomName = 'preflight-network-test-' + nanoid();\r\n\r\n      setIsFetching(true);\r\n\r\n      const publisherIdentity = 'participant-' + nanoid();\r\n      const subscriberIdentity = 'participant-' + nanoid();\r\n\r\n      Promise.all([getToken(publisherIdentity, roomName), getToken(subscriberIdentity, roomName)])\r\n        .then(newTokens => {\r\n          setTokens(newTokens);\r\n          setIsFetching(false);\r\n        })\r\n        .catch(error => setTokenError(error));\r\n    }\r\n  }, [getToken, isFetching, tokens]);\r\n\r\n  return { tokens, tokenError };\r\n}\r\n","import { PreflightTestReport, PreflightTest } from '../../../../types';\r\nimport { TEST_DURATION } from '../PreflightTest';\r\nimport Video from 'twilio-video';\r\nimport { useEffect, useState, useRef } from 'react';\r\nimport useVideoContext from '../../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function usePreflightTest(publisherToken?: string, subscriberToken?: string) {\r\n  const { isConnecting } = useVideoContext();\r\n  const [testReport, setTestReport] = useState<PreflightTestReport>();\r\n  const [testFailure, setTestFailure] = useState<Error>();\r\n  const [isTestRunning, setIsTestRunning] = useState(false);\r\n  const preflightTestRef = useRef<PreflightTest>();\r\n\r\n  // This will stop the preflight test when the user connects to a room\r\n  useEffect(() => {\r\n    if (isConnecting) {\r\n      preflightTestRef.current?.stop();\r\n      preflightTestRef.current?.removeAllListeners('completed');\r\n      preflightTestRef.current?.removeAllListeners('failed');\r\n    }\r\n  }, [isConnecting]);\r\n\r\n  // This will stop the preflight test when the component is unmounted.\r\n  useEffect(() => {\r\n    return () => {\r\n      preflightTestRef.current?.stop();\r\n      preflightTestRef.current?.removeAllListeners('completed');\r\n      preflightTestRef.current?.removeAllListeners('failed');\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (publisherToken && subscriberToken && !testReport && !testFailure && !isTestRunning) {\r\n      setIsTestRunning(true);\r\n\r\n      preflightTestRef.current = Video.testPreflight(publisherToken, subscriberToken, { duration: TEST_DURATION });\r\n\r\n      preflightTestRef\r\n        .current!.on('completed', (report: any) => {\r\n          setTestReport(report);\r\n          setIsTestRunning(false);\r\n          console.log('Preflight network test completed. See test report below:');\r\n          console.log(report);\r\n        })\r\n        .on('failed', (error: any) => {\r\n          setTestFailure(error);\r\n          setIsTestRunning(false);\r\n          console.log('Preflight network test failed. See error below:');\r\n          console.log(error);\r\n        });\r\n    }\r\n  }, [publisherToken, subscriberToken, testReport, testFailure, isTestRunning]);\r\n\r\n  return {\r\n    testReport,\r\n    testFailure,\r\n    isTestRunning,\r\n  };\r\n}\r\n","import React, { ChangeEvent, FormEvent } from 'react';\r\nimport { Typography, makeStyles, TextField, Grid, Button, InputLabel, Theme } from '@material-ui/core';\r\nimport { useAppState } from '../../../state';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  gutterBottom: {\r\n    marginBottom: '1em',\r\n  },\r\n  inputContainer: {\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    margin: '1.5em 0 3.5em',\r\n    '& div:not(:last-child)': {\r\n      marginRight: '1em',\r\n    },\r\n    [theme.breakpoints.down('sm')]: {\r\n      margin: '1.5em 0 2em',\r\n    },\r\n  },\r\n  textFieldContainer: {\r\n    width: '100%',\r\n  },\r\n  continueButton: {\r\n    [theme.breakpoints.down('sm')]: {\r\n      width: '100%',\r\n    },\r\n  },\r\n}));\r\n\r\ninterface RoomNameScreenProps {\r\n  name: string;\r\n  roomName: string;\r\n  setName: (name: string) => void;\r\n  setRoomName: (roomName: string) => void;\r\n  handleSubmit: (event: FormEvent<HTMLFormElement>) => void;\r\n}\r\n\r\nexport default function RoomNameScreen({ name, roomName, setName, setRoomName, handleSubmit }: RoomNameScreenProps) {\r\n  const classes = useStyles();\r\n  const { user } = useAppState();\r\n\r\n  const handleNameChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setName(event.target.value);\r\n  };\r\n\r\n  const handleRoomNameChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setRoomName(event.target.value);\r\n  };\r\n\r\n  const hasUsername = !window.location.search.includes('customIdentity=true') && user?.displayName;\r\n\r\n  return (\r\n    <>\r\n      <Typography variant=\"h5\" className={classes.gutterBottom}>\r\n        Join a Room\r\n      </Typography>\r\n      <Typography variant=\"body1\">\r\n        {hasUsername\r\n          ? \"Enter the name of a room you'd like to join.\"\r\n          : \"Enter your name and the name of a room you'd like to join\"}\r\n      </Typography>\r\n      <form onSubmit={handleSubmit}>\r\n        <div className={classes.inputContainer}>\r\n          {!hasUsername && (\r\n            <div className={classes.textFieldContainer}>\r\n              <InputLabel shrink htmlFor=\"input-user-name\">\r\n                Your Name\r\n              </InputLabel>\r\n              <TextField\r\n                id=\"input-user-name\"\r\n                variant=\"outlined\"\r\n                fullWidth\r\n                size=\"small\"\r\n                value={name}\r\n                onChange={handleNameChange}\r\n              />\r\n            </div>\r\n          )}\r\n          <div className={classes.textFieldContainer}>\r\n            <InputLabel shrink htmlFor=\"input-room-name\">\r\n              Room Name\r\n            </InputLabel>\r\n            <TextField\r\n              autoCapitalize=\"false\"\r\n              id=\"input-room-name\"\r\n              variant=\"outlined\"\r\n              fullWidth\r\n              size=\"small\"\r\n              value={roomName}\r\n              onChange={handleRoomNameChange}\r\n            />\r\n          </div>\r\n        </div>\r\n        <Grid container justify=\"flex-end\">\r\n          <Button\r\n            variant=\"contained\"\r\n            type=\"submit\"\r\n            color=\"primary\"\r\n            disabled={!name || !roomName}\r\n            className={classes.continueButton}\r\n          >\r\n            Continue\r\n          </Button>\r\n        </Grid>\r\n      </form>\r\n    </>\r\n  );\r\n}\r\n","import React, { useState, useEffect, FormEvent } from 'react';\r\nimport DeviceSelectionScreen from './DeviceSelectionScreen/DeviceSelectionScreen';\r\nimport IntroContainer from '../IntroContainer/IntroContainer';\r\nimport MediaErrorSnackbar from './MediaErrorSnackbar/MediaErrorSnackbar';\r\nimport PreflightTest from './PreflightTest/PreflightTest';\r\nimport RoomNameScreen from './RoomNameScreen/RoomNameScreen';\r\nimport { useAppState } from '../../state';\r\nimport { useParams } from 'react-router-dom';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport Video from 'twilio-video';\r\n\r\nexport enum Steps {\r\n  roomNameStep,\r\n  deviceSelectionStep,\r\n}\r\n\r\nexport default function PreJoinScreens() {\r\n  const { user } = useAppState();\r\n  const { getAudioAndVideoTracks } = useVideoContext();\r\n  const { URLRoomName } = useParams();\r\n  const [step, setStep] = useState(Steps.roomNameStep);\r\n\r\n  const [name, setName] = useState<string>(user?.displayName || '');\r\n  const [roomName, setRoomName] = useState<string>('');\r\n\r\n  const [mediaError, setMediaError] = useState<Error>();\r\n\r\n  useEffect(() => {\r\n    if (URLRoomName) {\r\n      setRoomName(URLRoomName);\r\n      if (user?.displayName) {\r\n        setStep(Steps.deviceSelectionStep);\r\n      }\r\n    }\r\n  }, [user, URLRoomName]);\r\n\r\n  useEffect(() => {\r\n    if (step === Steps.deviceSelectionStep && !mediaError) {\r\n      getAudioAndVideoTracks().catch(error => {\r\n        console.log('Error acquiring local media:');\r\n        console.dir(error);\r\n        setMediaError(error);\r\n      });\r\n    }\r\n  }, [getAudioAndVideoTracks, step, mediaError]);\r\n\r\n  const handleSubmit = (event: FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    // If this app is deployed as a twilio function, don't change the URL because routing isn't supported.\r\n    if (!window.location.origin.includes('twil.io')) {\r\n      window.history.replaceState(null, '', window.encodeURI(`/videocall2/room/${roomName}${window.location.search || ''}`));\r\n    }\r\n    setStep(Steps.deviceSelectionStep);\r\n  };\r\n\r\n  const SubContent = (\r\n    <>\r\n      {Video.testPreflight && <PreflightTest />}\r\n      <MediaErrorSnackbar error={mediaError} />\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <IntroContainer subContent={step === Steps.deviceSelectionStep && SubContent}>\r\n      {step === Steps.roomNameStep && (\r\n        <RoomNameScreen\r\n          name={name}\r\n          roomName={roomName}\r\n          setName={setName}\r\n          setRoomName={setRoomName}\r\n          handleSubmit={handleSubmit}\r\n        />\r\n      )}\r\n\r\n      {step === Steps.deviceSelectionStep && (\r\n        <DeviceSelectionScreen name={name} roomName={roomName} setStep={setStep} />\r\n      )}\r\n    </IntroContainer>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport Snackbar from '../Snackbar/Snackbar';\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\n\r\nexport default function ReconnectingNotification() {\r\n  const roomState = useRoomState();\r\n\r\n  return (\r\n    <Snackbar\r\n      variant=\"error\"\r\n      headline=\"Connection Lost:\"\r\n      message=\"Reconnecting to room...\"\r\n      open={roomState === 'reconnecting'}\r\n    />\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport { Participant } from 'twilio-video';\r\nimport useParticipantNetworkQualityLevel from '../../hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel';\r\n\r\nconst Container = styled('div')({\r\n  display: 'flex',\r\n  alignItems: 'flex-end',\r\n  '& div': {\r\n    width: '2px',\r\n    marginRight: '1px',\r\n    '&:not(:last-child)': {\r\n      borderRight: 'none',\r\n    },\r\n  },\r\n});\r\n\r\nconst STEP = 3;\r\nconst BARS_ARRAY = [0, 1, 2, 3, 4];\r\n\r\nexport default function NetworkQualityLevel({ participant }: { participant: Participant }) {\r\n  const networkQualityLevel = useParticipantNetworkQualityLevel(participant);\r\n\r\n  if (networkQualityLevel === null) return null;\r\n\r\n  return (\r\n    <Container>\r\n      {BARS_ARRAY.map(level => (\r\n        <div\r\n          key={level}\r\n          style={{\r\n            height: `${STEP * (level + 1)}px`,\r\n            background: networkQualityLevel > level ? 'white' : 'rgba(255, 255, 255, 0.2)',\r\n          }}\r\n        />\r\n      ))}\r\n    </Container>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { Participant } from 'twilio-video';\r\n\r\nexport default function useParticipantNetworkQualityLevel(participant: Participant) {\r\n  const [networkQualityLevel, setNetworkQualityLevel] = useState(participant.networkQualityLevel);\r\n\r\n  useEffect(() => {\r\n    const handleNewtorkQualityLevelChange = (newNetworkQualityLevel: number) =>\r\n      setNetworkQualityLevel(newNetworkQualityLevel);\r\n\r\n    setNetworkQualityLevel(participant.networkQualityLevel);\r\n    participant.on('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\r\n    return () => {\r\n      participant.off('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\r\n    };\r\n  }, [participant]);\r\n\r\n  return networkQualityLevel;\r\n}\r\n","import React from 'react';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport SvgIcon from '@material-ui/core/SvgIcon';\r\n\r\nexport default function PinIcon() {\r\n  return (\r\n    <Tooltip title=\"Participant is pinned. Click to un-pin.\" placement=\"top\">\r\n      <SvgIcon\r\n        style={{ float: 'right', background: 'rgba(0, 0, 0, 0.5)', padding: '0.1em', boxSizing: 'content-box' }}\r\n        width=\"26\"\r\n        height=\"26\"\r\n        viewBox=\"0 0 26 26\"\r\n      >\r\n        <path\r\n          fill=\"#FFF\"\r\n          fillRule=\"evenodd\"\r\n          strokeWidth=\"0\"\r\n          d=\"M15.808 4.489c.208-.207.544-.207.75 0l4.953 4.952c.207.207.207.543 0 .75l-1.415 1.415c-.207.208-.543.208-.75 0l-.333-.333-3.007 3.007v2.611c0 .113-.035.222-.1.312l-.055.063-1.06 1.062c-.208.207-.544.207-.751 0l-2.809-2.81-5.992 5.993c-.207.207-.543.207-.75 0-.184-.184-.205-.47-.062-.677l.062-.073 5.991-5.993-2.808-2.808c-.184-.184-.204-.47-.061-.677l.061-.073 1.062-1.061c.1-.1.234-.156.375-.156h2.61l3.007-3.007-.332-.332c-.185-.184-.205-.47-.062-.677l.062-.073zm.376 1.125l-.666.664.333.333c.185.184.205.47.062.677l-.062.074-3.537 3.537c-.1.1-.234.155-.375.155h-2.61l-.531.531 2.803 2.803.005.006.005.005 2.804 2.803.53-.531v-2.61c0-.112.036-.221.102-.311l.054-.064 3.537-3.537c.208-.208.544-.208.75 0l.333.332.664-.666-4.201-4.201z\"\r\n        />\r\n      </SvgIcon>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalVideoTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\ntype TrackType = RemoteVideoTrack | LocalVideoTrack | undefined | null;\r\n\r\n// The 'switchedOff' event is emitted when there is not enough bandwidth to support\r\n// a track. See: https://www.twilio.com/docs/video/tutorials/using-bandwidth-profile-api#understanding-track-switch-offs\r\n\r\nexport default function useIsTrackSwitchedOff(track: TrackType) {\r\n  const [isSwitchedOff, setIsSwitchedOff] = useState(track && track.isSwitchedOff);\r\n\r\n  useEffect(() => {\r\n    // Reset the value if the 'track' variable changes\r\n    setIsSwitchedOff(track && track.isSwitchedOff);\r\n\r\n    if (track) {\r\n      const handleSwitchedOff = () => setIsSwitchedOff(true);\r\n      const handleSwitchedOn = () => setIsSwitchedOff(false);\r\n      track.on('switchedOff', handleSwitchedOff);\r\n      track.on('switchedOn', handleSwitchedOn);\r\n      return () => {\r\n        track.off('switchedOff', handleSwitchedOff);\r\n        track.off('switchedOn', handleSwitchedOn);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return !!isSwitchedOff;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalTrackPublication, Participant, RemoteTrackPublication } from 'twilio-video';\r\n\r\ntype TrackPublication = LocalTrackPublication | RemoteTrackPublication;\r\n\r\nexport default function usePublications(participant: Participant) {\r\n  const [publications, setPublications] = useState<TrackPublication[]>([]);\r\n\r\n  useEffect(() => {\r\n    // Reset the publications when the 'participant' variable changes.\r\n    setPublications(Array.from(participant.tracks.values()) as TrackPublication[]);\r\n\r\n    const publicationAdded = (publication: TrackPublication) =>\r\n      setPublications(prevPublications => [...prevPublications, publication]);\r\n    const publicationRemoved = (publication: TrackPublication) =>\r\n      setPublications(prevPublications => prevPublications.filter(p => p !== publication));\r\n\r\n    participant.on('trackPublished', publicationAdded);\r\n    participant.on('trackUnpublished', publicationRemoved);\r\n    return () => {\r\n      participant.off('trackPublished', publicationAdded);\r\n      participant.off('trackUnpublished', publicationRemoved);\r\n    };\r\n  }, [participant]);\r\n\r\n  return publications;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalTrackPublication, RemoteTrackPublication } from 'twilio-video';\r\n\r\nexport default function useTrack(publication: LocalTrackPublication | RemoteTrackPublication | undefined) {\r\n  const [track, setTrack] = useState(publication && publication.track);\r\n\r\n  useEffect(() => {\r\n    // Reset the track when the 'publication' variable changes.\r\n    setTrack(publication && publication.track);\r\n\r\n    if (publication) {\r\n      const removeTrack = () => setTrack(null);\r\n\r\n      publication.on('subscribed', setTrack);\r\n      publication.on('unsubscribed', removeTrack);\r\n      return () => {\r\n        publication.off('subscribed', setTrack);\r\n        publication.off('unsubscribed', removeTrack);\r\n      };\r\n    }\r\n  }, [publication]);\r\n\r\n  return track;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { Participant } from 'twilio-video';\r\n\r\nexport default function useParticipantIsReconnecting(participant: Participant) {\r\n  const [isReconnecting, setIsReconnecting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleReconnecting = () => setIsReconnecting(true);\r\n    const handleReconnected = () => setIsReconnecting(false);\r\n\r\n    handleReconnected(); // Reset state when there is a new participant\r\n\r\n    participant.on('reconnecting', handleReconnecting);\r\n    participant.on('reconnected', handleReconnected);\r\n    return () => {\r\n      participant.off('reconnecting', handleReconnecting);\r\n      participant.off('reconnected', handleReconnected);\r\n    };\r\n  }, [participant]);\r\n\r\n  return isReconnecting;\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport { LocalAudioTrack, LocalVideoTrack, Participant, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\nimport AudioLevelIndicator from '../AudioLevelIndicator/AudioLevelIndicator';\r\nimport AvatarIcon from '../../icons/AvatarIcon';\r\nimport NetworkQualityLevel from '../NetworkQualityLevel/NetworkQualityLevel';\r\nimport PinIcon from './PinIcon/PinIcon';\r\nimport ScreenShareIcon from '../../icons/ScreenShareIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\nimport useParticipantIsReconnecting from '../../hooks/useParticipantIsReconnecting/useParticipantIsReconnecting';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      position: 'relative',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      height: 0,\r\n      overflow: 'hidden',\r\n      marginBottom: '2em',\r\n      '& video': {\r\n        filter: 'none',\r\n        objectFit: 'contain !important',\r\n      },\r\n      borderRadius: '4px',\r\n      border: `${theme.participantBorderWidth}px solid rgb(245, 248, 255)`,\r\n      paddingTop: `calc(${(9 / 16) * 100}% - ${theme.participantBorderWidth}px)`,\r\n      background: 'black',\r\n      [theme.breakpoints.down('sm')]: {\r\n        height: theme.sidebarMobileHeight,\r\n        width: `${(theme.sidebarMobileHeight * 16) / 9}px`,\r\n        marginRight: '8px',\r\n        marginBottom: '0',\r\n        fontSize: '10px',\r\n        paddingTop: `${theme.sidebarMobileHeight - 2}px`,\r\n      },\r\n    },\r\n    innerContainer: {\r\n      position: 'absolute',\r\n      top: 0,\r\n      left: 0,\r\n      width: '100%',\r\n      height: '100%',\r\n    },\r\n    infoContainer: {\r\n      position: 'absolute',\r\n      zIndex: 2,\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      justifyContent: 'space-between',\r\n      height: '100%',\r\n      width: '100%',\r\n      background: 'transparent',\r\n      top: 0,\r\n    },\r\n    avatarContainer: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      background: 'black',\r\n      position: 'absolute',\r\n      top: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      left: 0,\r\n      zIndex: 1,\r\n      [theme.breakpoints.down('sm')]: {\r\n        '& svg': {\r\n          transform: 'scale(0.7)',\r\n        },\r\n      },\r\n    },\r\n    reconnectingContainer: {\r\n      position: 'absolute',\r\n      top: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      left: 0,\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      background: 'rgba(40, 42, 43, 0.75)',\r\n      zIndex: 1,\r\n    },\r\n    screenShareIconContainer: {\r\n      background: 'rgba(0, 0, 0, 0.5)',\r\n      padding: '0.18em 0.3em',\r\n      marginRight: '0.3em',\r\n      display: 'flex',\r\n      '& path': {\r\n        fill: 'white',\r\n      },\r\n    },\r\n    identity: {\r\n      background: 'rgba(0, 0, 0, 0.5)',\r\n      color: 'white',\r\n      padding: '0.18em 0.3em',\r\n      margin: 0,\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n    },\r\n    infoRowBottom: {\r\n      display: 'flex',\r\n      justifyContent: 'space-between',\r\n      position: 'absolute',\r\n      bottom: 0,\r\n      left: 0,\r\n    },\r\n    networkQualityContainer: {\r\n      width: '28px',\r\n      height: '28px',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      background: 'rgba(0, 0, 0, 0.5)',\r\n    },\r\n    typeography: {\r\n      color: 'white',\r\n      [theme.breakpoints.down('sm')]: {\r\n        fontSize: '0.75rem',\r\n      },\r\n    },\r\n    hideParticipant: {\r\n      display: 'none',\r\n    },\r\n    cursorPointer: {\r\n      cursor: 'pointer',\r\n    },\r\n  })\r\n);\r\n\r\ninterface ParticipantInfoProps {\r\n  participant: Participant;\r\n  children: React.ReactNode;\r\n  onClick?: () => void;\r\n  isSelected?: boolean;\r\n  isLocalParticipant?: boolean;\r\n  hideParticipant?: boolean;\r\n}\r\n\r\nexport default function ParticipantInfo({\r\n  participant,\r\n  onClick,\r\n  isSelected,\r\n  children,\r\n  isLocalParticipant,\r\n  hideParticipant,\r\n}: ParticipantInfoProps) {\r\n  const publications = usePublications(participant);\r\n\r\n  const audioPublication = publications.find(p => p.kind === 'audio');\r\n  const videoPublication = publications.find(p => p.trackName.includes('camera'));\r\n\r\n  const isVideoEnabled = Boolean(videoPublication);\r\n  const isScreenShareEnabled = publications.find(p => p.trackName.includes('screen'));\r\n\r\n  const videoTrack = useTrack(videoPublication);\r\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\r\n\r\n  const audioTrack = useTrack(audioPublication) as LocalAudioTrack | RemoteAudioTrack | undefined;\r\n  const isParticipantReconnecting = useParticipantIsReconnecting(participant);\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div\r\n      className={clsx(classes.container, {\r\n        [classes.hideParticipant]: hideParticipant,\r\n        [classes.cursorPointer]: Boolean(onClick),\r\n      })}\r\n      onClick={onClick}\r\n      data-cy-participant={participant.identity}\r\n    >\r\n      <div className={classes.infoContainer}>\r\n        <div className={classes.networkQualityContainer}>\r\n          <NetworkQualityLevel participant={participant} />\r\n        </div>\r\n        <div className={classes.infoRowBottom}>\r\n          {isScreenShareEnabled && (\r\n            <span className={classes.screenShareIconContainer}>\r\n              <ScreenShareIcon />\r\n            </span>\r\n          )}\r\n          <span className={classes.identity}>\r\n            <AudioLevelIndicator audioTrack={audioTrack} />\r\n            <Typography variant=\"body1\" className={classes.typeography} component=\"span\">\r\n              {participant.identity}\r\n              {isLocalParticipant && ' (You)'}\r\n            </Typography>\r\n          </span>\r\n        </div>\r\n        <div>{isSelected && <PinIcon />}</div>\r\n      </div>\r\n      <div className={classes.innerContainer}>\r\n        {(!isVideoEnabled || isVideoSwitchedOff) && (\r\n          <div className={classes.avatarContainer}>\r\n            <AvatarIcon />\r\n          </div>\r\n        )}\r\n        {isParticipantReconnecting && (\r\n          <div className={classes.reconnectingContainer}>\r\n            <Typography variant=\"body1\" className={classes.typeography}>\r\n              Reconnecting...\r\n            </Typography>\r\n          </div>\r\n        )}\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useRef } from 'react';\r\nimport { AudioTrack as IAudioTrack } from 'twilio-video';\r\nimport { useAppState } from '../../state';\r\n\r\ninterface AudioTrackProps {\r\n  track: IAudioTrack;\r\n}\r\n\r\nexport default function AudioTrack({ track }: AudioTrackProps) {\r\n  const { activeSinkId } = useAppState();\r\n  const audioEl = useRef<HTMLAudioElement>();\r\n\r\n  useEffect(() => {\r\n    audioEl.current = track.attach();\r\n    audioEl.current.setAttribute('data-cy-audio-track-name', track.name);\r\n    document.body.appendChild(audioEl.current);\r\n    return () => track.detach().forEach(el => el.remove());\r\n  }, [track]);\r\n\r\n  useEffect(() => {\r\n    audioEl.current?.setSinkId?.(activeSinkId);\r\n  }, [activeSinkId]);\r\n\r\n  return null;\r\n}\r\n","import React from 'react';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\nimport AudioTrack from '../AudioTrack/AudioTrack';\r\nimport VideoTrack from '../VideoTrack/VideoTrack';\r\n\r\nimport { IVideoTrack } from '../../types';\r\nimport {\r\n  AudioTrack as IAudioTrack,\r\n  LocalTrackPublication,\r\n  Participant,\r\n  RemoteTrackPublication,\r\n  Track,\r\n} from 'twilio-video';\r\n\r\ninterface PublicationProps {\r\n  publication: LocalTrackPublication | RemoteTrackPublication;\r\n  participant: Participant;\r\n  isLocalParticipant?: boolean;\r\n  videoOnly?: boolean;\r\n  videoPriority?: Track.Priority | null;\r\n}\r\n\r\nexport default function Publication({ publication, isLocalParticipant, videoOnly, videoPriority }: PublicationProps) {\r\n  const track = useTrack(publication);\r\n\r\n  if (!track) return null;\r\n\r\n  switch (track.kind) {\r\n    case 'video':\r\n      return (\r\n        <VideoTrack\r\n          track={track as IVideoTrack}\r\n          priority={videoPriority}\r\n          isLocal={track.name.includes('camera') && isLocalParticipant}\r\n        />\r\n      );\r\n    case 'audio':\r\n      return videoOnly ? null : <AudioTrack track={track as IAudioTrack} />;\r\n    default:\r\n      return null;\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { Participant, Track } from 'twilio-video';\r\nimport Publication from '../Publication/Publication';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\n\r\ninterface ParticipantTracksProps {\r\n  participant: Participant;\r\n  videoOnly?: boolean;\r\n  enableScreenShare?: boolean;\r\n  videoPriority?: Track.Priority | null;\r\n  isLocalParticipant?: boolean;\r\n}\r\n\r\n/*\r\n *  The object model for the Room object (found here: https://www.twilio.com/docs/video/migrating-1x-2x#object-model) shows\r\n *  that Participant objects have TrackPublications, and TrackPublication objects have Tracks.\r\n *\r\n *  The React components in this application follow the same pattern. This ParticipantTracks component renders Publications,\r\n *  and the Publication component renders Tracks.\r\n */\r\n\r\nexport default function ParticipantTracks({\r\n  participant,\r\n  videoOnly,\r\n  enableScreenShare,\r\n  videoPriority,\r\n  isLocalParticipant,\r\n}: ParticipantTracksProps) {\r\n  const publications = usePublications(participant);\r\n\r\n  let filteredPublications;\r\n\r\n  if (enableScreenShare && publications.some(p => p.trackName.includes('screen'))) {\r\n    filteredPublications = publications.filter(p => !p.trackName.includes('camera'));\r\n  } else {\r\n    filteredPublications = publications.filter(p => !p.trackName.includes('screen'));\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {filteredPublications.map(publication => (\r\n        <Publication\r\n          key={publication.kind}\r\n          publication={publication}\r\n          participant={participant}\r\n          isLocalParticipant={isLocalParticipant}\r\n          videoOnly={videoOnly}\r\n          videoPriority={videoPriority}\r\n        />\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ParticipantInfo from '../ParticipantInfo/ParticipantInfo';\r\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\r\nimport { Participant as IParticipant } from 'twilio-video';\r\n\r\ninterface ParticipantProps {\r\n  participant: IParticipant;\r\n  videoOnly?: boolean;\r\n  enableScreenShare?: boolean;\r\n  onClick?: () => void;\r\n  isSelected?: boolean;\r\n  isDominantSpeaker?: boolean;\r\n  isLocalParticipant?: boolean;\r\n  hideParticipant?: boolean;\r\n}\r\n\r\nexport default function Participant({\r\n  participant,\r\n  videoOnly,\r\n  enableScreenShare,\r\n  onClick,\r\n  isSelected,\r\n  isLocalParticipant,\r\n  hideParticipant,\r\n}: ParticipantProps) {\r\n  return (\r\n    <ParticipantInfo\r\n      participant={participant}\r\n      onClick={onClick}\r\n      isSelected={isSelected}\r\n      isLocalParticipant={isLocalParticipant}\r\n      hideParticipant={hideParticipant}\r\n    >\r\n      <ParticipantTracks\r\n        participant={participant}\r\n        videoOnly={videoOnly}\r\n        enableScreenShare={enableScreenShare}\r\n        isLocalParticipant={isLocalParticipant}\r\n      />\r\n    </ParticipantInfo>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\nimport { RemoteParticipant } from 'twilio-video';\r\n\r\nexport default function useDominantSpeaker() {\r\n  const { room } = useVideoContext();\r\n  const [dominantSpeaker, setDominantSpeaker] = useState(room?.dominantSpeaker ?? null);\r\n\r\n  useEffect(() => {\r\n    if (room) {\r\n      // Sometimes, the 'dominantSpeakerChanged' event can emit 'null', which means that\r\n      // there is no dominant speaker. If we change the main participant when 'null' is\r\n      // emitted, the effect can be jarring to the user. Here we ignore any 'null' values\r\n      // and continue to display the previous dominant speaker as the main participant.\r\n      const handleDominantSpeakerChanged = (newDominantSpeaker: RemoteParticipant) => {\r\n        if (newDominantSpeaker !== null) {\r\n          setDominantSpeaker(newDominantSpeaker);\r\n        }\r\n      };\r\n\r\n      // Since 'null' values are ignored, we will need to listen for the 'participantDisconnected'\r\n      // event, so we can set the dominantSpeaker to 'null' when they disconnect.\r\n      const handleParticipantDisconnected = (participant: RemoteParticipant) => {\r\n        setDominantSpeaker(prevDominantSpeaker => {\r\n          return prevDominantSpeaker === participant ? null : prevDominantSpeaker;\r\n        });\r\n      };\r\n\r\n      room.on('dominantSpeakerChanged', handleDominantSpeakerChanged);\r\n      room.on('participantDisconnected', handleParticipantDisconnected);\r\n      return () => {\r\n        room.off('dominantSpeakerChanged', handleDominantSpeakerChanged);\r\n        room.off('participantDisconnected', handleParticipantDisconnected);\r\n      };\r\n    }\r\n  }, [room]);\r\n\r\n  return dominantSpeaker;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { RemoteParticipant } from 'twilio-video';\r\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useParticipants() {\r\n  const { room } = useVideoContext();\r\n  const dominantSpeaker = useDominantSpeaker();\r\n  const [participants, setParticipants] = useState(Array.from(room?.participants.values() ?? []));\r\n\r\n  // When the dominant speaker changes, they are moved to the front of the participants array.\r\n  // This means that the most recent dominant speakers will always be near the top of the\r\n  // ParticipantStrip component.\r\n  useEffect(() => {\r\n    if (dominantSpeaker) {\r\n      setParticipants(prevParticipants => [\r\n        dominantSpeaker,\r\n        ...prevParticipants.filter(participant => participant !== dominantSpeaker),\r\n      ]);\r\n    }\r\n  }, [dominantSpeaker]);\r\n\r\n  useEffect(() => {\r\n    if (room) {\r\n      const participantConnected = (participant: RemoteParticipant) =>\r\n        setParticipants(prevParticipants => [...prevParticipants, participant]);\r\n      const participantDisconnected = (participant: RemoteParticipant) =>\r\n        setParticipants(prevParticipants => prevParticipants.filter(p => p !== participant));\r\n      room.on('participantConnected', participantConnected);\r\n      room.on('participantDisconnected', participantDisconnected);\r\n      return () => {\r\n        room.off('participantConnected', participantConnected);\r\n        room.off('participantDisconnected', participantDisconnected);\r\n      };\r\n    }\r\n  }, [room]);\r\n\r\n  return participants;\r\n}\r\n","import useVideoContext from '../useVideoContext/useVideoContext';\r\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\r\nimport useParticipants from '../useParticipants/useParticipants';\r\nimport useScreenShareParticipant from '../useScreenShareParticipant/useScreenShareParticipant';\r\nimport useSelectedParticipant from '../../components/VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\n\r\nexport default function useMainParticipant() {\r\n  const [selectedParticipant] = useSelectedParticipant();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const dominantSpeaker = useDominantSpeaker();\r\n  const participants = useParticipants();\r\n  const { room } = useVideoContext();\r\n  const localParticipant = room?.localParticipant;\r\n  const remoteScreenShareParticipant = screenShareParticipant !== localParticipant ? screenShareParticipant : null;\r\n\r\n  // The participant that is returned is displayed in the main video area. Changing the order of the following\r\n  // variables will change the how the main speaker is determined.\r\n  return selectedParticipant || remoteScreenShareParticipant || dominantSpeaker || participants[0] || localParticipant;\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport Participant from '../Participant/Participant';\r\nimport { makeStyles, createStyles, Theme } from '@material-ui/core/styles';\r\nimport useMainParticipant from '../../hooks/useMainParticipant/useMainParticipant';\r\nimport useParticipants from '../../hooks/useParticipants/useParticipants';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport useSelectedParticipant from '../VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\nimport useScreenShareParticipant from '../../hooks/useScreenShareParticipant/useScreenShareParticipant';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      overflowY: 'auto',\r\n      background: 'rgb(79, 83, 85)',\r\n      gridArea: '1 / 2 / 1 / 3',\r\n      zIndex: 5,\r\n      [theme.breakpoints.down('sm')]: {\r\n        gridArea: '2 / 1 / 3 / 3',\r\n        overflowY: 'initial',\r\n        overflowX: 'auto',\r\n        display: 'flex',\r\n      },\r\n    },\r\n    transparentBackground: {\r\n      background: 'transparent',\r\n    },\r\n    scrollContainer: {\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n    },\r\n    innerScrollContainer: {\r\n      width: `calc(${theme.sidebarWidth}px - 4em)`,\r\n      padding: '2em 0',\r\n      [theme.breakpoints.down('sm')]: {\r\n        width: 'auto',\r\n        padding: `${theme.sidebarMobilePadding}px`,\r\n        display: 'flex',\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ParticipantList() {\r\n  const classes = useStyles();\r\n  const { room } = useVideoContext();\r\n  const localParticipant = room!.localParticipant;\r\n  const participants = useParticipants();\r\n  const [selectedParticipant, setSelectedParticipant] = useSelectedParticipant();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const mainParticipant = useMainParticipant();\r\n  const isRemoteParticipantScreenSharing = screenShareParticipant && screenShareParticipant !== localParticipant;\r\n\r\n  if (participants.length === 0) return null; // Don't render this component if there are no remote participants.\r\n\r\n  return (\r\n    <aside\r\n      className={clsx(classes.container, {\r\n        [classes.transparentBackground]: !isRemoteParticipantScreenSharing,\r\n      })}\r\n    >\r\n      <div className={classes.scrollContainer}>\r\n        <div className={classes.innerScrollContainer}>\r\n          <Participant participant={localParticipant} isLocalParticipant={true} />\r\n          {participants.map(participant => {\r\n            const isSelected = participant === selectedParticipant;\r\n            const hideParticipant =\r\n              participant === mainParticipant && participant !== screenShareParticipant && !isSelected;\r\n            return (\r\n              <Participant\r\n                key={participant.sid}\r\n                participant={participant}\r\n                isSelected={participant === selectedParticipant}\r\n                onClick={() => setSelectedParticipant(participant)}\r\n                hideParticipant={hideParticipant}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </aside>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles, Theme } from '@material-ui/core/styles';\r\nimport { LocalAudioTrack, LocalVideoTrack, Participant, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\nimport AvatarIcon from '../../icons/AvatarIcon';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useScreenShareParticipant from '../../hooks/useScreenShareParticipant/useScreenShareParticipant';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport useParticipantIsReconnecting from '../../hooks/useParticipantIsReconnecting/useParticipantIsReconnecting';\r\nimport AudioLevelIndicator from '../AudioLevelIndicator/AudioLevelIndicator';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  container: {\r\n    position: 'relative',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n  identity: {\r\n    background: 'rgba(0, 0, 0, 0.5)',\r\n    color: 'white',\r\n    padding: '0.1em 0.3em 0.1em 0',\r\n    fontSize: '1.2em',\r\n    display: 'inline-flex',\r\n    '& svg': {\r\n      marginLeft: '0.3em',\r\n    },\r\n  },\r\n  infoContainer: {\r\n    position: 'absolute',\r\n    zIndex: 2,\r\n    height: '100%',\r\n    width: '100%',\r\n  },\r\n  reconnectingContainer: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    background: 'rgba(40, 42, 43, 0.75)',\r\n    zIndex: 1,\r\n  },\r\n  fullWidth: {\r\n    gridArea: '1 / 1 / 2 / 3',\r\n    [theme.breakpoints.down('sm')]: {\r\n      gridArea: '1 / 1 / 3 / 3',\r\n    },\r\n  },\r\n  avatarContainer: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    background: 'black',\r\n    position: 'absolute',\r\n    top: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    left: 0,\r\n    zIndex: 1,\r\n    '& svg': {\r\n      transform: 'scale(2)',\r\n    },\r\n  },\r\n}));\r\n\r\ninterface MainParticipantInfoProps {\r\n  participant: Participant;\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport default function MainParticipantInfo({ participant, children }: MainParticipantInfoProps) {\r\n  const classes = useStyles();\r\n  const { room } = useVideoContext();\r\n  const localParticipant = room!.localParticipant;\r\n  const isLocal = localParticipant === participant;\r\n\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const isRemoteParticipantScreenSharing = screenShareParticipant && screenShareParticipant !== localParticipant;\r\n\r\n  const publications = usePublications(participant);\r\n  const videoPublication = publications.find(p => p.trackName.includes('camera'));\r\n  const screenSharePublication = publications.find(p => p.trackName.includes('screen'));\r\n\r\n  const videoTrack = useTrack(screenSharePublication || videoPublication);\r\n  const isVideoEnabled = Boolean(videoTrack);\r\n\r\n  const audioPublication = publications.find(p => p.kind === 'audio');\r\n  const audioTrack = useTrack(audioPublication) as LocalAudioTrack | RemoteAudioTrack | undefined;\r\n\r\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\r\n  const isParticipantReconnecting = useParticipantIsReconnecting(participant);\r\n\r\n  return (\r\n    <div\r\n      data-cy-main-participant\r\n      data-cy-participant={participant.identity}\r\n      className={clsx(classes.container, {\r\n        [classes.fullWidth]: !isRemoteParticipantScreenSharing,\r\n      })}\r\n    >\r\n      <div className={classes.infoContainer}>\r\n        <div className={classes.identity}>\r\n          <AudioLevelIndicator audioTrack={audioTrack} />\r\n          <Typography variant=\"body1\" color=\"inherit\">\r\n            {participant.identity}\r\n            {isLocal && ' (You)'}\r\n            {screenSharePublication && ' - Screen'}\r\n          </Typography>\r\n        </div>\r\n      </div>\r\n      {(!isVideoEnabled || isVideoSwitchedOff) && (\r\n        <div className={classes.avatarContainer}>\r\n          <AvatarIcon />\r\n        </div>\r\n      )}\r\n      {isParticipantReconnecting && (\r\n        <div className={classes.reconnectingContainer}>\r\n          <Typography variant=\"body1\" style={{ color: 'white' }}>\r\n            Reconnecting...\r\n          </Typography>\r\n        </div>\r\n      )}\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import MainParticipantInfo from '../MainParticipantInfo/MainParticipantInfo';\r\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\r\nimport React from 'react';\r\nimport useMainParticipant from '../../hooks/useMainParticipant/useMainParticipant';\r\nimport useSelectedParticipant from '../VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\nimport useScreenShareParticipant from '../../hooks/useScreenShareParticipant/useScreenShareParticipant';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function MainParticipant() {\r\n  const mainParticipant = useMainParticipant();\r\n  const { room } = useVideoContext();\r\n  const localParticipant = room!.localParticipant;\r\n  const [selectedParticipant] = useSelectedParticipant();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n\r\n  const videoPriority =\r\n    (mainParticipant === selectedParticipant || mainParticipant === screenShareParticipant) &&\r\n    mainParticipant !== localParticipant\r\n      ? 'high'\r\n      : null;\r\n\r\n  return (\r\n    /* audio is disabled for this participant component because this participant's audio \r\n       is already being rendered in the <ParticipantStrip /> component.  */\r\n    <MainParticipantInfo participant={mainParticipant}>\r\n      <ParticipantTracks\r\n        participant={mainParticipant}\r\n        videoOnly\r\n        enableScreenShare={mainParticipant !== localParticipant}\r\n        videoPriority={videoPriority}\r\n        isLocalParticipant={mainParticipant === localParticipant}\r\n      />\r\n    </MainParticipantInfo>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ParticipantList from '../ParticipantList/ParticipantList';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport MainParticipant from '../MainParticipant/MainParticipant';\r\n\r\nconst Container = styled('div')(({ theme }) => {\r\n  const totalMobileSidebarHeight = `${theme.sidebarMobileHeight +\r\n    theme.sidebarMobilePadding * 2 +\r\n    theme.participantBorderWidth}px`;\r\n\r\n  return {\r\n    position: 'relative',\r\n    height: '100%',\r\n    display: 'grid',\r\n    gridTemplateColumns: `1fr ${theme.sidebarWidth}px`,\r\n    gridTemplateRows: '100%',\r\n    [theme.breakpoints.down('sm')]: {\r\n      gridTemplateColumns: `100%`,\r\n      gridTemplateRows: `calc(100% - ${totalMobileSidebarHeight}) ${totalMobileSidebarHeight}`,\r\n    },\r\n  };\r\n});\r\n\r\nexport default function Room() {\r\n  return (\r\n    <Container>\r\n      <MainParticipant />\r\n      <ParticipantList />\r\n    </Container>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled, Theme } from '@material-ui/core/styles';\r\n\r\nimport MenuBar from './components/MenuBar/MenuBar';\r\nimport MobileTopMenuBar from './components/MobileTopMenuBar/MobileTopMenuBar';\r\nimport PreJoinScreens from './components/PreJoinScreens/PreJoinScreens';\r\nimport ReconnectingNotification from './components/ReconnectingNotification/ReconnectingNotification';\r\nimport Room from './components/Room/Room';\r\n\r\nimport useHeight from './hooks/useHeight/useHeight';\r\nimport useRoomState from './hooks/useRoomState/useRoomState';\r\n\r\nconst Container = styled('div')({\r\n  display: 'grid',\r\n  gridTemplateRows: '1fr auto',\r\n});\r\n\r\nconst Main = styled('main')(({ theme }: { theme: Theme }) => ({\r\n  overflow: 'hidden',\r\n  paddingBottom: `${theme.footerHeight}px`, // Leave some space for the footer\r\n  background: 'black',\r\n  [theme.breakpoints.down('sm')]: {\r\n    paddingBottom: `${theme.mobileFooterHeight + theme.mobileTopBarHeight}px`, // Leave some space for the mobile header and footer\r\n  },\r\n}));\r\n\r\nexport default function App() {\r\n  const roomState = useRoomState();\r\n\r\n  // Here we would like the height of the main container to be the height of the viewport.\r\n  // On some mobile browsers, 'height: 100vh' sets the height equal to that of the screen,\r\n  // not the viewport. This looks bad when the mobile browsers location bar is open.\r\n  // We will dynamically set the height with 'window.innerHeight', which means that this\r\n  // will look good on mobile browsers even after the location bar opens or closes.\r\n  const height = useHeight();\r\n\r\n  return (\r\n    <Container style={{ height }}>\r\n      {roomState === 'disconnected' ? (\r\n        <PreJoinScreens />\r\n      ) : (\r\n        <Main>\r\n          <ReconnectingNotification />\r\n          <MobileTopMenuBar />\r\n          <Room />\r\n          <MenuBar />\r\n        </Main>\r\n      )}\r\n    </Container>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\n\r\nexport default function useHeight() {\r\n  const [height, setHeight] = useState(window.innerHeight * (window.visualViewport?.scale || 1));\r\n\r\n  useEffect(() => {\r\n    const onResize = () => {\r\n      setHeight(window.innerHeight * (window.visualViewport?.scale || 1));\r\n    };\r\n\r\n    window.addEventListener('resize', onResize);\r\n    return () => {\r\n      window.removeEventListener('resize', onResize);\r\n    };\r\n  });\r\n\r\n  return height + 'px';\r\n}\r\n","import React, { PropsWithChildren } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport enhanceMessage from './enhanceMessage';\r\nimport { TwilioError } from 'twilio-video';\r\n\r\ninterface ErrorDialogProps {\r\n  dismissError: Function;\r\n  error: TwilioError | null;\r\n}\r\n\r\nfunction ErrorDialog({ dismissError, error }: PropsWithChildren<ErrorDialogProps>) {\r\n  const { message, code } = error || {};\r\n  const enhancedMessage = enhanceMessage(message, code);\r\n\r\n  return (\r\n    <Dialog open={error !== null} onClose={() => dismissError()} fullWidth={true} maxWidth=\"xs\">\r\n      <DialogTitle>ERROR</DialogTitle>\r\n      <DialogContent>\r\n        <DialogContentText>{enhancedMessage}</DialogContentText>\r\n        {Boolean(code) && (\r\n          <pre>\r\n            <code>Error Code: {code}</code>\r\n          </pre>\r\n        )}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => dismissError()} color=\"primary\" autoFocus>\r\n          OK\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default ErrorDialog;\r\n","// This function is used to provide error messages to the user that are\r\n// different than the error messages provided by the SDK.\r\nexport default function enhanceMessage(message = '', code?: number) {\r\n  switch (code) {\r\n    case 20101: // Invalid token error\r\n      return message + '. Please make sure you are using the correct credentials.';\r\n    default:\r\n      return message;\r\n  }\r\n}\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"desc\", null, \"Created with Sketch.\");\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"filter\", {\n  x: \"-50%\",\n  y: \"-50%\",\n  width: \"200%\",\n  height: \"200%\",\n  filterUnits: \"objectBoundingBox\",\n  id: \"filter-1\"\n}, /*#__PURE__*/React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 1,\n  \"in\": \"SourceAlpha\",\n  result: \"shadowOffsetOuter1\"\n}), /*#__PURE__*/React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  \"in\": \"shadowOffsetOuter1\",\n  result: \"shadowBlurOuter1\"\n}), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.168 0\",\n  \"in\": \"shadowBlurOuter1\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter1\"\n}), /*#__PURE__*/React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 0,\n  \"in\": \"SourceAlpha\",\n  result: \"shadowOffsetOuter2\"\n}), /*#__PURE__*/React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  \"in\": \"shadowOffsetOuter2\",\n  result: \"shadowBlurOuter2\"\n}), /*#__PURE__*/React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.084 0\",\n  \"in\": \"shadowBlurOuter2\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter2\"\n}), /*#__PURE__*/React.createElement(\"feMerge\", null, /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  \"in\": \"shadowMatrixOuter1\"\n}), /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  \"in\": \"shadowMatrixOuter2\"\n}), /*#__PURE__*/React.createElement(\"feMergeNode\", {\n  \"in\": \"SourceGraphic\"\n}))), /*#__PURE__*/React.createElement(\"rect\", {\n  id: \"path-2\",\n  x: 0,\n  y: 0,\n  width: 40,\n  height: 40,\n  rx: 2\n}));\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Google-Button\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"9-PATCH\",\n  transform: \"translate(-608.000000, -160.000000)\"\n}), /*#__PURE__*/React.createElement(\"g\", {\n  id: \"btn_google_light_normal\",\n  transform: \"translate(-1.000000, -1.000000)\"\n}, /*#__PURE__*/React.createElement(\"g\", {\n  id: \"logo_googleg_48dp\",\n  transform: \"translate(15.000000, 15.000000)\"\n}, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M17.64,9.20454545 C17.64,8.56636364 17.5827273,7.95272727 17.4763636,7.36363636 L9,7.36363636 L9,10.845 L13.8436364,10.845 C13.635,11.97 13.0009091,12.9231818 12.0477273,13.5613636 L12.0477273,15.8195455 L14.9563636,15.8195455 C16.6581818,14.2527273 17.64,11.9454545 17.64,9.20454545 L17.64,9.20454545 Z\",\n  id: \"Shape\",\n  fill: \"#4285F4\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9,18 C11.43,18 13.4672727,17.1940909 14.9563636,15.8195455 L12.0477273,13.5613636 C11.2418182,14.1013636 10.2109091,14.4204545 9,14.4204545 C6.65590909,14.4204545 4.67181818,12.8372727 3.96409091,10.71 L0.957272727,10.71 L0.957272727,13.0418182 C2.43818182,15.9831818 5.48181818,18 9,18 L9,18 Z\",\n  id: \"Shape\",\n  fill: \"#34A853\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3.96409091,10.71 C3.78409091,10.17 3.68181818,9.59318182 3.68181818,9 C3.68181818,8.40681818 3.78409091,7.83 3.96409091,7.29 L3.96409091,4.95818182 L0.957272727,4.95818182 C0.347727273,6.17318182 0,7.54772727 0,9 C0,10.4522727 0.347727273,11.8268182 0.957272727,13.0418182 L3.96409091,10.71 L3.96409091,10.71 Z\",\n  id: \"Shape\",\n  fill: \"#FBBC05\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9,3.57954545 C10.3213636,3.57954545 11.5077273,4.03363636 12.4404545,4.92545455 L15.0218182,2.34409091 C13.4631818,0.891818182 11.4259091,0 9,0 C5.48181818,0 2.43818182,2.01681818 0.957272727,4.95818182 L3.96409091,7.29 C4.67181818,5.16272727 6.65590909,3.57954545 9,3.57954545 L9,3.57954545 Z\",\n  id: \"Shape\",\n  fill: \"#EA4335\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M0,0 L18,0 L18,18 L0,18 L0,0 Z\",\n  id: \"Shape\"\n})), /*#__PURE__*/React.createElement(\"g\", {\n  id: \"handles_square\"\n})));\n\nfunction SvgGoogleLogo(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: \"32px\",\n    height: \"32px\",\n    viewBox: \"7 7 32 32\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title === undefined ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, \"btn_google_light_normal_ios\") : title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3, _ref4);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgGoogleLogo);\nexport default __webpack_public_path__ + \"static/media/google-logo.30a4777e.svg\";\nexport { ForwardRef as ReactComponent };","import React, { ChangeEvent, useState, FormEvent } from 'react';\r\nimport { useAppState } from '../../state';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport { ReactComponent as GoogleLogo } from './google-logo.svg';\r\nimport { InputLabel, Theme } from '@material-ui/core';\r\nimport IntroContainer from '../IntroContainer/IntroContainer';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useLocation, useHistory } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  googleButton: {\r\n    background: 'white',\r\n    color: 'rgb(0, 94, 166)',\r\n    borderRadius: '4px',\r\n    border: '2px solid rgb(2, 122, 197)',\r\n    margin: '1.8em 0 0.7em',\r\n    textTransform: 'none',\r\n    boxShadow: 'none',\r\n    padding: '0.3em 1em',\r\n    [theme.breakpoints.down('sm')]: {\r\n      width: '100%',\r\n    },\r\n    '&:hover': {\r\n      background: 'white',\r\n      boxShadow: 'none',\r\n    },\r\n  },\r\n  errorMessage: {\r\n    color: 'red',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    margin: '1em 0 0.2em',\r\n    '& svg': {\r\n      marginRight: '0.4em',\r\n    },\r\n  },\r\n  gutterBottom: {\r\n    marginBottom: '1em',\r\n  },\r\n  passcodeContainer: {\r\n    minHeight: '120px',\r\n  },\r\n  submitButton: {\r\n    [theme.breakpoints.down('sm')]: {\r\n      width: '100%',\r\n    },\r\n  },\r\n}));\r\n\r\nexport default function LoginPage() {\r\n  const classes = useStyles();\r\n  const { signIn, user, isAuthReady } = useAppState();\r\n  const history = useHistory();\r\n  const location = useLocation<{ from: Location }>();\r\n  const [passcode, setPasscode] = useState('');\r\n  const [authError, setAuthError] = useState<Error | null>(null);\r\n\r\n  const isAuthEnabled = Boolean(process.env.REACT_APP_SET_AUTH);\r\n\r\n  const login = () => {\r\n    setAuthError(null);\r\n    signIn?.(passcode)\r\n      .then(() => {\r\n        history.replace(location?.state?.from || { pathname: '/' });\r\n      })\r\n      .catch(err => setAuthError(err));\r\n  };\r\n\r\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    login();\r\n  };\r\n\r\n  if (user || !isAuthEnabled) {\r\n    history.replace('/');\r\n  }\r\n\r\n  if (!isAuthReady) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <IntroContainer>\r\n      {process.env.REACT_APP_SET_AUTH === 'firebase' && (\r\n        <>\r\n          <Typography variant=\"h5\" className={classes.gutterBottom}>\r\n            Sign in to join a room\r\n          </Typography>\r\n          <Typography variant=\"body1\">Sign in using your Twilio Google Account</Typography>\r\n          <Button variant=\"contained\" className={classes.googleButton} onClick={login} startIcon={<GoogleLogo />}>\r\n            Sign in with Google\r\n          </Button>\r\n        </>\r\n      )}\r\n\r\n      {process.env.REACT_APP_SET_AUTH === 'passcode' && (\r\n        <>\r\n          <Typography variant=\"h5\" className={classes.gutterBottom}>\r\n            Enter passcode to join a room\r\n          </Typography>\r\n          <form onSubmit={handleSubmit}>\r\n            <Grid container justify=\"space-between\">\r\n              <div className={classes.passcodeContainer}>\r\n                <InputLabel shrink htmlFor=\"input-passcode\">\r\n                  Passcode\r\n                </InputLabel>\r\n                <TextField\r\n                  id=\"input-passcode\"\r\n                  onChange={(e: ChangeEvent<HTMLInputElement>) => setPasscode(e.target.value)}\r\n                  type=\"password\"\r\n                  variant=\"outlined\"\r\n                  size=\"small\"\r\n                />\r\n                <div>\r\n                  {authError && (\r\n                    <Typography variant=\"caption\" className={classes.errorMessage}>\r\n                      <ErrorOutlineIcon />\r\n                      {authError.message}\r\n                    </Typography>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </Grid>\r\n            <Grid container justify=\"flex-end\">\r\n              <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                type=\"submit\"\r\n                disabled={!passcode.length}\r\n                className={classes.submitButton}\r\n              >\r\n                Submit\r\n              </Button>\r\n            </Grid>\r\n          </form>\r\n        </>\r\n      )}\r\n    </IntroContainer>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\r\nimport { useAppState } from '../../state';\r\n\r\nexport default function PrivateRoute({ children, ...rest }: RouteProps) {\r\n  const { isAuthReady, user } = useAppState();\r\n    \r\n  const renderChildren = user || !process.env.REACT_APP_SET_AUTH;\r\n\r\n  if (!renderChildren && !isAuthReady) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={({ location }) =>\r\n        renderChildren ? (\r\n          children\r\n        ) : (\r\n          <Redirect\r\n            to={{\r\n              pathname: '/login',\r\n              state: { from: location },\r\n            }}\r\n          />\r\n        )\r\n      }\r\n    />\r\n  );\r\n}\r\n","import { createMuiTheme } from '@material-ui/core';\r\n\r\ndeclare module '@material-ui/core/styles/createMuiTheme' {\r\n  interface Theme {\r\n    sidebarWidth: number;\r\n    sidebarMobileHeight: number;\r\n    brand: string;\r\n    footerHeight: number;\r\n    mobileTopBarHeight: number;\r\n    mobileFooterHeight: number;\r\n    sidebarMobilePadding: number;\r\n    participantBorderWidth: number;\r\n  }\r\n\r\n  // allow configuration using `createMuiTheme`\r\n  interface ThemeOptions {\r\n    sidebarWidth?: number;\r\n    sidebarMobileHeight?: number;\r\n    brand: string;\r\n    footerHeight: number;\r\n    mobileTopBarHeight: number;\r\n    mobileFooterHeight: number;\r\n    sidebarMobilePadding: number;\r\n    participantBorderWidth: number;\r\n  }\r\n}\r\n\r\nconst defaultTheme = createMuiTheme();\r\n\r\nexport default createMuiTheme({\r\n  overrides: {\r\n    MuiCssBaseline: {\r\n      '@global': {\r\n        'html, body, #root': {\r\n          height: '100%',\r\n        },\r\n      },\r\n    },\r\n    MuiButton: {\r\n      root: {\r\n        borderRadius: '4px',\r\n        textTransform: 'none',\r\n        color: 'rgb(40, 42, 43)',\r\n        fontSize: '0.9rem',\r\n        transition: defaultTheme.transitions.create(['background-color', 'box-shadow', 'border', 'color'], {\r\n          duration: defaultTheme.transitions.duration.short,\r\n        }),\r\n      },\r\n      text: {\r\n        padding: '6px 14px',\r\n      },\r\n      contained: {\r\n        boxShadow: 'none',\r\n        '&:hover': {\r\n          boxShadow: 'none',\r\n        },\r\n      },\r\n      outlinedPrimary: {\r\n        border: '2px solid #027AC5',\r\n        '&:hover': {\r\n          border: '2px solid rgb(1, 85, 137)',\r\n        },\r\n      },\r\n      startIcon: {\r\n        marginRight: '6px',\r\n      },\r\n    },\r\n    MuiTypography: {\r\n      body1: {\r\n        color: 'rgb(40, 42, 43)',\r\n        fontSize: '0.9rem',\r\n      },\r\n    },\r\n    MuiInputBase: {\r\n      root: {\r\n        fontSize: '0.9rem',\r\n      },\r\n    },\r\n    MuiSelect: {\r\n      root: {\r\n        padding: '0.85em',\r\n      },\r\n    },\r\n    MuiDialogActions: {\r\n      root: {\r\n        padding: '16px',\r\n      },\r\n    },\r\n    MuiTextField: {\r\n      root: {\r\n        color: 'rgb(40, 42, 43)',\r\n      },\r\n    },\r\n    MuiInputLabel: {\r\n      root: {\r\n        color: 'rgb(40, 42, 43)',\r\n        fontSize: '1.1rem',\r\n        marginBottom: '0.2em',\r\n        fontWeight: 500,\r\n      },\r\n    },\r\n    MuiOutlinedInput: {\r\n      notchedOutline: {\r\n        borderColor: 'rgb(136, 140, 142)',\r\n      },\r\n    },\r\n  },\r\n  typography: {\r\n    fontFamily: 'Inter, sans-serif',\r\n  },\r\n  palette: {\r\n    primary: {\r\n      main: '#027AC5',\r\n    },\r\n  },\r\n  brand: '#E22525',\r\n  footerHeight: 72,\r\n  mobileFooterHeight: 56,\r\n  sidebarWidth: 355,\r\n  sidebarMobileHeight: 90,\r\n  sidebarMobilePadding: 8,\r\n  participantBorderWidth: 2,\r\n  mobileTopBarHeight: 52,\r\n});\r\n","import { ConnectOptions } from 'twilio-video';\r\nimport { isMobile, removeUndefineds } from '..';\r\nimport { getResolution } from '../../state/settings/renderDimensions';\r\nimport { useAppState } from '../../state';\r\n\r\nexport default function useConnectionOptions() {\r\n  const { roomType, settings } = useAppState();\r\n\r\n  // See: https://media.twiliocdn.com/sdk/js/video/releases/2.0.0/docs/global.html#ConnectOptions\r\n  // for available connection options.\r\n  const connectionOptions: ConnectOptions = {\r\n    // Bandwidth Profile, Dominant Speaker, and Network Quality\r\n    // features are only available in Small Group or Group Rooms.\r\n    // Please set \"Room Type\" to \"Group\" or \"Small Group\" in your\r\n    // Twilio Console: https://www.twilio.com/console/video/configure\r\n    bandwidthProfile: {\r\n      video: {\r\n        mode: settings.bandwidthProfileMode,\r\n        dominantSpeakerPriority: settings.dominantSpeakerPriority,\r\n        renderDimensions: {\r\n          low: getResolution(settings.renderDimensionLow),\r\n          standard: getResolution(settings.renderDimensionStandard),\r\n          high: getResolution(settings.renderDimensionHigh),\r\n        },\r\n        maxTracks: Number(settings.maxTracks),\r\n      },\r\n    },\r\n    dominantSpeaker: true,\r\n    networkQuality: { local: 1, remote: 1 },\r\n\r\n    // Comment this line if you are playing music.\r\n    maxAudioBitrate: Number(settings.maxAudioBitrate),\r\n\r\n    // VP8 simulcast enables the media server in a Small Group or Group Room\r\n    // to adapt your encoded video quality for each RemoteParticipant based on\r\n    // their individual bandwidth constraints. Simulcast should be disabled if\r\n    // you are using Peer-to-Peer or 'Go' Rooms.\r\n    preferredVideoCodecs: [{ codec: 'VP8', simulcast: roomType !== 'peer-to-peer' && roomType !== 'go' }],\r\n  };\r\n\r\n  // For mobile browsers, limit the maximum incoming video bitrate to 2.5 Mbps.\r\n  if (isMobile && connectionOptions?.bandwidthProfile?.video) {\r\n    connectionOptions!.bandwidthProfile!.video!.maxSubscriptionBitrate = 2500000;\r\n  }\r\n\r\n  // Here we remove any 'undefined' values. The twilio-video SDK will only use defaults\r\n  // when no value is passed for an option. It will throw an error when 'undefined' is passed.\r\n  return removeUndefineds(connectionOptions);\r\n}\r\n","import React from 'react';\r\nimport Video from 'twilio-video';\r\nimport { Container, Link, Typography, Paper, Grid } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    marginTop: '2.5em',\r\n  },\r\n  paper: {\r\n    padding: '1em',\r\n  },\r\n  heading: {\r\n    marginBottom: '0.4em',\r\n  },\r\n});\r\n\r\nexport default function UnsupportedBrowserWarning({ children }: { children: React.ReactElement }) {\r\n  const classes = useStyles();\r\n\r\n  if (!Video.isSupported) {\r\n    return (\r\n      <Container>\r\n        <Grid container justify=\"center\" className={classes.container}>\r\n          <Grid item xs={12} sm={6}>\r\n            <Paper className={classes.paper}>\r\n              <Typography variant=\"h4\" className={classes.heading}>\r\n                Browser or context not supported\r\n              </Typography>\r\n              <Typography>\r\n                Please open this application in one of the{' '}\r\n                <Link\r\n                  href=\"https://www.twilio.com/docs/video/javascript#supported-browsers\"\r\n                  target=\"_blank\"\r\n                  rel=\"noopener\"\r\n                >\r\n                  supported browsers\r\n                </Link>\r\n                .\r\n                <br />\r\n                If you are using a supported browser, please ensure that this app is served over a{' '}\r\n                <Link\r\n                  href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts\"\r\n                  target=\"_blank\"\r\n                  rel=\"noopener\"\r\n                >\r\n                  secure context\r\n                </Link>{' '}\r\n                (e.g. https or localhost).\r\n              </Typography>\r\n            </Paper>\r\n          </Grid>\r\n        </Grid>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return children;\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { CssBaseline } from '@material-ui/core';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\n\r\nimport App from './App';\r\nimport AppStateProvider, { useAppState } from './state';\r\nimport { BrowserRouter as Router, Redirect, Route, Switch } from 'react-router-dom';\r\nimport ErrorDialog from './components/ErrorDialog/ErrorDialog';\r\nimport LoginPage from './components/LoginPage/LoginPage';\r\nimport PrivateRoute from './components/PrivateRoute/PrivateRoute';\r\nimport theme from './theme';\r\nimport './types';\r\nimport { VideoProvider } from './components/VideoProvider';\r\nimport useConnectionOptions from './utils/useConnectionOptions/useConnectionOptions';\r\nimport UnsupportedBrowserWarning from './components/UnsupportedBrowserWarning/UnsupportedBrowserWarning';\r\n\r\nconst VideoApp = () => {\r\n  const { error, setError } = useAppState();\r\n  const connectionOptions = useConnectionOptions();\r\n\r\n  return (\r\n    <UnsupportedBrowserWarning>\r\n      <VideoProvider options={connectionOptions} onError={setError}>\r\n        <ErrorDialog dismissError={() => setError(null)} error={error} />\r\n        <App />\r\n      </VideoProvider>\r\n    </UnsupportedBrowserWarning>\r\n  );\r\n};\r\n\r\nReactDOM.render(\r\n  <MuiThemeProvider theme={theme}>\r\n    <CssBaseline />\r\n    <Router basename=\"/videocall2\">\r\n      <AppStateProvider>\r\n        <Switch>\r\n          <PrivateRoute exact path=\"/\">\r\n            <VideoApp />\r\n          </PrivateRoute>\r\n          <PrivateRoute path=\"/room/:URLRoomName\">\r\n            <VideoApp />\r\n          </PrivateRoute>\r\n          <Route path=\"/login\">\r\n            <LoginPage />\r\n          </Route>\r\n          <Redirect to=\"/\" />\r\n        </Switch>\r\n      </AppStateProvider>\r\n    </Router>\r\n  </MuiThemeProvider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}